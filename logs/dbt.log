

============================== 2023-03-16 16:39:03.604032 | 128c4a6e-7bd6-4fcb-8444-16e7c9b8f6bd ==============================
[0m16:39:03.604032 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:39:03.604777 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m16:39:03.604879 [debug] [MainThread]: Tracking: tracking
[0m16:39:03.617173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041ccbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041cfd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b4c10>]}
[0m16:39:03.672411 [debug] [MainThread]: Executing "git --help"
[0m16:39:03.695140 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:39:03.695547 [debug] [MainThread]: STDERR: "b''"
[0m16:39:03.696008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f0dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b49d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104259a60>]}
[0m16:39:03.696292 [debug] [MainThread]: Flushing usage events


============================== 2023-03-16 16:40:18.295926 | aa6ac2e7-3e6f-4ac7-8c73-5c6fb53b5cfe ==============================
[0m16:40:18.295926 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:40:18.296672 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m16:40:18.296775 [debug] [MainThread]: Tracking: tracking
[0m16:40:18.309622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079beac0>]}
[0m16:40:18.370644 [debug] [MainThread]: Executing "git --help"
[0m16:40:18.392368 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:40:18.392921 [debug] [MainThread]: STDERR: "b''"
[0m16:40:18.408944 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:40:18.409533 [debug] [MainThread]: Using postgres connection "debug"
[0m16:40:18.409714 [debug] [MainThread]: On debug: select 1 as id
[0m16:40:18.409874 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:19.103064 [debug] [MainThread]: SQL status: SELECT 1 in 1 seconds
[0m16:40:19.108563 [debug] [MainThread]: On debug: Close
[0m16:40:19.110425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b93d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b353d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b35d60>]}
[0m16:40:19.111664 [debug] [MainThread]: Flushing usage events
[0m16:40:20.405403 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2023-03-16 16:40:34.927563 | ed1b8c31-5460-4cc5-b56f-44fb9007d55a ==============================
[0m16:40:34.927563 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:40:34.928867 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:40:34.928987 [debug] [MainThread]: Tracking: tracking
[0m16:40:34.942611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ddd220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dcb9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dcbf40>]}
[0m16:40:34.952696 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:40:34.953600 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:40:34.953799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ed1b8c31-5460-4cc5-b56f-44fb9007d55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ad7c40>]}
[0m16:40:35.639971 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:40:35.646282 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:40:35.679049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ed1b8c31-5460-4cc5-b56f-44fb9007d55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067f7df0>]}
[0m16:40:35.682833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ed1b8c31-5460-4cc5-b56f-44fb9007d55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e0190>]}
[0m16:40:35.683021 [info ] [MainThread]: Found 2 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m16:40:35.683188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed1b8c31-5460-4cc5-b56f-44fb9007d55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dcb850>]}
[0m16:40:35.683872 [info ] [MainThread]: 
[0m16:40:35.684774 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:35.685360 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:40:35.691617 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:40:35.691820 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:40:35.691938 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:36.645738 [debug] [ThreadPool]: SQL status: SELECT 5 in 1 seconds
[0m16:40:36.651989 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:40:36.654476 [debug] [ThreadPool]: Acquiring new postgres connection 'create_DataWarehouse_dev'
[0m16:40:36.655246 [debug] [ThreadPool]: Acquiring new postgres connection 'create_DataWarehouse_dev'
[0m16:40:36.655685 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='datawarehouse', schema='dev', identifier=None)"
[0m16:40:36.663640 [debug] [ThreadPool]: Using postgres connection "create_DataWarehouse_dev"
[0m16:40:36.663930 [debug] [ThreadPool]: On create_DataWarehouse_dev: BEGIN
[0m16:40:36.664214 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:37.256134 [debug] [ThreadPool]: SQL status: BEGIN in 1 seconds
[0m16:40:37.256586 [debug] [ThreadPool]: Using postgres connection "create_DataWarehouse_dev"
[0m16:40:37.256844 [debug] [ThreadPool]: On create_DataWarehouse_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "create_DataWarehouse_dev"} */
create schema if not exists "dev"
[0m16:40:37.321026 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0 seconds
[0m16:40:37.322505 [debug] [ThreadPool]: On create_DataWarehouse_dev: COMMIT
[0m16:40:37.322890 [debug] [ThreadPool]: Using postgres connection "create_DataWarehouse_dev"
[0m16:40:37.323179 [debug] [ThreadPool]: On create_DataWarehouse_dev: COMMIT
[0m16:40:37.389757 [debug] [ThreadPool]: SQL status: COMMIT in 0 seconds
[0m16:40:37.390235 [debug] [ThreadPool]: On create_DataWarehouse_dev: Close
[0m16:40:37.393005 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev'
[0m16:40:37.402388 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev"
[0m16:40:37.402820 [debug] [ThreadPool]: On list_DataWarehouse_dev: BEGIN
[0m16:40:37.403073 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:38.176647 [debug] [ThreadPool]: SQL status: BEGIN in 1 seconds
[0m16:40:38.178201 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev"
[0m16:40:38.178855 [debug] [ThreadPool]: On list_DataWarehouse_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m16:40:38.243636 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m16:40:38.248268 [debug] [ThreadPool]: On list_DataWarehouse_dev: ROLLBACK
[0m16:40:38.302089 [debug] [ThreadPool]: On list_DataWarehouse_dev: Close
[0m16:40:38.313813 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:38.314262 [debug] [MainThread]: On master: BEGIN
[0m16:40:38.314588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:38.858146 [debug] [MainThread]: SQL status: BEGIN in 1 seconds
[0m16:40:38.859161 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:38.859839 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:38.928611 [debug] [MainThread]: SQL status: SELECT 0 in 0 seconds
[0m16:40:38.932513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ed1b8c31-5460-4cc5-b56f-44fb9007d55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106733d90>]}
[0m16:40:38.933549 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:38.986749 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:38.987516 [debug] [MainThread]: On master: BEGIN
[0m16:40:39.113976 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:40:39.115119 [debug] [MainThread]: On master: COMMIT
[0m16:40:39.115775 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:39.116413 [debug] [MainThread]: On master: COMMIT
[0m16:40:39.180197 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:40:39.181031 [debug] [MainThread]: On master: Close
[0m16:40:39.183654 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:40:39.184564 [info ] [MainThread]: 
[0m16:40:39.200785 [debug] [Thread-1  ]: Began running node model.warehouse.my_first_dbt_model
[0m16:40:39.201389 [info ] [Thread-1  ]: 1 of 2 START sql table model dev.my_first_dbt_model ............................ [RUN]
[0m16:40:39.202396 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.my_first_dbt_model'
[0m16:40:39.202770 [debug] [Thread-1  ]: Began compiling node model.warehouse.my_first_dbt_model
[0m16:40:39.206568 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.my_first_dbt_model"
[0m16:40:39.208856 [debug] [Thread-1  ]: Timing info for model.warehouse.my_first_dbt_model (compile): 2023-03-16 16:40:39.203002 => 2023-03-16 16:40:39.208749
[0m16:40:39.209198 [debug] [Thread-1  ]: Began executing node model.warehouse.my_first_dbt_model
[0m16:40:39.250553 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.my_first_dbt_model"
[0m16:40:39.252244 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.my_first_dbt_model"
[0m16:40:39.252395 [debug] [Thread-1  ]: On model.warehouse.my_first_dbt_model: BEGIN
[0m16:40:39.252533 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:40:39.787064 [debug] [Thread-1  ]: SQL status: BEGIN in 1 seconds
[0m16:40:39.788439 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.my_first_dbt_model"
[0m16:40:39.788916 [debug] [Thread-1  ]: On model.warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.my_first_dbt_model"} */

  
    

  create  table "DataWarehouse"."dev"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m16:40:39.853997 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0 seconds
[0m16:40:39.866831 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.my_first_dbt_model"
[0m16:40:39.867115 [debug] [Thread-1  ]: On model.warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.my_first_dbt_model"} */
alter table "DataWarehouse"."dev"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m16:40:39.925201 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:40:39.961871 [debug] [Thread-1  ]: On model.warehouse.my_first_dbt_model: COMMIT
[0m16:40:39.962146 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.my_first_dbt_model"
[0m16:40:39.962364 [debug] [Thread-1  ]: On model.warehouse.my_first_dbt_model: COMMIT
[0m16:40:40.018918 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:40:40.028975 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.my_first_dbt_model"
[0m16:40:40.029348 [debug] [Thread-1  ]: On model.warehouse.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.my_first_dbt_model"} */
drop table if exists "DataWarehouse"."dev"."my_first_dbt_model__dbt_backup" cascade
[0m16:40:40.091339 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m16:40:40.096220 [debug] [Thread-1  ]: Timing info for model.warehouse.my_first_dbt_model (execute): 2023-03-16 16:40:39.209406 => 2023-03-16 16:40:40.095986
[0m16:40:40.096943 [debug] [Thread-1  ]: On model.warehouse.my_first_dbt_model: Close
[0m16:40:40.098963 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed1b8c31-5460-4cc5-b56f-44fb9007d55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11089aeb0>]}
[0m16:40:40.099927 [info ] [Thread-1  ]: 1 of 2 OK created sql table model dev.my_first_dbt_model ....................... [[32mSELECT 2[0m in 0.90s]
[0m16:40:40.102579 [debug] [Thread-1  ]: Finished running node model.warehouse.my_first_dbt_model
[0m16:40:40.103641 [debug] [Thread-3  ]: Began running node model.warehouse.my_second_dbt_model
[0m16:40:40.104109 [info ] [Thread-3  ]: 2 of 2 START sql view model dev.my_second_dbt_model ............................ [RUN]
[0m16:40:40.105078 [debug] [Thread-3  ]: Acquiring new postgres connection 'model.warehouse.my_second_dbt_model'
[0m16:40:40.105386 [debug] [Thread-3  ]: Began compiling node model.warehouse.my_second_dbt_model
[0m16:40:40.109470 [debug] [Thread-3  ]: Writing injected SQL for node "model.warehouse.my_second_dbt_model"
[0m16:40:40.110858 [debug] [Thread-3  ]: Timing info for model.warehouse.my_second_dbt_model (compile): 2023-03-16 16:40:40.105605 => 2023-03-16 16:40:40.110745
[0m16:40:40.111215 [debug] [Thread-3  ]: Began executing node model.warehouse.my_second_dbt_model
[0m16:40:40.134176 [debug] [Thread-3  ]: Writing runtime sql for node "model.warehouse.my_second_dbt_model"
[0m16:40:40.135058 [debug] [Thread-3  ]: Using postgres connection "model.warehouse.my_second_dbt_model"
[0m16:40:40.135270 [debug] [Thread-3  ]: On model.warehouse.my_second_dbt_model: BEGIN
[0m16:40:40.135443 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m16:40:40.652419 [debug] [Thread-3  ]: SQL status: BEGIN in 1 seconds
[0m16:40:40.653868 [debug] [Thread-3  ]: Using postgres connection "model.warehouse.my_second_dbt_model"
[0m16:40:40.654480 [debug] [Thread-3  ]: On model.warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.my_second_dbt_model"} */

  create view "DataWarehouse"."dev"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "DataWarehouse"."dev"."my_first_dbt_model"
where id = 1
  );
[0m16:40:40.712861 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:40:40.722282 [debug] [Thread-3  ]: Using postgres connection "model.warehouse.my_second_dbt_model"
[0m16:40:40.722880 [debug] [Thread-3  ]: On model.warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.my_second_dbt_model"} */
alter table "DataWarehouse"."dev"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m16:40:40.778208 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:40:40.785329 [debug] [Thread-3  ]: On model.warehouse.my_second_dbt_model: COMMIT
[0m16:40:40.785952 [debug] [Thread-3  ]: Using postgres connection "model.warehouse.my_second_dbt_model"
[0m16:40:40.786482 [debug] [Thread-3  ]: On model.warehouse.my_second_dbt_model: COMMIT
[0m16:40:40.849345 [debug] [Thread-3  ]: SQL status: COMMIT in 0 seconds
[0m16:40:40.858669 [debug] [Thread-3  ]: Using postgres connection "model.warehouse.my_second_dbt_model"
[0m16:40:40.859290 [debug] [Thread-3  ]: On model.warehouse.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.my_second_dbt_model"} */
drop view if exists "DataWarehouse"."dev"."my_second_dbt_model__dbt_backup" cascade
[0m16:40:40.912679 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0 seconds
[0m16:40:40.916536 [debug] [Thread-3  ]: Timing info for model.warehouse.my_second_dbt_model (execute): 2023-03-16 16:40:40.111440 => 2023-03-16 16:40:40.916343
[0m16:40:40.917069 [debug] [Thread-3  ]: On model.warehouse.my_second_dbt_model: Close
[0m16:40:40.919330 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ed1b8c31-5460-4cc5-b56f-44fb9007d55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110879040>]}
[0m16:40:40.920367 [info ] [Thread-3  ]: 2 of 2 OK created sql view model dev.my_second_dbt_model ....................... [[32mCREATE VIEW[0m in 0.81s]
[0m16:40:40.921118 [debug] [Thread-3  ]: Finished running node model.warehouse.my_second_dbt_model
[0m16:40:40.924527 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:40.925189 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:40.925566 [debug] [MainThread]: On master: BEGIN
[0m16:40:40.925857 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:41.465131 [debug] [MainThread]: SQL status: BEGIN in 1 seconds
[0m16:40:41.466367 [debug] [MainThread]: On master: COMMIT
[0m16:40:41.466954 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:41.467417 [debug] [MainThread]: On master: COMMIT
[0m16:40:41.526556 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:40:41.527975 [debug] [MainThread]: On master: Close
[0m16:40:41.530498 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:41.530971 [debug] [MainThread]: Connection 'model.warehouse.my_first_dbt_model' was properly closed.
[0m16:40:41.531320 [debug] [MainThread]: Connection 'model.warehouse.my_second_dbt_model' was properly closed.
[0m16:40:41.531877 [info ] [MainThread]: 
[0m16:40:41.532487 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.85 seconds (5.85s).
[0m16:40:41.533325 [debug] [MainThread]: Command end result
[0m16:40:41.545779 [info ] [MainThread]: 
[0m16:40:41.546397 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:41.546811 [info ] [MainThread]: 
[0m16:40:41.547191 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:40:41.547669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108b81f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110930430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110930820>]}
[0m16:40:41.548058 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:00:06.751530 | b9bc47c4-3acb-44da-9097-97c821bc1346 ==============================
[0m16:00:06.751530 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:00:06.752837 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['test'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:00:06.752975 [debug] [MainThread]: Tracking: tracking
[0m16:00:06.784836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105faf220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fafc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc60d0>]}
[0m16:00:06.798957 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:00:06.809300 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:00:06.809523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b9bc47c4-3acb-44da-9097-97c821bc1346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bb0c40>]}
[0m16:00:07.367054 [debug] [MainThread]: 1699: static parser successfully parsed test.sql
[0m16:00:07.373323 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:00:07.374754 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:00:07.399584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10612d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106023820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064547c0>]}
[0m16:00:07.399803 [debug] [MainThread]: Flushing usage events
[0m16:00:09.525030 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.warehouse.test' (models/test.sql) depends on a node named 'raw_data' which was not found


============================== 2023-04-09 16:00:25.671061 | 852c92b8-63bf-4b62-9ed1-444f11574936 ==============================
[0m16:00:25.671061 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:00:25.672190 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['test'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:00:25.672299 [debug] [MainThread]: Tracking: tracking
[0m16:00:25.685785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103873760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b4bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b4b370>]}
[0m16:00:25.692843 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:00:25.698111 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:00:25.698356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '852c92b8-63bf-4b62-9ed1-444f11574936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10385ab20>]}
[0m16:00:26.012468 [debug] [MainThread]: 1699: static parser successfully parsed test.sql
[0m16:00:26.018654 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:00:26.020077 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:00:26.044473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cc9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ba0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff0760>]}
[0m16:00:26.044651 [debug] [MainThread]: Flushing usage events
[0m16:00:27.191467 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.warehouse.test' (models/test.sql) depends on a node named 'raw_data' which was not found


============================== 2023-04-09 16:00:58.107998 | 3a9b97f8-379a-4558-bed3-504694d6ff6b ==============================
[0m16:00:58.107998 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:00:58.109647 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['test'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:00:58.109866 [debug] [MainThread]: Tracking: tracking
[0m16:00:58.139987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134bbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134bb6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130e3940>]}
[0m16:00:58.151176 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:00:58.159112 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:00:58.159502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3a9b97f8-379a-4558-bed3-504694d6ff6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134aff40>]}
[0m16:00:58.573890 [debug] [MainThread]: 1603: static parser failed on test.sql
[0m16:00:58.579317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110c09a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137d2f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137d21c0>]}
[0m16:00:58.579604 [debug] [MainThread]: Flushing usage events
[0m16:00:59.750313 [error] [MainThread]: Encountered an error:
Compilation Error in model test (models/test.sql)
  source() takes exactly two arguments (1 given)


============================== 2023-04-09 16:02:52.453406 | 51a17ace-e3a0-4c88-90d0-70f005627b39 ==============================
[0m16:02:52.453406 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:02:52.454633 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['test'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:02:52.454761 [debug] [MainThread]: Tracking: tracking
[0m16:02:52.469749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101333a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11014ab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11014ad30>]}
[0m16:02:52.477078 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:02:52.482595 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:02:52.482846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '51a17ace-e3a0-4c88-90d0-70f005627b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e30ca0>]}
[0m16:02:52.800775 [debug] [MainThread]: 1699: static parser successfully parsed test.sql
[0m16:02:52.806985 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:02:52.808404 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:02:52.847127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51a17ace-e3a0-4c88-90d0-70f005627b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11028de80>]}
[0m16:02:52.862395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51a17ace-e3a0-4c88-90d0-70f005627b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110703ee0>]}
[0m16:02:52.862638 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:02:52.862838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a17ace-e3a0-4c88-90d0-70f005627b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102a83a0>]}
[0m16:02:52.863577 [info ] [MainThread]: 
[0m16:02:52.864632 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:52.865229 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:02:52.871611 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:02:52.871805 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:02:52.871934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:02:53.414359 [debug] [ThreadPool]: SQL status: SELECT 6 in 1 seconds
[0m16:02:53.419357 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:02:53.422867 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev'
[0m16:02:53.432627 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev"
[0m16:02:53.433185 [debug] [ThreadPool]: On list_DataWarehouse_dev: BEGIN
[0m16:02:53.433515 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:02:53.900321 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:02:53.901470 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev"
[0m16:02:53.902191 [debug] [ThreadPool]: On list_DataWarehouse_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m16:02:53.961227 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m16:02:53.965457 [debug] [ThreadPool]: On list_DataWarehouse_dev: ROLLBACK
[0m16:02:54.015881 [debug] [ThreadPool]: On list_DataWarehouse_dev: Close
[0m16:02:54.028854 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:54.029257 [debug] [MainThread]: On master: BEGIN
[0m16:02:54.029554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:02:54.496106 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:02:54.497589 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:54.498359 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:02:54.557318 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m16:02:54.561984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51a17ace-e3a0-4c88-90d0-70f005627b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11073b0d0>]}
[0m16:02:54.562804 [debug] [MainThread]: On master: ROLLBACK
[0m16:02:54.612042 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:54.612878 [debug] [MainThread]: On master: BEGIN
[0m16:02:54.716614 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:02:54.717907 [debug] [MainThread]: On master: COMMIT
[0m16:02:54.718582 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:54.719260 [debug] [MainThread]: On master: COMMIT
[0m16:02:54.767440 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:02:54.768888 [debug] [MainThread]: On master: Close
[0m16:02:54.771609 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:02:54.772360 [info ] [MainThread]: 
[0m16:02:54.786810 [debug] [Thread-1  ]: Began running node model.warehouse.test
[0m16:02:54.787435 [info ] [Thread-1  ]: 1 of 1 START sql view model dev.test ........................................... [RUN]
[0m16:02:54.788430 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.test'
[0m16:02:54.788800 [debug] [Thread-1  ]: Began compiling node model.warehouse.test
[0m16:02:54.792447 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.test"
[0m16:02:54.793489 [debug] [Thread-1  ]: Timing info for model.warehouse.test (compile): 2023-04-09 16:02:54.789040 => 2023-04-09 16:02:54.793392
[0m16:02:54.793822 [debug] [Thread-1  ]: Began executing node model.warehouse.test
[0m16:02:54.832225 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.test"
[0m16:02:54.833070 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:02:54.833209 [debug] [Thread-1  ]: On model.warehouse.test: BEGIN
[0m16:02:54.833333 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:02:55.296117 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:02:55.296871 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:02:55.297287 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.test"} */

  create view "DataWarehouse"."dev"."test__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

select * from source limit 5
  );
[0m16:02:55.348332 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 10: select * from source limit 5
         ^

[0m16:02:55.349450 [debug] [Thread-1  ]: On model.warehouse.test: ROLLBACK
[0m16:02:55.400653 [debug] [Thread-1  ]: Timing info for model.warehouse.test (execute): 2023-04-09 16:02:54.794021 => 2023-04-09 16:02:55.400215
[0m16:02:55.401853 [debug] [Thread-1  ]: On model.warehouse.test: Close
[0m16:02:55.490873 [debug] [Thread-1  ]: Database Error in model test (models/test.sql)
  syntax error at or near "select"
  LINE 10: select * from source limit 5
           ^
  compiled Code at target/run/warehouse/models/test.sql
[0m16:02:55.491511 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51a17ace-e3a0-4c88-90d0-70f005627b39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11074afa0>]}
[0m16:02:55.492141 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev.test .................................. [[31mERROR[0m in 0.70s]
[0m16:02:55.494295 [debug] [Thread-1  ]: Finished running node model.warehouse.test
[0m16:02:55.496713 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:02:55.497137 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:55.497435 [debug] [MainThread]: On master: BEGIN
[0m16:02:55.497706 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:02:55.964763 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:02:55.966140 [debug] [MainThread]: On master: COMMIT
[0m16:02:55.966822 [debug] [MainThread]: Using postgres connection "master"
[0m16:02:55.967509 [debug] [MainThread]: On master: COMMIT
[0m16:02:56.016482 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:02:56.017922 [debug] [MainThread]: On master: Close
[0m16:02:56.020387 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:02:56.020856 [debug] [MainThread]: Connection 'model.warehouse.test' was properly closed.
[0m16:02:56.021411 [info ] [MainThread]: 
[0m16:02:56.022167 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m16:02:56.022911 [debug] [MainThread]: Command end result
[0m16:02:56.036881 [info ] [MainThread]: 
[0m16:02:56.037517 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:02:56.037932 [info ] [MainThread]: 
[0m16:02:56.038332 [error] [MainThread]: [33mDatabase Error in model test (models/test.sql)[0m
[0m16:02:56.038700 [error] [MainThread]:   syntax error at or near "select"
[0m16:02:56.039048 [error] [MainThread]:   LINE 10: select * from source limit 5
[0m16:02:56.039408 [error] [MainThread]:            ^
[0m16:02:56.039744 [error] [MainThread]:   compiled Code at target/run/warehouse/models/test.sql
[0m16:02:56.040085 [info ] [MainThread]: 
[0m16:02:56.040433 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:02:56.040900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111321cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110534af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111318a90>]}
[0m16:02:56.041285 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:03:04.613469 | e0eb4af6-7768-48a8-8a9c-9da6e0dc5de9 ==============================
[0m16:03:04.613469 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:03:04.614777 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['test'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:03:04.614911 [debug] [MainThread]: Tracking: tracking
[0m16:03:04.635236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac4520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105adab20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105adad30>]}
[0m16:03:04.643826 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:03:04.691655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:03:04.692391 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/test.sql
[0m16:03:04.701592 [debug] [MainThread]: 1699: static parser successfully parsed test.sql
[0m16:03:04.716841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0eb4af6-7768-48a8-8a9c-9da6e0dc5de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2a2b0>]}
[0m16:03:04.741222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0eb4af6-7768-48a8-8a9c-9da6e0dc5de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef7f70>]}
[0m16:03:04.741602 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:03:04.741820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0eb4af6-7768-48a8-8a9c-9da6e0dc5de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ef7eb0>]}
[0m16:03:04.742834 [info ] [MainThread]: 
[0m16:03:04.743962 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:03:04.744849 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:03:04.753143 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:03:04.753479 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:03:04.753638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:05.226371 [debug] [ThreadPool]: SQL status: SELECT 6 in 0 seconds
[0m16:03:05.227332 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:03:05.228367 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev'
[0m16:03:05.232164 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev"
[0m16:03:05.232360 [debug] [ThreadPool]: On list_DataWarehouse_dev: BEGIN
[0m16:03:05.232494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:03:05.698346 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:03:05.698828 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev"
[0m16:03:05.699131 [debug] [ThreadPool]: On list_DataWarehouse_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m16:03:05.755276 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m16:03:05.759836 [debug] [ThreadPool]: On list_DataWarehouse_dev: ROLLBACK
[0m16:03:05.812188 [debug] [ThreadPool]: On list_DataWarehouse_dev: Close
[0m16:03:05.825442 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:05.825908 [debug] [MainThread]: On master: BEGIN
[0m16:03:05.826217 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:06.286596 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:03:06.287287 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:06.287666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:03:06.349375 [debug] [MainThread]: SQL status: SELECT 1 in 0 seconds
[0m16:03:06.352698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0eb4af6-7768-48a8-8a9c-9da6e0dc5de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2a430>]}
[0m16:03:06.353848 [debug] [MainThread]: On master: ROLLBACK
[0m16:03:06.401907 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:06.402917 [debug] [MainThread]: On master: BEGIN
[0m16:03:06.500553 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:03:06.501821 [debug] [MainThread]: On master: COMMIT
[0m16:03:06.502463 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:06.503122 [debug] [MainThread]: On master: COMMIT
[0m16:03:06.552049 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:03:06.552870 [debug] [MainThread]: On master: Close
[0m16:03:06.554821 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:03:06.555640 [info ] [MainThread]: 
[0m16:03:06.566813 [debug] [Thread-1  ]: Began running node model.warehouse.test
[0m16:03:06.567444 [info ] [Thread-1  ]: 1 of 1 START sql view model dev.test ........................................... [RUN]
[0m16:03:06.568431 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.test'
[0m16:03:06.568779 [debug] [Thread-1  ]: Began compiling node model.warehouse.test
[0m16:03:06.572720 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.test"
[0m16:03:06.574243 [debug] [Thread-1  ]: Timing info for model.warehouse.test (compile): 2023-04-09 16:03:06.569011 => 2023-04-09 16:03:06.574130
[0m16:03:06.574652 [debug] [Thread-1  ]: Began executing node model.warehouse.test
[0m16:03:06.616207 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.test"
[0m16:03:06.617316 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:03:06.617473 [debug] [Thread-1  ]: On model.warehouse.test: BEGIN
[0m16:03:06.617611 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:03:07.063942 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:03:07.064747 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:03:07.065872 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.test"} */

  create view "DataWarehouse"."dev"."test__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

)

select * from source limit 5
  );
[0m16:03:07.158009 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:03:07.171622 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:03:07.172233 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.test"} */
alter table "DataWarehouse"."dev"."test__dbt_tmp" rename to "test"
[0m16:03:07.218544 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:03:07.244635 [debug] [Thread-1  ]: On model.warehouse.test: COMMIT
[0m16:03:07.244951 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:03:07.245167 [debug] [Thread-1  ]: On model.warehouse.test: COMMIT
[0m16:03:07.296182 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:03:07.305482 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:03:07.305818 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.test"} */
drop view if exists "DataWarehouse"."dev"."test__dbt_backup" cascade
[0m16:03:07.355589 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:03:07.358693 [debug] [Thread-1  ]: Timing info for model.warehouse.test (execute): 2023-04-09 16:03:06.574899 => 2023-04-09 16:03:07.358522
[0m16:03:07.359219 [debug] [Thread-1  ]: On model.warehouse.test: Close
[0m16:03:07.361218 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0eb4af6-7768-48a8-8a9c-9da6e0dc5de9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060684c0>]}
[0m16:03:07.362347 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev.test ...................................... [[32mCREATE VIEW[0m in 0.79s]
[0m16:03:07.365155 [debug] [Thread-1  ]: Finished running node model.warehouse.test
[0m16:03:07.367582 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:03:07.368066 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:07.368420 [debug] [MainThread]: On master: BEGIN
[0m16:03:07.368733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:03:07.833599 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:03:07.834517 [debug] [MainThread]: On master: COMMIT
[0m16:03:07.835039 [debug] [MainThread]: Using postgres connection "master"
[0m16:03:07.835469 [debug] [MainThread]: On master: COMMIT
[0m16:03:07.886928 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:03:07.888079 [debug] [MainThread]: On master: Close
[0m16:03:07.890380 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:07.891025 [debug] [MainThread]: Connection 'model.warehouse.test' was properly closed.
[0m16:03:07.891477 [info ] [MainThread]: 
[0m16:03:07.892077 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m16:03:07.892802 [debug] [MainThread]: Command end result
[0m16:03:07.904317 [info ] [MainThread]: 
[0m16:03:07.904907 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:07.905326 [info ] [MainThread]: 
[0m16:03:07.905711 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:03:07.906201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ada940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057e9b20>]}
[0m16:03:07.906594 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:17:14.620387 | 13ea36eb-f21b-43e1-8020-c4a2fe1caaf4 ==============================
[0m16:17:14.620387 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:17:14.622064 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['test'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:17:14.622350 [debug] [MainThread]: Tracking: tracking
[0m16:17:14.648238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10402a220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10402afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10402a5e0>]}
[0m16:17:14.655707 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:17:14.664913 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:17:14.665169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '13ea36eb-f21b-43e1-8020-c4a2fe1caaf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d50520>]}
[0m16:17:14.991424 [debug] [MainThread]: 1699: static parser successfully parsed staging/test.sql
[0m16:17:14.997916 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:17:14.999362 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:17:15.038331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13ea36eb-f21b-43e1-8020-c4a2fe1caaf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104429730>]}
[0m16:17:15.055922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13ea36eb-f21b-43e1-8020-c4a2fe1caaf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10402afd0>]}
[0m16:17:15.056176 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:17:15.056382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13ea36eb-f21b-43e1-8020-c4a2fe1caaf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044c6ee0>]}
[0m16:17:15.057115 [info ] [MainThread]: 
[0m16:17:15.058146 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:17:15.058725 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:17:15.065438 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:17:15.065656 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:17:15.065785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:15.697031 [debug] [ThreadPool]: SQL status: SELECT 6 in 1 seconds
[0m16:17:15.702036 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:17:15.704455 [debug] [ThreadPool]: Acquiring new postgres connection 'create_DataWarehouse_dev_staging'
[0m16:17:15.705715 [debug] [ThreadPool]: Acquiring new postgres connection 'create_DataWarehouse_dev_staging'
[0m16:17:15.706382 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='datawarehouse', schema='dev_staging', identifier=None)"
[0m16:17:15.715164 [debug] [ThreadPool]: Using postgres connection "create_DataWarehouse_dev_staging"
[0m16:17:15.715672 [debug] [ThreadPool]: On create_DataWarehouse_dev_staging: BEGIN
[0m16:17:15.715979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:16.167022 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:17:16.167632 [debug] [ThreadPool]: Using postgres connection "create_DataWarehouse_dev_staging"
[0m16:17:16.167950 [debug] [ThreadPool]: On create_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "create_DataWarehouse_dev_staging"} */
create schema if not exists "dev_staging"
[0m16:17:16.218074 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0 seconds
[0m16:17:16.221412 [debug] [ThreadPool]: On create_DataWarehouse_dev_staging: COMMIT
[0m16:17:16.221944 [debug] [ThreadPool]: Using postgres connection "create_DataWarehouse_dev_staging"
[0m16:17:16.222309 [debug] [ThreadPool]: On create_DataWarehouse_dev_staging: COMMIT
[0m16:17:16.273272 [debug] [ThreadPool]: SQL status: COMMIT in 0 seconds
[0m16:17:16.274546 [debug] [ThreadPool]: On create_DataWarehouse_dev_staging: Close
[0m16:17:16.279050 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:17:16.279971 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev'
[0m16:17:16.290563 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:17:16.293185 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev"
[0m16:17:16.293483 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:17:16.293732 [debug] [ThreadPool]: On list_DataWarehouse_dev: BEGIN
[0m16:17:16.293979 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:17:16.294211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:16.764047 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:17:16.765182 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:17:16.765977 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev"
[0m16:17:16.766607 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:17:16.767160 [debug] [ThreadPool]: On list_DataWarehouse_dev: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev'
  
[0m16:17:16.767678 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:17:16.824440 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m16:17:16.825584 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m16:17:16.829347 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:17:16.832221 [debug] [ThreadPool]: On list_DataWarehouse_dev: ROLLBACK
[0m16:17:16.879555 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:17:16.880495 [debug] [ThreadPool]: On list_DataWarehouse_dev: Close
[0m16:17:16.894209 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:16.894628 [debug] [MainThread]: On master: BEGIN
[0m16:17:16.894920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:17:17.361311 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:17:17.361647 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:17.361809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:17:17.421532 [debug] [MainThread]: SQL status: SELECT 2 in 0 seconds
[0m16:17:17.422596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13ea36eb-f21b-43e1-8020-c4a2fe1caaf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104548700>]}
[0m16:17:17.422861 [debug] [MainThread]: On master: ROLLBACK
[0m16:17:17.471668 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:17.471972 [debug] [MainThread]: On master: BEGIN
[0m16:17:17.571661 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:17:17.572041 [debug] [MainThread]: On master: COMMIT
[0m16:17:17.572335 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:17.572540 [debug] [MainThread]: On master: COMMIT
[0m16:17:17.624203 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:17:17.624604 [debug] [MainThread]: On master: Close
[0m16:17:17.625380 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:17:17.625683 [info ] [MainThread]: 
[0m16:17:17.633583 [debug] [Thread-1  ]: Began running node model.warehouse.test
[0m16:17:17.634005 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.test ................................... [RUN]
[0m16:17:17.634676 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.test'
[0m16:17:17.634913 [debug] [Thread-1  ]: Began compiling node model.warehouse.test
[0m16:17:17.637645 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.test"
[0m16:17:17.638965 [debug] [Thread-1  ]: Timing info for model.warehouse.test (compile): 2023-04-09 16:17:17.635059 => 2023-04-09 16:17:17.638855
[0m16:17:17.639259 [debug] [Thread-1  ]: Began executing node model.warehouse.test
[0m16:17:17.679554 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.test"
[0m16:17:17.680693 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:17:17.680871 [debug] [Thread-1  ]: On model.warehouse.test: BEGIN
[0m16:17:17.681019 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:17:18.144244 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:17:18.144835 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:17:18.145107 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.test"} */

  create view "DataWarehouse"."dev_staging"."test__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

)

select * from source limit 5
  );
[0m16:17:18.202291 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:17:18.214954 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:17:18.215377 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.test"} */
alter table "DataWarehouse"."dev_staging"."test__dbt_tmp" rename to "test"
[0m16:17:18.265683 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:17:18.294280 [debug] [Thread-1  ]: On model.warehouse.test: COMMIT
[0m16:17:18.294633 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:17:18.294858 [debug] [Thread-1  ]: On model.warehouse.test: COMMIT
[0m16:17:18.345160 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:17:18.353741 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:17:18.354116 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.test"} */
drop view if exists "DataWarehouse"."dev_staging"."test__dbt_backup" cascade
[0m16:17:18.403699 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:17:18.406279 [debug] [Thread-1  ]: Timing info for model.warehouse.test (execute): 2023-04-09 16:17:17.639428 => 2023-04-09 16:17:18.406189
[0m16:17:18.406611 [debug] [Thread-1  ]: On model.warehouse.test: Close
[0m16:17:18.408056 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13ea36eb-f21b-43e1-8020-c4a2fe1caaf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10460c4c0>]}
[0m16:17:18.408859 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_staging.test .............................. [[32mCREATE VIEW[0m in 0.77s]
[0m16:17:18.412476 [debug] [Thread-1  ]: Finished running node model.warehouse.test
[0m16:17:18.415565 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:17:18.416032 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:18.416337 [debug] [MainThread]: On master: BEGIN
[0m16:17:18.416620 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:17:18.885938 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:17:18.886977 [debug] [MainThread]: On master: COMMIT
[0m16:17:18.887715 [debug] [MainThread]: Using postgres connection "master"
[0m16:17:18.888208 [debug] [MainThread]: On master: COMMIT
[0m16:17:18.935403 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:17:18.935824 [debug] [MainThread]: On master: Close
[0m16:17:18.936744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:18.936982 [debug] [MainThread]: Connection 'model.warehouse.test' was properly closed.
[0m16:17:18.937178 [debug] [MainThread]: Connection 'list_DataWarehouse_dev' was properly closed.
[0m16:17:18.937531 [info ] [MainThread]: 
[0m16:17:18.937974 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.88 seconds (3.88s).
[0m16:17:18.938511 [debug] [MainThread]: Command end result
[0m16:17:18.949886 [info ] [MainThread]: 
[0m16:17:18.950363 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:17:18.950655 [info ] [MainThread]: 
[0m16:17:18.950927 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:17:18.951269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d853d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c6e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a7850>]}
[0m16:17:18.951537 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:19:28.013566 | 23625862-6b8c-47b7-90de-32ef1ac49b1f ==============================
[0m16:19:28.013566 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:19:28.014866 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'target': 'prod', 'select': ['test'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:19:28.015028 [debug] [MainThread]: Tracking: tracking
[0m16:19:28.028091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfbd60>]}
[0m16:19:28.036154 [debug] [MainThread]: checksum: 11d17a60369a0ae8f297a25b75ba496363ddcac082bfb4fd162475eb0901cc9e, vars: {}, profile: None, target: prod, version: 1.4.5
[0m16:19:28.043940 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:19:28.044201 [debug] [MainThread]: previous checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, current checksum: 11d17a60369a0ae8f297a25b75ba496363ddcac082bfb4fd162475eb0901cc9e
[0m16:19:28.044338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '23625862-6b8c-47b7-90de-32ef1ac49b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b519a0>]}
[0m16:19:28.359761 [debug] [MainThread]: 1699: static parser successfully parsed staging/test.sql
[0m16:19:28.366307 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:19:28.367795 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:19:28.406385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23625862-6b8c-47b7-90de-32ef1ac49b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083e5b80>]}
[0m16:19:28.420099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23625862-6b8c-47b7-90de-32ef1ac49b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108149f70>]}
[0m16:19:28.420305 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:19:28.420489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23625862-6b8c-47b7-90de-32ef1ac49b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108454ee0>]}
[0m16:19:28.421204 [info ] [MainThread]: 
[0m16:19:28.422235 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:19:28.422837 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:19:28.429232 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:19:28.429459 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:19:28.429587 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:28.977234 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:19:28.983175 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:19:28.985930 [debug] [ThreadPool]: Acquiring new postgres connection 'create_DataWarehouse_prod_staging'
[0m16:19:28.986869 [debug] [ThreadPool]: Acquiring new postgres connection 'create_DataWarehouse_prod_staging'
[0m16:19:28.987279 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='datawarehouse', schema='prod_staging', identifier=None)"
[0m16:19:28.995485 [debug] [ThreadPool]: Using postgres connection "create_DataWarehouse_prod_staging"
[0m16:19:28.995901 [debug] [ThreadPool]: On create_DataWarehouse_prod_staging: BEGIN
[0m16:19:28.996149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:29.452878 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:19:29.453326 [debug] [ThreadPool]: Using postgres connection "create_DataWarehouse_prod_staging"
[0m16:19:29.453631 [debug] [ThreadPool]: On create_DataWarehouse_prod_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "create_DataWarehouse_prod_staging"} */
create schema if not exists "prod_staging"
[0m16:19:29.501467 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0 seconds
[0m16:19:29.502904 [debug] [ThreadPool]: On create_DataWarehouse_prod_staging: COMMIT
[0m16:19:29.503207 [debug] [ThreadPool]: Using postgres connection "create_DataWarehouse_prod_staging"
[0m16:19:29.503450 [debug] [ThreadPool]: On create_DataWarehouse_prod_staging: COMMIT
[0m16:19:29.551976 [debug] [ThreadPool]: SQL status: COMMIT in 0 seconds
[0m16:19:29.552438 [debug] [ThreadPool]: On create_DataWarehouse_prod_staging: Close
[0m16:19:29.554784 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_prod_staging'
[0m16:19:29.561857 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_prod'
[0m16:19:29.562949 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_prod_staging"
[0m16:19:29.565031 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_prod"
[0m16:19:29.565308 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: BEGIN
[0m16:19:29.565516 [debug] [ThreadPool]: On list_DataWarehouse_prod: BEGIN
[0m16:19:29.565719 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:29.565912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:30.032982 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:19:30.034229 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:19:30.034909 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_prod_staging"
[0m16:19:30.035531 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_prod"
[0m16:19:30.036053 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "list_DataWarehouse_prod_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prod_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prod_staging'
  
[0m16:19:30.036550 [debug] [ThreadPool]: On list_DataWarehouse_prod: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "list_DataWarehouse_prod"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prod'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prod'
  
[0m16:19:30.090751 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m16:19:30.091889 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m16:19:30.095348 [debug] [ThreadPool]: On list_DataWarehouse_prod: ROLLBACK
[0m16:19:30.097079 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: ROLLBACK
[0m16:19:30.144418 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: Close
[0m16:19:30.147338 [debug] [ThreadPool]: On list_DataWarehouse_prod: Close
[0m16:19:30.157031 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:30.157456 [debug] [MainThread]: On master: BEGIN
[0m16:19:30.157757 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:30.622890 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:19:30.623843 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:30.624473 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:19:30.686790 [debug] [MainThread]: SQL status: SELECT 3 in 0 seconds
[0m16:19:30.691465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23625862-6b8c-47b7-90de-32ef1ac49b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108492970>]}
[0m16:19:30.692751 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:30.742087 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:30.742985 [debug] [MainThread]: On master: BEGIN
[0m16:19:30.843759 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:19:30.845032 [debug] [MainThread]: On master: COMMIT
[0m16:19:30.845861 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:30.846539 [debug] [MainThread]: On master: COMMIT
[0m16:19:30.895066 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:19:30.896254 [debug] [MainThread]: On master: Close
[0m16:19:30.898683 [info ] [MainThread]: Concurrency: 25 threads (target='prod')
[0m16:19:30.899442 [info ] [MainThread]: 
[0m16:19:30.911456 [debug] [Thread-1  ]: Began running node model.warehouse.test
[0m16:19:30.912106 [info ] [Thread-1  ]: 1 of 1 START sql view model prod_staging.test .................................. [RUN]
[0m16:19:30.913101 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.test'
[0m16:19:30.913449 [debug] [Thread-1  ]: Began compiling node model.warehouse.test
[0m16:19:30.917092 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.test"
[0m16:19:30.918473 [debug] [Thread-1  ]: Timing info for model.warehouse.test (compile): 2023-04-09 16:19:30.913694 => 2023-04-09 16:19:30.918376
[0m16:19:30.918784 [debug] [Thread-1  ]: Began executing node model.warehouse.test
[0m16:19:30.957173 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.test"
[0m16:19:30.958636 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:19:30.958801 [debug] [Thread-1  ]: On model.warehouse.test: BEGIN
[0m16:19:30.958936 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:31.431519 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:19:31.432676 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:19:31.433261 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "node_id": "model.warehouse.test"} */

  create view "DataWarehouse"."prod_staging"."test__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

)

select * from source limit 5
  );
[0m16:19:31.490574 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:19:31.507828 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:19:31.508296 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "node_id": "model.warehouse.test"} */
alter table "DataWarehouse"."prod_staging"."test__dbt_tmp" rename to "test"
[0m16:19:31.559219 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:19:31.589105 [debug] [Thread-1  ]: On model.warehouse.test: COMMIT
[0m16:19:31.589450 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:19:31.589668 [debug] [Thread-1  ]: On model.warehouse.test: COMMIT
[0m16:19:31.639612 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:19:31.649608 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:19:31.649996 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "node_id": "model.warehouse.test"} */
drop view if exists "DataWarehouse"."prod_staging"."test__dbt_backup" cascade
[0m16:19:31.698726 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:19:31.703672 [debug] [Thread-1  ]: Timing info for model.warehouse.test (execute): 2023-04-09 16:19:30.918972 => 2023-04-09 16:19:31.703470
[0m16:19:31.704449 [debug] [Thread-1  ]: On model.warehouse.test: Close
[0m16:19:31.706807 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23625862-6b8c-47b7-90de-32ef1ac49b1f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108593880>]}
[0m16:19:31.707824 [info ] [Thread-1  ]: 1 of 1 OK created sql view model prod_staging.test ............................. [[32mCREATE VIEW[0m in 0.79s]
[0m16:19:31.710771 [debug] [Thread-1  ]: Finished running node model.warehouse.test
[0m16:19:31.713566 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:19:31.714027 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:31.714327 [debug] [MainThread]: On master: BEGIN
[0m16:19:31.714612 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:32.177715 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:19:32.178101 [debug] [MainThread]: On master: COMMIT
[0m16:19:32.178333 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:32.178540 [debug] [MainThread]: On master: COMMIT
[0m16:19:32.229364 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:19:32.229882 [debug] [MainThread]: On master: Close
[0m16:19:32.231049 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:32.231333 [debug] [MainThread]: Connection 'model.warehouse.test' was properly closed.
[0m16:19:32.231577 [debug] [MainThread]: Connection 'list_DataWarehouse_prod' was properly closed.
[0m16:19:32.231877 [info ] [MainThread]: 
[0m16:19:32.232323 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m16:19:32.232876 [debug] [MainThread]: Command end result
[0m16:19:32.242835 [info ] [MainThread]: 
[0m16:19:32.243383 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:32.243732 [info ] [MainThread]: 
[0m16:19:32.244060 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:19:32.244472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108412610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ca190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084929a0>]}
[0m16:19:32.244795 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:20:42.864071 | 4d051d4b-d9da-4536-8db8-f403c97ea834 ==============================
[0m16:20:42.864071 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:20:42.865673 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'target': 'prod', 'select': ['test'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:20:42.865870 [debug] [MainThread]: Tracking: tracking
[0m16:20:42.930996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db7eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dcf5b0>]}
[0m16:20:42.942025 [debug] [MainThread]: checksum: 11d17a60369a0ae8f297a25b75ba496363ddcac082bfb4fd162475eb0901cc9e, vars: {}, profile: None, target: prod, version: 1.4.5
[0m16:20:43.282032 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:20:43.282821 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:20:43.298101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d051d4b-d9da-4536-8db8-f403c97ea834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076810d0>]}
[0m16:20:43.324725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d051d4b-d9da-4536-8db8-f403c97ea834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ede50>]}
[0m16:20:43.325603 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:20:43.326266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d051d4b-d9da-4536-8db8-f403c97ea834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ede80>]}
[0m16:20:43.328978 [info ] [MainThread]: 
[0m16:20:43.332352 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:43.333526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:20:43.345961 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:20:43.346308 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:20:43.346551 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:43.950662 [debug] [ThreadPool]: SQL status: SELECT 8 in 1 seconds
[0m16:20:43.954285 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:20:43.957902 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_prod'
[0m16:20:43.959373 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_prod_staging'
[0m16:20:43.969313 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_prod"
[0m16:20:43.972083 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_prod_staging"
[0m16:20:43.972468 [debug] [ThreadPool]: On list_DataWarehouse_prod: BEGIN
[0m16:20:43.972770 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: BEGIN
[0m16:20:43.973029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:20:43.973260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:20:44.445399 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:20:44.446379 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:20:44.446753 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_prod"
[0m16:20:44.447129 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_prod_staging"
[0m16:20:44.447511 [debug] [ThreadPool]: On list_DataWarehouse_prod: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "list_DataWarehouse_prod"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prod'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prod'
  
[0m16:20:44.447880 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "list_DataWarehouse_prod_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prod_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prod_staging'
  
[0m16:20:44.503903 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m16:20:44.505038 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:20:44.509553 [debug] [ThreadPool]: On list_DataWarehouse_prod: ROLLBACK
[0m16:20:44.513323 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: ROLLBACK
[0m16:20:44.561700 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: Close
[0m16:20:44.562757 [debug] [ThreadPool]: On list_DataWarehouse_prod: Close
[0m16:20:44.581705 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:44.582423 [debug] [MainThread]: On master: BEGIN
[0m16:20:44.582750 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:20:45.054860 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:20:45.055497 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:45.055816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:20:45.119831 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:20:45.125110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d051d4b-d9da-4536-8db8-f403c97ea834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106de19a0>]}
[0m16:20:45.126444 [debug] [MainThread]: On master: ROLLBACK
[0m16:20:45.179738 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:45.180896 [debug] [MainThread]: On master: BEGIN
[0m16:20:45.279054 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:20:45.280014 [debug] [MainThread]: On master: COMMIT
[0m16:20:45.280380 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:45.280726 [debug] [MainThread]: On master: COMMIT
[0m16:20:45.330654 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:20:45.331464 [debug] [MainThread]: On master: Close
[0m16:20:45.332847 [info ] [MainThread]: Concurrency: 25 threads (target='prod')
[0m16:20:45.333765 [info ] [MainThread]: 
[0m16:20:45.355533 [debug] [Thread-1  ]: Began running node model.warehouse.test
[0m16:20:45.356819 [info ] [Thread-1  ]: 1 of 1 START sql view model prod_staging.test .................................. [RUN]
[0m16:20:45.358268 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.test'
[0m16:20:45.358774 [debug] [Thread-1  ]: Began compiling node model.warehouse.test
[0m16:20:45.365044 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.test"
[0m16:20:45.372166 [debug] [Thread-1  ]: Timing info for model.warehouse.test (compile): 2023-04-09 16:20:45.359083 => 2023-04-09 16:20:45.371875
[0m16:20:45.372930 [debug] [Thread-1  ]: Began executing node model.warehouse.test
[0m16:20:45.425119 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.test"
[0m16:20:45.437353 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:20:45.437539 [debug] [Thread-1  ]: On model.warehouse.test: BEGIN
[0m16:20:45.437696 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:20:45.909842 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:20:45.910853 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:20:45.911425 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "node_id": "model.warehouse.test"} */

  create view "DataWarehouse"."prod_staging"."test__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

)

select * from source limit 5
  );
[0m16:20:45.966788 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:20:45.985415 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:20:45.985987 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "node_id": "model.warehouse.test"} */
alter table "DataWarehouse"."prod_staging"."test" rename to "test__dbt_backup"
[0m16:20:46.035099 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:20:46.042404 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:20:46.043051 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "node_id": "model.warehouse.test"} */
alter table "DataWarehouse"."prod_staging"."test__dbt_tmp" rename to "test"
[0m16:20:46.094718 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:20:46.134181 [debug] [Thread-1  ]: On model.warehouse.test: COMMIT
[0m16:20:46.134635 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:20:46.135011 [debug] [Thread-1  ]: On model.warehouse.test: COMMIT
[0m16:20:46.185912 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:20:46.197612 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:20:46.198239 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "node_id": "model.warehouse.test"} */
drop view if exists "DataWarehouse"."prod_staging"."test__dbt_backup" cascade
[0m16:20:46.251487 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:20:46.260514 [debug] [Thread-1  ]: Timing info for model.warehouse.test (execute): 2023-04-09 16:20:45.373240 => 2023-04-09 16:20:46.260391
[0m16:20:46.261089 [debug] [Thread-1  ]: On model.warehouse.test: Close
[0m16:20:46.262744 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d051d4b-d9da-4536-8db8-f403c97ea834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770ea30>]}
[0m16:20:46.263655 [info ] [Thread-1  ]: 1 of 1 OK created sql view model prod_staging.test ............................. [[32mCREATE VIEW[0m in 0.90s]
[0m16:20:46.266235 [debug] [Thread-1  ]: Finished running node model.warehouse.test
[0m16:20:46.270865 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:20:46.271605 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:46.272015 [debug] [MainThread]: On master: BEGIN
[0m16:20:46.272431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:20:46.750551 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:20:46.751922 [debug] [MainThread]: On master: COMMIT
[0m16:20:46.752594 [debug] [MainThread]: Using postgres connection "master"
[0m16:20:46.753257 [debug] [MainThread]: On master: COMMIT
[0m16:20:46.802270 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:20:46.803484 [debug] [MainThread]: On master: Close
[0m16:20:46.805703 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:20:46.806173 [debug] [MainThread]: Connection 'model.warehouse.test' was properly closed.
[0m16:20:46.806564 [debug] [MainThread]: Connection 'list_DataWarehouse_prod_staging' was properly closed.
[0m16:20:46.807126 [info ] [MainThread]: 
[0m16:20:46.807866 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m16:20:46.808810 [debug] [MainThread]: Command end result
[0m16:20:46.831461 [info ] [MainThread]: 
[0m16:20:46.832276 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:20:46.832792 [info ] [MainThread]: 
[0m16:20:46.833471 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:20:46.834262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10763aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030f99a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769b4f0>]}
[0m16:20:46.834922 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:22:52.276794 | 120aa12a-adc2-4aec-9ef0-85f3ba5d4461 ==============================
[0m16:22:52.276794 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:22:52.278069 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'target': 'prod', 'select': ['test'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:22:52.278207 [debug] [MainThread]: Tracking: tracking
[0m16:22:52.292179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118c8a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118c86d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118cdd60>]}
[0m16:22:52.300287 [debug] [MainThread]: checksum: 11d17a60369a0ae8f297a25b75ba496363ddcac082bfb4fd162475eb0901cc9e, vars: {}, profile: None, target: prod, version: 1.4.5
[0m16:22:52.306659 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:22:52.306943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '120aa12a-adc2-4aec-9ef0-85f3ba5d4461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118c8a90>]}
[0m16:22:52.640224 [debug] [MainThread]: 1699: static parser successfully parsed staging/test.sql
[0m16:22:52.647261 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m16:22:52.648851 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m16:22:52.685992 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:22:52.689051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '120aa12a-adc2-4aec-9ef0-85f3ba5d4461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118ffe20>]}
[0m16:22:52.702218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '120aa12a-adc2-4aec-9ef0-85f3ba5d4461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d62730>]}
[0m16:22:52.702469 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:22:52.702638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '120aa12a-adc2-4aec-9ef0-85f3ba5d4461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118cb4c0>]}
[0m16:22:52.703316 [info ] [MainThread]: 
[0m16:22:52.704247 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:22:52.704745 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:22:52.711395 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:22:52.711599 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:22:52.711719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:53.224488 [debug] [ThreadPool]: SQL status: SELECT 8 in 1 seconds
[0m16:22:53.226428 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:22:53.227501 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_prod'
[0m16:22:53.227881 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_prod_staging'
[0m16:22:53.231359 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_prod"
[0m16:22:53.232430 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_prod_staging"
[0m16:22:53.232565 [debug] [ThreadPool]: On list_DataWarehouse_prod: BEGIN
[0m16:22:53.232671 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: BEGIN
[0m16:22:53.232773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:53.232870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:53.693348 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:22:53.694212 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:22:53.694834 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_prod_staging"
[0m16:22:53.695558 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_prod"
[0m16:22:53.696119 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "list_DataWarehouse_prod_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prod_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prod_staging'
  
[0m16:22:53.696593 [debug] [ThreadPool]: On list_DataWarehouse_prod: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "list_DataWarehouse_prod"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prod'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prod'
  
[0m16:22:53.748544 [debug] [ThreadPool]: SQL status: SELECT 0 in 0 seconds
[0m16:22:53.749362 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:22:53.753062 [debug] [ThreadPool]: On list_DataWarehouse_prod: ROLLBACK
[0m16:22:53.755254 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: ROLLBACK
[0m16:22:53.803395 [debug] [ThreadPool]: On list_DataWarehouse_prod: Close
[0m16:22:53.804347 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: Close
[0m16:22:53.815906 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:53.816253 [debug] [MainThread]: On master: BEGIN
[0m16:22:53.816526 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:22:54.276459 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:22:54.277866 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:54.278561 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:22:54.340602 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:22:54.345928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '120aa12a-adc2-4aec-9ef0-85f3ba5d4461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d8d0d0>]}
[0m16:22:54.347200 [debug] [MainThread]: On master: ROLLBACK
[0m16:22:54.399245 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:54.400101 [debug] [MainThread]: On master: BEGIN
[0m16:22:54.498582 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:22:54.499889 [debug] [MainThread]: On master: COMMIT
[0m16:22:54.500603 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:54.501300 [debug] [MainThread]: On master: COMMIT
[0m16:22:54.550396 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:22:54.551240 [debug] [MainThread]: On master: Close
[0m16:22:54.553246 [info ] [MainThread]: Concurrency: 25 threads (target='prod')
[0m16:22:54.554047 [info ] [MainThread]: 
[0m16:22:54.565109 [debug] [Thread-1  ]: Began running node model.warehouse.test
[0m16:22:54.565800 [info ] [Thread-1  ]: 1 of 1 START sql view model prod_staging.test .................................. [RUN]
[0m16:22:54.566827 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.test'
[0m16:22:54.567175 [debug] [Thread-1  ]: Began compiling node model.warehouse.test
[0m16:22:54.571234 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.test"
[0m16:22:54.572727 [debug] [Thread-1  ]: Timing info for model.warehouse.test (compile): 2023-04-09 16:22:54.567415 => 2023-04-09 16:22:54.572637
[0m16:22:54.572904 [debug] [Thread-1  ]: Began executing node model.warehouse.test
[0m16:22:54.609059 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.test"
[0m16:22:54.610413 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:22:54.610583 [debug] [Thread-1  ]: On model.warehouse.test: BEGIN
[0m16:22:54.610725 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:22:55.083581 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:22:55.084763 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:22:55.085450 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "node_id": "model.warehouse.test"} */

  create view "DataWarehouse"."prod_staging"."test__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

)

select * from source limit 5
  );
[0m16:22:55.139949 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:22:55.157538 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:22:55.157983 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "node_id": "model.warehouse.test"} */
alter table "DataWarehouse"."prod_staging"."test" rename to "test__dbt_backup"
[0m16:22:55.208086 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:22:55.219336 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:22:55.219840 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "node_id": "model.warehouse.test"} */
alter table "DataWarehouse"."prod_staging"."test__dbt_tmp" rename to "test"
[0m16:22:55.271956 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:22:55.308443 [debug] [Thread-1  ]: On model.warehouse.test: COMMIT
[0m16:22:55.308742 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:22:55.308957 [debug] [Thread-1  ]: On model.warehouse.test: COMMIT
[0m16:22:55.359567 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:22:55.368157 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:22:55.368463 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "node_id": "model.warehouse.test"} */
drop view if exists "DataWarehouse"."prod_staging"."test__dbt_backup" cascade
[0m16:22:55.421140 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:22:55.425739 [debug] [Thread-1  ]: Timing info for model.warehouse.test (execute): 2023-04-09 16:22:54.572993 => 2023-04-09 16:22:55.425494
[0m16:22:55.426336 [debug] [Thread-1  ]: On model.warehouse.test: Close
[0m16:22:55.428250 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '120aa12a-adc2-4aec-9ef0-85f3ba5d4461', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f8b7c0>]}
[0m16:22:55.429246 [info ] [Thread-1  ]: 1 of 1 OK created sql view model prod_staging.test ............................. [[32mCREATE VIEW[0m in 0.86s]
[0m16:22:55.431851 [debug] [Thread-1  ]: Finished running node model.warehouse.test
[0m16:22:55.434417 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:22:55.434813 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:55.435103 [debug] [MainThread]: On master: BEGIN
[0m16:22:55.435391 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:22:55.894936 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:22:55.895564 [debug] [MainThread]: On master: COMMIT
[0m16:22:55.895868 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:55.896174 [debug] [MainThread]: On master: COMMIT
[0m16:22:55.947522 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:22:55.949042 [debug] [MainThread]: On master: Close
[0m16:22:55.951614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:55.952140 [debug] [MainThread]: Connection 'model.warehouse.test' was properly closed.
[0m16:22:55.952494 [debug] [MainThread]: Connection 'list_DataWarehouse_prod_staging' was properly closed.
[0m16:22:55.953029 [info ] [MainThread]: 
[0m16:22:55.953733 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m16:22:55.954559 [debug] [MainThread]: Command end result
[0m16:22:55.965943 [info ] [MainThread]: 
[0m16:22:55.966563 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:22:55.966988 [info ] [MainThread]: 
[0m16:22:55.967386 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:22:55.967878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f54a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d62850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d62940>]}
[0m16:22:55.968265 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:28:40.215470 | be65b65c-7e53-4ff9-a229-4d8ec762ac2e ==============================
[0m16:28:40.215470 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:28:40.216755 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'target': 'prod', 'select': ['test'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:28:40.216874 [debug] [MainThread]: Tracking: tracking
[0m16:28:40.241555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10407f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040a9a90>]}
[0m16:28:40.251635 [debug] [MainThread]: checksum: 11d17a60369a0ae8f297a25b75ba496363ddcac082bfb4fd162475eb0901cc9e, vars: {}, profile: None, target: prod, version: 1.4.5
[0m16:28:40.289071 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 1 files changed.
[0m16:28:40.289361 [debug] [MainThread]: Partial parsing: added file: warehouse://models/staging/sources.yml
[0m16:28:40.289549 [debug] [MainThread]: Partial parsing: deleted file: warehouse://models/example/my_first_dbt_model.sql
[0m16:28:40.289638 [debug] [MainThread]: Partial parsing: deleted file: warehouse://models/example/my_second_dbt_model.sql
[0m16:28:40.289753 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/test.sql
[0m16:28:40.298064 [debug] [MainThread]: 1699: static parser successfully parsed staging/test.sql
[0m16:28:40.315201 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.warehouse.marts
- models.warehouse.example
[0m16:28:40.318200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be65b65c-7e53-4ff9-a229-4d8ec762ac2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10483f0d0>]}
[0m16:28:40.332720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be65b65c-7e53-4ff9-a229-4d8ec762ac2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047799a0>]}
[0m16:28:40.332994 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:28:40.333182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be65b65c-7e53-4ff9-a229-4d8ec762ac2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104779a60>]}
[0m16:28:40.333884 [info ] [MainThread]: 
[0m16:28:40.334871 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:28:40.335378 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:28:40.341784 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:28:40.342015 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:28:40.342169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:40.872364 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:28:40.876844 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:28:40.880104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_prod_staging'
[0m16:28:40.890385 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_prod_staging"
[0m16:28:40.890821 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: BEGIN
[0m16:28:40.891126 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:41.356467 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:28:41.357896 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_prod_staging"
[0m16:28:41.358566 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "list_DataWarehouse_prod_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'prod_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'prod_staging'
  
[0m16:28:41.414496 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:28:41.418825 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: ROLLBACK
[0m16:28:41.466301 [debug] [ThreadPool]: On list_DataWarehouse_prod_staging: Close
[0m16:28:41.480873 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:41.481312 [debug] [MainThread]: On master: BEGIN
[0m16:28:41.481641 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:28:41.936092 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:28:41.936850 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:41.937329 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:28:41.999320 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:28:42.004023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be65b65c-7e53-4ff9-a229-4d8ec762ac2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040a0d90>]}
[0m16:28:42.004834 [debug] [MainThread]: On master: ROLLBACK
[0m16:28:42.055420 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:42.056520 [debug] [MainThread]: On master: BEGIN
[0m16:28:42.151495 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:28:42.152593 [debug] [MainThread]: On master: COMMIT
[0m16:28:42.153383 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:42.153966 [debug] [MainThread]: On master: COMMIT
[0m16:28:42.203375 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:28:42.204641 [debug] [MainThread]: On master: Close
[0m16:28:42.207053 [info ] [MainThread]: Concurrency: 25 threads (target='prod')
[0m16:28:42.207804 [info ] [MainThread]: 
[0m16:28:42.219836 [debug] [Thread-1  ]: Began running node model.warehouse.test
[0m16:28:42.220479 [info ] [Thread-1  ]: 1 of 1 START sql view model prod_staging.test .................................. [RUN]
[0m16:28:42.221496 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.test'
[0m16:28:42.221844 [debug] [Thread-1  ]: Began compiling node model.warehouse.test
[0m16:28:42.225364 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.test"
[0m16:28:42.230019 [debug] [Thread-1  ]: Timing info for model.warehouse.test (compile): 2023-04-09 16:28:42.222084 => 2023-04-09 16:28:42.229908
[0m16:28:42.230374 [debug] [Thread-1  ]: Began executing node model.warehouse.test
[0m16:28:42.266466 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.test"
[0m16:28:42.280947 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:28:42.281136 [debug] [Thread-1  ]: On model.warehouse.test: BEGIN
[0m16:28:42.281286 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:28:42.741677 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:28:42.742376 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:28:42.742921 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "node_id": "model.warehouse.test"} */

  create view "DataWarehouse"."prod_staging"."test__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

)

select * from source limit 5
  );
[0m16:28:42.800949 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:28:42.810274 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:28:42.810478 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "node_id": "model.warehouse.test"} */
alter table "DataWarehouse"."prod_staging"."test" rename to "test__dbt_backup"
[0m16:28:42.860895 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:28:42.863893 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:28:42.864129 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "node_id": "model.warehouse.test"} */
alter table "DataWarehouse"."prod_staging"."test__dbt_tmp" rename to "test"
[0m16:28:42.914005 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:28:42.929037 [debug] [Thread-1  ]: On model.warehouse.test: COMMIT
[0m16:28:42.929208 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:28:42.929300 [debug] [Thread-1  ]: On model.warehouse.test: COMMIT
[0m16:28:42.977837 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:28:42.983106 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:28:42.983327 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "prod", "node_id": "model.warehouse.test"} */
drop view if exists "DataWarehouse"."prod_staging"."test__dbt_backup" cascade
[0m16:28:43.035797 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:28:43.038150 [debug] [Thread-1  ]: Timing info for model.warehouse.test (execute): 2023-04-09 16:28:42.230565 => 2023-04-09 16:28:43.038073
[0m16:28:43.038558 [debug] [Thread-1  ]: On model.warehouse.test: Close
[0m16:28:43.039842 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be65b65c-7e53-4ff9-a229-4d8ec762ac2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104935d90>]}
[0m16:28:43.040176 [info ] [Thread-1  ]: 1 of 1 OK created sql view model prod_staging.test ............................. [[32mCREATE VIEW[0m in 0.82s]
[0m16:28:43.041026 [debug] [Thread-1  ]: Finished running node model.warehouse.test
[0m16:28:43.042132 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:28:43.042295 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:43.042413 [debug] [MainThread]: On master: BEGIN
[0m16:28:43.042546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:28:43.503234 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:28:43.503776 [debug] [MainThread]: On master: COMMIT
[0m16:28:43.504070 [debug] [MainThread]: Using postgres connection "master"
[0m16:28:43.504355 [debug] [MainThread]: On master: COMMIT
[0m16:28:43.553759 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:28:43.554380 [debug] [MainThread]: On master: Close
[0m16:28:43.555657 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:43.555948 [debug] [MainThread]: Connection 'model.warehouse.test' was properly closed.
[0m16:28:43.556254 [info ] [MainThread]: 
[0m16:28:43.556681 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.22 seconds (3.22s).
[0m16:28:43.557284 [debug] [MainThread]: Command end result
[0m16:28:43.570359 [info ] [MainThread]: 
[0m16:28:43.570700 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:28:43.570917 [info ] [MainThread]: 
[0m16:28:43.571103 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:28:43.571348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047799d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10478bf70>]}
[0m16:28:43.571547 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:28:59.358477 | 2b700b6a-5872-49c8-a941-98820f9c93ba ==============================
[0m16:28:59.358477 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:28:59.359657 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['test'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:28:59.359773 [debug] [MainThread]: Tracking: tracking
[0m16:28:59.373949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072f4d90>]}
[0m16:28:59.381396 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:28:59.388035 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m16:28:59.388269 [debug] [MainThread]: previous checksum: 11d17a60369a0ae8f297a25b75ba496363ddcac082bfb4fd162475eb0901cc9e, current checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6
[0m16:28:59.388372 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:28:59.388525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b700b6a-5872-49c8-a941-98820f9c93ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b52b0>]}
[0m16:28:59.701729 [debug] [MainThread]: 1699: static parser successfully parsed staging/test.sql
[0m16:28:59.731403 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:28:59.734184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b700b6a-5872-49c8-a941-98820f9c93ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107783d00>]}
[0m16:28:59.747242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b700b6a-5872-49c8-a941-98820f9c93ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107035a00>]}
[0m16:28:59.747474 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:28:59.747647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b700b6a-5872-49c8-a941-98820f9c93ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10700b340>]}
[0m16:28:59.748256 [info ] [MainThread]: 
[0m16:28:59.749168 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:28:59.749714 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:28:59.756321 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:28:59.756556 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:28:59.756690 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:00.274084 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:29:00.277667 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:29:00.280398 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:29:00.286699 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:29:00.286958 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:29:00.287119 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:29:00.750677 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:29:00.752051 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:29:00.752825 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:29:00.808233 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:29:00.812942 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:29:00.862540 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:29:00.877149 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:00.877625 [debug] [MainThread]: On master: BEGIN
[0m16:29:00.877953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:01.338554 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:29:01.339830 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:01.340534 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:29:01.402539 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:29:01.405984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b700b6a-5872-49c8-a941-98820f9c93ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107434100>]}
[0m16:29:01.406854 [debug] [MainThread]: On master: ROLLBACK
[0m16:29:01.457314 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:01.458465 [debug] [MainThread]: On master: BEGIN
[0m16:29:01.555436 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:29:01.556814 [debug] [MainThread]: On master: COMMIT
[0m16:29:01.557518 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:01.558177 [debug] [MainThread]: On master: COMMIT
[0m16:29:01.606891 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:29:01.608276 [debug] [MainThread]: On master: Close
[0m16:29:01.610681 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:29:01.611550 [info ] [MainThread]: 
[0m16:29:01.622779 [debug] [Thread-1  ]: Began running node model.warehouse.test
[0m16:29:01.623521 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.test ................................... [RUN]
[0m16:29:01.624569 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.test'
[0m16:29:01.624942 [debug] [Thread-1  ]: Began compiling node model.warehouse.test
[0m16:29:01.628963 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.test"
[0m16:29:01.630533 [debug] [Thread-1  ]: Timing info for model.warehouse.test (compile): 2023-04-09 16:29:01.625197 => 2023-04-09 16:29:01.630419
[0m16:29:01.630900 [debug] [Thread-1  ]: Began executing node model.warehouse.test
[0m16:29:01.669781 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.test"
[0m16:29:01.671189 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:29:01.671345 [debug] [Thread-1  ]: On model.warehouse.test: BEGIN
[0m16:29:01.671487 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:29:02.134626 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:29:02.135565 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:29:02.136034 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.test"} */

  create view "DataWarehouse"."dev_staging"."test__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

)

select * from source limit 5
  );
[0m16:29:02.196162 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:29:02.211222 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:29:02.211598 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.test"} */
alter table "DataWarehouse"."dev_staging"."test" rename to "test__dbt_backup"
[0m16:29:02.263834 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:29:02.271617 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:29:02.272155 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.test"} */
alter table "DataWarehouse"."dev_staging"."test__dbt_tmp" rename to "test"
[0m16:29:02.322527 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:29:02.353976 [debug] [Thread-1  ]: On model.warehouse.test: COMMIT
[0m16:29:02.354272 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:29:02.354489 [debug] [Thread-1  ]: On model.warehouse.test: COMMIT
[0m16:29:02.406618 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:29:02.414926 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.test"
[0m16:29:02.415229 [debug] [Thread-1  ]: On model.warehouse.test: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.test"} */
drop view if exists "DataWarehouse"."dev_staging"."test__dbt_backup" cascade
[0m16:29:02.468214 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:29:02.472902 [debug] [Thread-1  ]: Timing info for model.warehouse.test (execute): 2023-04-09 16:29:01.631123 => 2023-04-09 16:29:02.472729
[0m16:29:02.473403 [debug] [Thread-1  ]: On model.warehouse.test: Close
[0m16:29:02.475134 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b700b6a-5872-49c8-a941-98820f9c93ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079c5a60>]}
[0m16:29:02.476032 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_staging.test .............................. [[32mCREATE VIEW[0m in 0.85s]
[0m16:29:02.478840 [debug] [Thread-1  ]: Finished running node model.warehouse.test
[0m16:29:02.481376 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:29:02.481832 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:02.482139 [debug] [MainThread]: On master: BEGIN
[0m16:29:02.482430 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:02.944105 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:29:02.944690 [debug] [MainThread]: On master: COMMIT
[0m16:29:02.945051 [debug] [MainThread]: Using postgres connection "master"
[0m16:29:02.945409 [debug] [MainThread]: On master: COMMIT
[0m16:29:02.996687 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:29:02.997247 [debug] [MainThread]: On master: Close
[0m16:29:02.998331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:02.998665 [debug] [MainThread]: Connection 'model.warehouse.test' was properly closed.
[0m16:29:02.998985 [info ] [MainThread]: 
[0m16:29:02.999548 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m16:29:03.000433 [debug] [MainThread]: Command end result
[0m16:29:03.007014 [info ] [MainThread]: 
[0m16:29:03.007363 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:29:03.007557 [info ] [MainThread]: 
[0m16:29:03.007738 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:29:03.007955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107035a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077305b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077309d0>]}
[0m16:29:03.008126 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:36:32.709903 | c66b1a99-1b4c-4351-ae04-fe93c196cc33 ==============================
[0m16:36:32.709903 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:36:32.711129 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:36:32.711243 [debug] [MainThread]: Tracking: tracking
[0m16:36:32.734529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dbd2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2f220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d18d90>]}
[0m16:36:32.742663 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:36:32.777552 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:36:32.777827 [debug] [MainThread]: Partial parsing: added file: warehouse://models/staging/base_metadata.sql
[0m16:36:32.777947 [debug] [MainThread]: Partial parsing: deleted file: warehouse://models/staging/test.sql
[0m16:36:32.785548 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:36:32.794970 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:36:32.798120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c66b1a99-1b4c-4351-ae04-fe93c196cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081a49a0>]}
[0m16:36:32.814941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c66b1a99-1b4c-4351-ae04-fe93c196cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108191190>]}
[0m16:36:32.815241 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:36:32.815417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c66b1a99-1b4c-4351-ae04-fe93c196cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1b790>]}
[0m16:36:32.816106 [info ] [MainThread]: 
[0m16:36:32.817088 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:32.817637 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:36:32.824090 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:36:32.824299 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:36:32.824433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:33.469703 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:36:33.472095 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:36:33.474474 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:36:33.482601 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:36:33.482966 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:36:33.483225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:36:33.943877 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:36:33.945192 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:36:33.945893 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:36:34.000876 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:36:34.004278 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:36:34.051636 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:36:34.063293 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:34.063752 [debug] [MainThread]: On master: BEGIN
[0m16:36:34.064064 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:34.531731 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:36:34.533057 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:34.533834 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:36:34.595187 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:36:34.599882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c66b1a99-1b4c-4351-ae04-fe93c196cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108160d30>]}
[0m16:36:34.600914 [debug] [MainThread]: On master: ROLLBACK
[0m16:36:34.651189 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:34.652371 [debug] [MainThread]: On master: BEGIN
[0m16:36:34.754775 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:36:34.755382 [debug] [MainThread]: On master: COMMIT
[0m16:36:34.755767 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:34.756095 [debug] [MainThread]: On master: COMMIT
[0m16:36:34.805073 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:36:34.805670 [debug] [MainThread]: On master: Close
[0m16:36:34.806951 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:36:34.807783 [info ] [MainThread]: 
[0m16:36:34.821544 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:36:34.822798 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:36:34.823433 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:36:34.823612 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:36:34.825583 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:36:34.826626 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:36:34.823720 => 2023-04-09 16:36:34.826553
[0m16:36:34.826835 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:36:34.852935 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:36:34.854153 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:36:34.854319 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:36:34.854424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:36:35.316091 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:36:35.317414 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:36:35.318006 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams:red:has_won::varchar as red_has_won,
        teams:red:rounds_won::varchar as red_rounds_won,
        teams:red:rounds_lost::varchar as red_rounds_lost,
        teams:blue:has_won::varchar as blue_has_won,
        teams:blue:rounds_won::varchar as blue_rounds_won,
        teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from updated

),

final as (

    select * from updated

)

selct * from final
  );
[0m16:36:35.368499 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ":"
LINE 23:         teams:red:has_won::varchar as red_has_won,
                      ^

[0m16:36:35.369627 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:36:35.420038 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:36:34.826942 => 2023-04-09 16:36:35.419872
[0m16:36:35.420532 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:36:35.494055 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  syntax error at or near ":"
  LINE 23:         teams:red:has_won::varchar as red_has_won,
                        ^
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:36:35.494769 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c66b1a99-1b4c-4351-ae04-fe93c196cc33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d18fa0>]}
[0m16:36:35.495407 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.67s]
[0m16:36:35.497584 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:36:35.500165 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:36:35.500617 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:35.500921 [debug] [MainThread]: On master: BEGIN
[0m16:36:35.501206 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:36:35.974609 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:36:35.975701 [debug] [MainThread]: On master: COMMIT
[0m16:36:35.976185 [debug] [MainThread]: Using postgres connection "master"
[0m16:36:35.976616 [debug] [MainThread]: On master: COMMIT
[0m16:36:36.027072 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:36:36.027801 [debug] [MainThread]: On master: Close
[0m16:36:36.029304 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:36:36.029741 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:36:36.030133 [info ] [MainThread]: 
[0m16:36:36.030829 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.21 seconds (3.21s).
[0m16:36:36.031784 [debug] [MainThread]: Command end result
[0m16:36:36.046778 [info ] [MainThread]: 
[0m16:36:36.047406 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:36:36.047819 [info ] [MainThread]: 
[0m16:36:36.048219 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:36:36.048564 [error] [MainThread]:   syntax error at or near ":"
[0m16:36:36.048866 [error] [MainThread]:   LINE 23:         teams:red:has_won::varchar as red_has_won,
[0m16:36:36.049149 [error] [MainThread]:                         ^
[0m16:36:36.049430 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:36:36.049718 [info ] [MainThread]: 
[0m16:36:36.050022 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:36:36.050421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082819d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108191100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d18340>]}
[0m16:36:36.050742 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:39:06.786894 | d6cdad6a-b711-4271-b631-23045f4decf4 ==============================
[0m16:39:06.786894 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:39:06.788179 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:39:06.788291 [debug] [MainThread]: Tracking: tracking
[0m16:39:06.808539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4f3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2358b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2353a0>]}
[0m16:39:06.816185 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:39:06.849824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:39:06.850139 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:39:06.858549 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:39:06.867247 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:39:06.870127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6cdad6a-b711-4271-b631-23045f4decf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa30d0>]}
[0m16:39:06.882591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6cdad6a-b711-4271-b631-23045f4decf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa94160>]}
[0m16:39:06.882820 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:39:06.882985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6cdad6a-b711-4271-b631-23045f4decf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4f8460>]}
[0m16:39:06.883586 [info ] [MainThread]: 
[0m16:39:06.884474 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:06.885032 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:39:06.891519 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:39:06.891731 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:39:06.891850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:07.431240 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:39:07.435663 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:39:07.439301 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:39:07.449457 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:39:07.449843 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:39:07.450134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:07.918366 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:39:07.919123 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:39:07.919530 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:39:07.977256 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:39:07.979981 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:39:08.031837 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:39:08.042958 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:08.043438 [debug] [MainThread]: On master: BEGIN
[0m16:39:08.043751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:08.511130 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:39:08.512510 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:08.513155 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:39:08.575020 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:39:08.579656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6cdad6a-b711-4271-b631-23045f4decf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa624f0>]}
[0m16:39:08.580604 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:08.631651 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:08.633529 [debug] [MainThread]: On master: BEGIN
[0m16:39:08.739129 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:39:08.739694 [debug] [MainThread]: On master: COMMIT
[0m16:39:08.740102 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:08.740501 [debug] [MainThread]: On master: COMMIT
[0m16:39:08.792945 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:39:08.793486 [debug] [MainThread]: On master: Close
[0m16:39:08.794633 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:39:08.795097 [info ] [MainThread]: 
[0m16:39:08.805144 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:39:08.805769 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:39:08.806685 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:39:08.806991 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:39:08.810544 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:39:08.812133 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:39:08.807194 => 2023-04-09 16:39:08.811905
[0m16:39:08.812606 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:39:08.849490 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:39:08.850741 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:39:08.850909 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:39:08.851042 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:39:09.307855 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:39:09.308816 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:39:09.309294 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams['red']
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from updated

),

final as (

    select * from updated

)

selct * from final
  );
[0m16:39:09.361681 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "selct"
LINE 41: selct * from final
         ^

[0m16:39:09.362830 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:39:09.414482 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:39:08.812827 => 2023-04-09 16:39:09.414210
[0m16:39:09.415352 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:39:09.451300 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  syntax error at or near "selct"
  LINE 41: selct * from final
           ^
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:39:09.451907 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6cdad6a-b711-4271-b631-23045f4decf4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab8cd00>]}
[0m16:39:09.452454 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.65s]
[0m16:39:09.454328 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:39:09.456469 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:09.456804 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:09.457050 [debug] [MainThread]: On master: BEGIN
[0m16:39:09.457281 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:09.923040 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:39:09.924510 [debug] [MainThread]: On master: COMMIT
[0m16:39:09.925253 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:09.925940 [debug] [MainThread]: On master: COMMIT
[0m16:39:09.975374 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:39:09.976570 [debug] [MainThread]: On master: Close
[0m16:39:09.978706 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:09.979124 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:39:09.979525 [info ] [MainThread]: 
[0m16:39:09.980016 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m16:39:09.980609 [debug] [MainThread]: Command end result
[0m16:39:09.990644 [info ] [MainThread]: 
[0m16:39:09.991313 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:39:09.991728 [info ] [MainThread]: 
[0m16:39:09.992132 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:39:09.992511 [error] [MainThread]:   syntax error at or near "selct"
[0m16:39:09.992870 [error] [MainThread]:   LINE 41: selct * from final
[0m16:39:09.993222 [error] [MainThread]:            ^
[0m16:39:09.993565 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:39:09.993917 [info ] [MainThread]: 
[0m16:39:09.994278 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:39:09.994740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab82ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2351c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa63250>]}
[0m16:39:09.995064 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:39:18.836322 | fe0f67eb-f541-491c-aee2-58bff147ebc5 ==============================
[0m16:39:18.836322 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:39:18.837425 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:39:18.837534 [debug] [MainThread]: Tracking: tracking
[0m16:39:18.854989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e130a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e23580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e23310>]}
[0m16:39:18.862502 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:39:18.892816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:39:18.893110 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:39:18.900558 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:39:18.909419 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:39:18.912398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe0f67eb-f541-491c-aee2-58bff147ebc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a7fa0>]}
[0m16:39:18.925121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe0f67eb-f541-491c-aee2-58bff147ebc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108297190>]}
[0m16:39:18.925367 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:39:18.925539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe0f67eb-f541-491c-aee2-58bff147ebc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e130a0>]}
[0m16:39:18.926252 [info ] [MainThread]: 
[0m16:39:18.927364 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:18.927924 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:39:18.934280 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:39:18.934481 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:39:18.934602 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:19.408180 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m16:39:19.410873 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:39:19.413509 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:39:19.423199 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:39:19.423594 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:39:19.423848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:19.895061 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:39:19.896043 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:39:19.896393 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:39:19.950621 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:39:19.955311 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:39:20.004156 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:39:20.017334 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.017788 [debug] [MainThread]: On master: BEGIN
[0m16:39:20.018110 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:20.482901 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:39:20.483775 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.484257 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:39:20.547705 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:39:20.552399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe0f67eb-f541-491c-aee2-58bff147ebc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108265d90>]}
[0m16:39:20.553406 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:20.604140 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.605218 [debug] [MainThread]: On master: BEGIN
[0m16:39:20.705329 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:39:20.706472 [debug] [MainThread]: On master: COMMIT
[0m16:39:20.707040 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:20.707532 [debug] [MainThread]: On master: COMMIT
[0m16:39:20.759824 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:39:20.760995 [debug] [MainThread]: On master: Close
[0m16:39:20.763169 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:39:20.763829 [info ] [MainThread]: 
[0m16:39:20.775620 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:39:20.776276 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:39:20.777283 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:39:20.777633 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:39:20.781634 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:39:20.786646 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:39:20.777880 => 2023-04-09 16:39:20.786523
[0m16:39:20.787018 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:39:20.825917 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:39:20.835931 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:39:20.836089 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:39:20.836227 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:39:21.301852 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:39:21.303193 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:39:21.303792 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams['red']
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from updated

),

final as (

    select * from updated

)

select * from final
  );
[0m16:39:21.355000 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "updated" does not exist
LINE 31:     from updated
                  ^
DETAIL:  There is a WITH item named "updated", but it cannot be referenced from this part of the query.
HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.

[0m16:39:21.355958 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:39:21.406898 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:39:20.787218 => 2023-04-09 16:39:21.406717
[0m16:39:21.407407 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:39:21.441546 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  relation "updated" does not exist
  LINE 31:     from updated
                    ^
  DETAIL:  There is a WITH item named "updated", but it cannot be referenced from this part of the query.
  HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:39:21.442159 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fe0f67eb-f541-491c-aee2-58bff147ebc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108266100>]}
[0m16:39:21.442689 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.67s]
[0m16:39:21.444550 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:39:21.446602 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:21.446961 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:21.447209 [debug] [MainThread]: On master: BEGIN
[0m16:39:21.447432 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:21.911181 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:39:21.912544 [debug] [MainThread]: On master: COMMIT
[0m16:39:21.913200 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:21.913832 [debug] [MainThread]: On master: COMMIT
[0m16:39:21.962767 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:39:21.963981 [debug] [MainThread]: On master: Close
[0m16:39:21.966053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:21.966533 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:39:21.967050 [info ] [MainThread]: 
[0m16:39:21.967638 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m16:39:21.968321 [debug] [MainThread]: Command end result
[0m16:39:21.982186 [info ] [MainThread]: 
[0m16:39:21.982814 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:39:21.983216 [info ] [MainThread]: 
[0m16:39:21.983608 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:39:21.983968 [error] [MainThread]:   relation "updated" does not exist
[0m16:39:21.984319 [error] [MainThread]:   LINE 31:     from updated
[0m16:39:21.984658 [error] [MainThread]:                     ^
[0m16:39:21.984937 [error] [MainThread]:   DETAIL:  There is a WITH item named "updated", but it cannot be referenced from this part of the query.
[0m16:39:21.985217 [error] [MainThread]:   HINT:  Use WITH RECURSIVE, or re-order the WITH items to remove forward references.
[0m16:39:21.985494 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:39:21.985786 [info ] [MainThread]: 
[0m16:39:21.986095 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:39:21.986488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108386a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b332e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049a1e80>]}
[0m16:39:21.986806 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:39:33.924978 | 16e66d76-f758-49b1-b9f4-80f5b31890de ==============================
[0m16:39:33.924978 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:39:33.926475 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:39:33.926614 [debug] [MainThread]: Tracking: tracking
[0m16:39:33.940857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045df130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043218b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043213a0>]}
[0m16:39:33.949532 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:39:33.983958 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:39:33.984255 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:39:33.991727 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:39:34.001161 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:39:34.004222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16e66d76-f758-49b1-b9f4-80f5b31890de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a6c0d0>]}
[0m16:39:34.014765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16e66d76-f758-49b1-b9f4-80f5b31890de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a5b220>]}
[0m16:39:34.015051 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:39:34.015234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16e66d76-f758-49b1-b9f4-80f5b31890de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x101059970>]}
[0m16:39:34.016187 [info ] [MainThread]: 
[0m16:39:34.017350 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:34.017940 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:39:34.024850 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:39:34.025084 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:39:34.025245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:34.487854 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m16:39:34.489818 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:39:34.491625 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:39:34.497966 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:39:34.498206 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:39:34.498411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:34.957812 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:39:34.958655 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:39:34.959136 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:39:35.011310 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:39:35.016122 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:39:35.066719 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:39:35.080128 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:35.080563 [debug] [MainThread]: On master: BEGIN
[0m16:39:35.080867 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:35.547772 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:39:35.549092 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:35.549785 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:39:35.611884 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:39:35.614043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16e66d76-f758-49b1-b9f4-80f5b31890de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a280d0>]}
[0m16:39:35.614950 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:35.667860 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:35.669004 [debug] [MainThread]: On master: BEGIN
[0m16:39:35.766756 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:39:35.768095 [debug] [MainThread]: On master: COMMIT
[0m16:39:35.768847 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:35.769527 [debug] [MainThread]: On master: COMMIT
[0m16:39:35.819494 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:39:35.820818 [debug] [MainThread]: On master: Close
[0m16:39:35.823368 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:39:35.824225 [info ] [MainThread]: 
[0m16:39:35.835762 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:39:35.836250 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:39:35.836924 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:39:35.837151 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:39:35.839788 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:39:35.841005 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:39:35.837306 => 2023-04-09 16:39:35.840917
[0m16:39:35.841267 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:39:35.880525 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:39:35.882060 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:39:35.882229 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:39:35.882373 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:39:36.349688 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:39:36.350991 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:39:36.351604 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams['red']
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m16:39:36.402312 [debug] [Thread-1  ]: Postgres adapter: Postgres error: cannot subscript type text because it does not support subscripting
LINE 23:         teams['red']
                 ^

[0m16:39:36.403160 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:39:36.454699 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:39:35.841421 => 2023-04-09 16:39:36.454517
[0m16:39:36.455244 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:39:36.488708 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  cannot subscript type text because it does not support subscripting
  LINE 23:         teams['red']
                   ^
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:39:36.489244 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16e66d76-f758-49b1-b9f4-80f5b31890de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f4100>]}
[0m16:39:36.489720 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.65s]
[0m16:39:36.491283 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:39:36.492997 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:36.493273 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:36.493470 [debug] [MainThread]: On master: BEGIN
[0m16:39:36.493649 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:36.960833 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:39:36.961744 [debug] [MainThread]: On master: COMMIT
[0m16:39:36.962360 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:36.962741 [debug] [MainThread]: On master: COMMIT
[0m16:39:37.015873 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:39:37.016498 [debug] [MainThread]: On master: Close
[0m16:39:37.018488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:37.018966 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:39:37.019294 [info ] [MainThread]: 
[0m16:39:37.019748 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m16:39:37.020280 [debug] [MainThread]: Command end result
[0m16:39:37.029784 [info ] [MainThread]: 
[0m16:39:37.030385 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:39:37.030742 [info ] [MainThread]: 
[0m16:39:37.031092 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:39:37.031413 [error] [MainThread]:   cannot subscript type text because it does not support subscripting
[0m16:39:37.031716 [error] [MainThread]:   LINE 23:         teams['red']
[0m16:39:37.032007 [error] [MainThread]:                    ^
[0m16:39:37.032293 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:39:37.032591 [info ] [MainThread]: 
[0m16:39:37.033167 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:39:37.033668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d8bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f4040>]}
[0m16:39:37.034078 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:39:56.159463 | b6ebc7ba-aa43-4c24-847a-7033f450f348 ==============================
[0m16:39:56.159463 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:39:56.160765 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:39:56.160891 [debug] [MainThread]: Tracking: tracking
[0m16:39:56.189243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce53a0>]}
[0m16:39:56.197176 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:39:56.227440 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:39:56.227741 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:39:56.236251 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:39:56.245380 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:39:56.248406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6ebc7ba-aa43-4c24-847a-7033f450f348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084300d0>]}
[0m16:39:56.265691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6ebc7ba-aa43-4c24-847a-7033f450f348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10841e160>]}
[0m16:39:56.265953 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:39:56.266146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6ebc7ba-aa43-4c24-847a-7033f450f348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa94f0>]}
[0m16:39:56.266787 [info ] [MainThread]: 
[0m16:39:56.267717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:56.268260 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:39:56.275461 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:39:56.275661 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:39:56.275795 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:56.793212 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:39:56.795187 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:39:56.797058 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:39:56.804115 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:39:56.804392 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:39:56.804608 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:57.267865 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:39:57.268243 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:39:57.268473 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:39:57.323439 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:39:57.324945 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:39:57.373439 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:39:57.379969 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:57.380279 [debug] [MainThread]: On master: BEGIN
[0m16:39:57.380493 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:39:57.839023 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:39:57.839693 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:57.840127 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:39:57.902420 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:39:57.907439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6ebc7ba-aa43-4c24-847a-7033f450f348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083ed160>]}
[0m16:39:57.908239 [debug] [MainThread]: On master: ROLLBACK
[0m16:39:57.955200 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:57.956154 [debug] [MainThread]: On master: BEGIN
[0m16:39:58.052584 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:39:58.053248 [debug] [MainThread]: On master: COMMIT
[0m16:39:58.053717 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:58.054072 [debug] [MainThread]: On master: COMMIT
[0m16:39:58.101616 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:39:58.102911 [debug] [MainThread]: On master: Close
[0m16:39:58.104983 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:39:58.105602 [info ] [MainThread]: 
[0m16:39:58.117551 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:39:58.118290 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:39:58.119336 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:39:58.119703 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:39:58.123751 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:39:58.127800 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:39:58.119957 => 2023-04-09 16:39:58.127681
[0m16:39:58.128149 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:39:58.166657 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:39:58.173718 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:39:58.173923 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:39:58.174073 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:39:58.633412 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:39:58.634294 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:39:58.634778 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams[0]
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m16:39:58.683682 [debug] [Thread-1  ]: Postgres adapter: Postgres error: cannot subscript type text because it does not support subscripting
LINE 23:         teams[0]
                 ^

[0m16:39:58.685065 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:39:58.738795 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:39:58.128341 => 2023-04-09 16:39:58.738329
[0m16:39:58.740101 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:39:58.781684 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  cannot subscript type text because it does not support subscripting
  LINE 23:         teams[0]
                   ^
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:39:58.782260 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6ebc7ba-aa43-4c24-847a-7033f450f348', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb8370>]}
[0m16:39:58.782703 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.66s]
[0m16:39:58.784307 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:39:58.786080 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:39:58.786385 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:58.786606 [debug] [MainThread]: On master: BEGIN
[0m16:39:58.786810 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:39:59.245051 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:39:59.246251 [debug] [MainThread]: On master: COMMIT
[0m16:39:59.246796 [debug] [MainThread]: Using postgres connection "master"
[0m16:39:59.247294 [debug] [MainThread]: On master: COMMIT
[0m16:39:59.298418 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:39:59.299589 [debug] [MainThread]: On master: Close
[0m16:39:59.301671 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:39:59.302216 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:39:59.302747 [info ] [MainThread]: 
[0m16:39:59.303345 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m16:39:59.304041 [debug] [MainThread]: Command end result
[0m16:39:59.318451 [info ] [MainThread]: 
[0m16:39:59.319069 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:39:59.319482 [info ] [MainThread]: 
[0m16:39:59.319885 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:39:59.320276 [error] [MainThread]:   cannot subscript type text because it does not support subscripting
[0m16:39:59.320642 [error] [MainThread]:   LINE 23:         teams[0]
[0m16:39:59.320995 [error] [MainThread]:                    ^
[0m16:39:59.321345 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:39:59.321705 [info ] [MainThread]: 
[0m16:39:59.322074 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:39:59.322534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10850dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b29a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce51c0>]}
[0m16:39:59.322913 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:40:13.895238 | 481328d2-e892-4be0-a65e-ba375c2449d2 ==============================
[0m16:40:13.895238 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:40:13.896465 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:40:13.896578 [debug] [MainThread]: Tracking: tracking
[0m16:40:13.912935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092992b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af0b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1f4d90>]}
[0m16:40:13.921118 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:40:13.954335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:40:13.954653 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:40:13.962003 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:40:13.970791 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:40:13.973702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '481328d2-e892-4be0-a65e-ba375c2449d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b67d0d0>]}
[0m16:40:13.984616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '481328d2-e892-4be0-a65e-ba375c2449d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b670190>]}
[0m16:40:13.984925 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:40:13.985098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '481328d2-e892-4be0-a65e-ba375c2449d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1f7790>]}
[0m16:40:13.985721 [info ] [MainThread]: 
[0m16:40:13.986668 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:13.987176 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:40:13.993578 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:40:13.993798 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:40:13.993922 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:14.495037 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:40:14.499599 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:40:14.503341 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:40:14.513063 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:40:14.513448 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:40:14.513773 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:14.973463 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:40:14.974321 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:40:14.975064 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:40:15.028491 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:40:15.033095 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:40:15.083081 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:40:15.095990 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:15.096406 [debug] [MainThread]: On master: BEGIN
[0m16:40:15.096718 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:15.571558 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:40:15.572921 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:15.573620 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:40:15.635681 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:40:15.637390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '481328d2-e892-4be0-a65e-ba375c2449d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b63edf0>]}
[0m16:40:15.637847 [debug] [MainThread]: On master: ROLLBACK
[0m16:40:15.685831 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:15.686110 [debug] [MainThread]: On master: BEGIN
[0m16:40:15.788653 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:40:15.789009 [debug] [MainThread]: On master: COMMIT
[0m16:40:15.789221 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:15.789402 [debug] [MainThread]: On master: COMMIT
[0m16:40:15.837595 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:40:15.837859 [debug] [MainThread]: On master: Close
[0m16:40:15.838798 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:40:15.839174 [info ] [MainThread]: 
[0m16:40:15.846281 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:40:15.846882 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:40:15.847908 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:40:15.848253 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:40:15.851699 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:40:15.852936 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:40:15.848473 => 2023-04-09 16:40:15.852853
[0m16:40:15.853226 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:40:15.888776 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:40:15.890298 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:40:15.890512 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:40:15.890663 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:40:16.352045 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:40:16.352584 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:40:16.352943 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams[0],
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m16:40:16.402948 [debug] [Thread-1  ]: Postgres adapter: Postgres error: cannot subscript type text because it does not support subscripting
LINE 23:         teams[0],
                 ^

[0m16:40:16.403455 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:40:16.453520 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:40:15.853398 => 2023-04-09 16:40:16.453321
[0m16:40:16.454083 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:40:16.490119 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  cannot subscript type text because it does not support subscripting
  LINE 23:         teams[0],
                   ^
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:40:16.490653 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '481328d2-e892-4be0-a65e-ba375c2449d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1f4340>]}
[0m16:40:16.491226 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.64s]
[0m16:40:16.493105 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:40:16.495015 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:40:16.495353 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:16.495575 [debug] [MainThread]: On master: BEGIN
[0m16:40:16.495782 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:16.959703 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:40:16.960777 [debug] [MainThread]: On master: COMMIT
[0m16:40:16.961288 [debug] [MainThread]: Using postgres connection "master"
[0m16:40:16.961819 [debug] [MainThread]: On master: COMMIT
[0m16:40:17.011805 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:40:17.012887 [debug] [MainThread]: On master: Close
[0m16:40:17.014812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:17.015352 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:40:17.016138 [info ] [MainThread]: 
[0m16:40:17.017037 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m16:40:17.017832 [debug] [MainThread]: Command end result
[0m16:40:17.029891 [info ] [MainThread]: 
[0m16:40:17.030522 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:40:17.030941 [info ] [MainThread]: 
[0m16:40:17.031337 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:40:17.031713 [error] [MainThread]:   cannot subscript type text because it does not support subscripting
[0m16:40:17.032075 [error] [MainThread]:   LINE 23:         teams[0],
[0m16:40:17.032423 [error] [MainThread]:                    ^
[0m16:40:17.032767 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:40:17.033170 [info ] [MainThread]: 
[0m16:40:17.033767 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:40:17.034197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b768cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c31970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b63f0a0>]}
[0m16:40:17.034533 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:43:44.166495 | 56815a82-a414-4176-9e01-66b1585f1621 ==============================
[0m16:43:44.166495 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:43:44.167732 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:43:44.167852 [debug] [MainThread]: Tracking: tracking
[0m16:43:44.186670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102fe12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c53340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f3bd90>]}
[0m16:43:44.193960 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:43:44.229945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:43:44.230237 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:43:44.238487 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:43:44.247126 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:43:44.249934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56815a82-a414-4176-9e01-66b1585f1621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043c70d0>]}
[0m16:43:44.264516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '56815a82-a414-4176-9e01-66b1585f1621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b8190>]}
[0m16:43:44.264772 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:43:44.264978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56815a82-a414-4176-9e01-66b1585f1621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f3f790>]}
[0m16:43:44.265699 [info ] [MainThread]: 
[0m16:43:44.266706 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:43:44.267249 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:43:44.273609 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:43:44.273824 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:43:44.273959 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:44.987458 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:43:44.991757 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:43:44.994665 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:43:45.004413 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:43:45.004792 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:43:45.005095 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:43:45.472002 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:43:45.473045 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:43:45.473588 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:43:45.530304 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:43:45.532307 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:43:45.581505 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:43:45.591611 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:45.592062 [debug] [MainThread]: On master: BEGIN
[0m16:43:45.592385 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:46.047643 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:43:46.048291 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:46.048598 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:43:46.110581 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:43:46.114867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56815a82-a414-4176-9e01-66b1585f1621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104386df0>]}
[0m16:43:46.115747 [debug] [MainThread]: On master: ROLLBACK
[0m16:43:46.165999 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:46.166802 [debug] [MainThread]: On master: BEGIN
[0m16:43:46.266042 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:43:46.267445 [debug] [MainThread]: On master: COMMIT
[0m16:43:46.267992 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:46.268471 [debug] [MainThread]: On master: COMMIT
[0m16:43:46.318188 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:43:46.319440 [debug] [MainThread]: On master: Close
[0m16:43:46.322103 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:43:46.322948 [info ] [MainThread]: 
[0m16:43:46.334897 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:43:46.335529 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:43:46.336518 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:43:46.336866 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:43:46.340748 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:43:46.346004 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:43:46.337111 => 2023-04-09 16:43:46.345866
[0m16:43:46.346429 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:43:46.383189 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:43:46.395769 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:43:46.395939 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:43:46.396080 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:43:46.856709 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:43:46.857912 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:43:46.858532 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        f.values,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source,
    lateral flatten(input => teams) f

),

final as (

    select * from updated

)

select * from final
  );
[0m16:43:46.911406 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function flatten(input => text) does not exist
LINE 32:     lateral flatten(input => teams) f
                     ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m16:43:46.912540 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:43:46.962580 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:43:46.346639 => 2023-04-09 16:43:46.962199
[0m16:43:46.963762 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:43:47.000035 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  function flatten(input => text) does not exist
  LINE 32:     lateral flatten(input => teams) f
                       ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:43:47.000635 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '56815a82-a414-4176-9e01-66b1585f1621', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f3b340>]}
[0m16:43:47.001135 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.66s]
[0m16:43:47.002932 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:43:47.004976 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:43:47.005366 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:47.005614 [debug] [MainThread]: On master: BEGIN
[0m16:43:47.005815 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:43:47.469396 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:43:47.470628 [debug] [MainThread]: On master: COMMIT
[0m16:43:47.471206 [debug] [MainThread]: Using postgres connection "master"
[0m16:43:47.471748 [debug] [MainThread]: On master: COMMIT
[0m16:43:47.521813 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:43:47.522916 [debug] [MainThread]: On master: Close
[0m16:43:47.524676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:47.525057 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:43:47.525501 [info ] [MainThread]: 
[0m16:43:47.526105 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.26 seconds (3.26s).
[0m16:43:47.526887 [debug] [MainThread]: Command end result
[0m16:43:47.540959 [info ] [MainThread]: 
[0m16:43:47.541598 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:43:47.542012 [info ] [MainThread]: 
[0m16:43:47.542400 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:43:47.542774 [error] [MainThread]:   function flatten(input => text) does not exist
[0m16:43:47.543145 [error] [MainThread]:   LINE 32:     lateral flatten(input => teams) f
[0m16:43:47.543488 [error] [MainThread]:                        ^
[0m16:43:47.543787 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m16:43:47.544069 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:43:47.544359 [info ] [MainThread]: 
[0m16:43:47.544668 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:43:47.545081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ac1970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f3b520>]}
[0m16:43:47.545408 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:48:40.807928 | 942a4664-41fd-4579-84d7-d16e58d3631d ==============================
[0m16:48:40.807928 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:48:40.809250 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:48:40.809370 [debug] [MainThread]: Tracking: tracking
[0m16:48:40.826954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104263430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f77760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104260d60>]}
[0m16:48:40.834264 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:48:40.869381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:48:40.869685 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:48:40.878208 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:48:40.887029 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:48:40.889929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '942a4664-41fd-4579-84d7-d16e58d3631d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ecfd0>]}
[0m16:48:40.914243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '942a4664-41fd-4579-84d7-d16e58d3631d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046db190>]}
[0m16:48:40.914513 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:48:40.914719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '942a4664-41fd-4579-84d7-d16e58d3631d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f77760>]}
[0m16:48:40.915424 [info ] [MainThread]: 
[0m16:48:40.916491 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:48:40.917072 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:48:40.924053 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:48:40.924266 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:48:40.924406 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:48:41.488226 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:48:41.493002 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:48:41.496698 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:48:41.506156 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:48:41.506538 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:48:41.506835 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:48:41.976711 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:48:41.977736 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:48:41.978136 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:48:42.037087 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:48:42.039722 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:48:42.089119 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:48:42.102758 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:42.103268 [debug] [MainThread]: On master: BEGIN
[0m16:48:42.103575 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:48:42.568719 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:48:42.569669 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:42.570013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:48:42.632139 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:48:42.637437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '942a4664-41fd-4579-84d7-d16e58d3631d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046a9dc0>]}
[0m16:48:42.638655 [debug] [MainThread]: On master: ROLLBACK
[0m16:48:42.689240 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:42.690404 [debug] [MainThread]: On master: BEGIN
[0m16:48:42.788393 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:48:42.789793 [debug] [MainThread]: On master: COMMIT
[0m16:48:42.790516 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:42.791186 [debug] [MainThread]: On master: COMMIT
[0m16:48:42.842221 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:48:42.843583 [debug] [MainThread]: On master: Close
[0m16:48:42.846195 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:48:42.846966 [info ] [MainThread]: 
[0m16:48:42.857935 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:48:42.858560 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:48:42.859550 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:48:42.859886 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:48:42.863874 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:48:42.865748 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:48:42.860120 => 2023-04-09 16:48:42.865609
[0m16:48:42.866137 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:48:42.904109 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:48:42.905448 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:48:42.905593 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:48:42.905718 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:48:43.372286 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:48:43.373443 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:48:43.374131 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams->>'red',
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m16:48:43.424548 [debug] [Thread-1  ]: Postgres adapter: Postgres error: operator does not exist: text ->> unknown
LINE 23:         teams->>'red',
                      ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m16:48:43.425619 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:48:43.476061 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:48:42.866342 => 2023-04-09 16:48:43.475752
[0m16:48:43.477110 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:48:43.515532 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  operator does not exist: text ->> unknown
  LINE 23:         teams->>'red',
                        ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:48:43.516120 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '942a4664-41fd-4579-84d7-d16e58d3631d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f78d30>]}
[0m16:48:43.516623 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.66s]
[0m16:48:43.518416 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:48:43.520481 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:48:43.520803 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:43.521034 [debug] [MainThread]: On master: BEGIN
[0m16:48:43.521251 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:48:43.985338 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:48:43.986552 [debug] [MainThread]: On master: COMMIT
[0m16:48:43.987208 [debug] [MainThread]: Using postgres connection "master"
[0m16:48:43.987924 [debug] [MainThread]: On master: COMMIT
[0m16:48:44.036745 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:48:44.037889 [debug] [MainThread]: On master: Close
[0m16:48:44.040275 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:48:44.040719 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:48:44.041245 [info ] [MainThread]: 
[0m16:48:44.042031 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.13 seconds (3.13s).
[0m16:48:44.042745 [debug] [MainThread]: Command end result
[0m16:48:44.053544 [info ] [MainThread]: 
[0m16:48:44.054148 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:48:44.054544 [info ] [MainThread]: 
[0m16:48:44.054935 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:48:44.055302 [error] [MainThread]:   operator does not exist: text ->> unknown
[0m16:48:44.055660 [error] [MainThread]:   LINE 23:         teams->>'red',
[0m16:48:44.055999 [error] [MainThread]:                         ^
[0m16:48:44.056335 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m16:48:44.056671 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:48:44.057021 [info ] [MainThread]: 
[0m16:48:44.057390 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:48:44.057806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047d3ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042608b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042603d0>]}
[0m16:48:44.058115 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:51:05.275103 | 7b15bbae-4adc-44a7-aff9-796ea3bdcec5 ==============================
[0m16:51:05.275103 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:51:05.276385 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:51:05.276506 [debug] [MainThread]: Tracking: tracking
[0m16:51:05.291184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104054130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d958b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d953a0>]}
[0m16:51:05.298710 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:51:05.331625 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:51:05.331954 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:51:05.339510 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:51:05.348288 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:51:05.351171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7b15bbae-4adc-44a7-aff9-796ea3bdcec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044de0d0>]}
[0m16:51:05.365837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7b15bbae-4adc-44a7-aff9-796ea3bdcec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ce190>]}
[0m16:51:05.366079 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:51:05.366256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b15bbae-4adc-44a7-aff9-796ea3bdcec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d9d880>]}
[0m16:51:05.366903 [info ] [MainThread]: 
[0m16:51:05.367903 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:51:05.368530 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:51:05.375272 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:51:05.375463 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:51:05.375592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:05.903095 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:51:05.906602 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:51:05.908988 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:51:05.919681 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:51:05.920089 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:51:05.920402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:06.368659 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:51:06.369687 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:51:06.370348 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:51:06.420957 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:51:06.425650 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:51:06.472988 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:51:06.487011 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:06.487436 [debug] [MainThread]: On master: BEGIN
[0m16:51:06.487756 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:51:06.942980 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:51:06.944088 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:06.944778 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:51:07.008032 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:51:07.012254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7b15bbae-4adc-44a7-aff9-796ea3bdcec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10449de20>]}
[0m16:51:07.013229 [debug] [MainThread]: On master: ROLLBACK
[0m16:51:07.060503 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:07.061301 [debug] [MainThread]: On master: BEGIN
[0m16:51:07.159121 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:51:07.160413 [debug] [MainThread]: On master: COMMIT
[0m16:51:07.161161 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:07.161955 [debug] [MainThread]: On master: COMMIT
[0m16:51:07.210162 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:51:07.211225 [debug] [MainThread]: On master: Close
[0m16:51:07.213239 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:51:07.213844 [info ] [MainThread]: 
[0m16:51:07.224954 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:51:07.225616 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:51:07.226692 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:51:07.227057 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:51:07.230626 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:51:07.235572 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:51:07.227308 => 2023-04-09 16:51:07.235421
[0m16:51:07.235971 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:51:07.272221 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:51:07.287440 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:51:07.287628 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:51:07.287782 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:51:07.759845 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:51:07.761069 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:51:07.761684 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams -> 'red',
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m16:51:07.812781 [debug] [Thread-1  ]: Postgres adapter: Postgres error: operator does not exist: text -> unknown
LINE 23:         teams -> 'red',
                       ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m16:51:07.814193 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:51:07.864597 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:51:07.236183 => 2023-04-09 16:51:07.864189
[0m16:51:07.865914 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:51:07.908013 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  operator does not exist: text -> unknown
  LINE 23:         teams -> 'red',
                         ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:51:07.908610 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7b15bbae-4adc-44a7-aff9-796ea3bdcec5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c6d00>]}
[0m16:51:07.909151 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.68s]
[0m16:51:07.910995 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:51:07.913005 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:51:07.913309 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:07.913520 [debug] [MainThread]: On master: BEGIN
[0m16:51:07.913721 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:51:08.386075 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:51:08.387377 [debug] [MainThread]: On master: COMMIT
[0m16:51:08.388067 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:08.388768 [debug] [MainThread]: On master: COMMIT
[0m16:51:08.439418 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:51:08.440157 [debug] [MainThread]: On master: Close
[0m16:51:08.441474 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:08.441780 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:51:08.442156 [info ] [MainThread]: 
[0m16:51:08.442634 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m16:51:08.443245 [debug] [MainThread]: Command end result
[0m16:51:08.457553 [info ] [MainThread]: 
[0m16:51:08.458152 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:51:08.458562 [info ] [MainThread]: 
[0m16:51:08.458969 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:51:08.459343 [error] [MainThread]:   operator does not exist: text -> unknown
[0m16:51:08.459705 [error] [MainThread]:   LINE 23:         teams -> 'red',
[0m16:51:08.460053 [error] [MainThread]:                          ^
[0m16:51:08.460401 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m16:51:08.460743 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:51:08.461101 [info ] [MainThread]: 
[0m16:51:08.461472 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:51:08.461933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045c6d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045bcbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d951c0>]}
[0m16:51:08.462262 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:51:20.434365 | 8901f85c-b0b9-4a03-80c2-f47e8ab93de4 ==============================
[0m16:51:20.434365 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:51:20.435566 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:51:20.435690 [debug] [MainThread]: Tracking: tracking
[0m16:51:20.462099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059a7130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e98b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e93a0>]}
[0m16:51:20.470237 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:51:20.507270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:51:20.507625 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:51:20.515018 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:51:20.524395 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:51:20.527313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8901f85c-b0b9-4a03-80c2-f47e8ab93de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e340d0>]}
[0m16:51:20.540068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8901f85c-b0b9-4a03-80c2-f47e8ab93de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e22160>]}
[0m16:51:20.540316 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:51:20.540488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8901f85c-b0b9-4a03-80c2-f47e8ab93de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059ac7f0>]}
[0m16:51:20.541194 [info ] [MainThread]: 
[0m16:51:20.542433 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:51:20.543344 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:51:20.550374 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:51:20.550577 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:51:20.550700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:20.998965 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m16:51:21.002815 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:51:21.006217 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:51:21.015841 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:51:21.016219 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:51:21.016551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:21.467247 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:51:21.468630 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:51:21.469309 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:51:21.523496 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:51:21.528432 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:51:21.576742 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:51:21.590334 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:21.590815 [debug] [MainThread]: On master: BEGIN
[0m16:51:21.591137 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:51:22.044875 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:51:22.045871 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:22.046519 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:51:22.107583 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:51:22.112861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8901f85c-b0b9-4a03-80c2-f47e8ab93de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df1550>]}
[0m16:51:22.113722 [debug] [MainThread]: On master: ROLLBACK
[0m16:51:22.161915 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:22.162643 [debug] [MainThread]: On master: BEGIN
[0m16:51:22.256215 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:51:22.256997 [debug] [MainThread]: On master: COMMIT
[0m16:51:22.257442 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:22.257839 [debug] [MainThread]: On master: COMMIT
[0m16:51:22.306967 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:51:22.307889 [debug] [MainThread]: On master: Close
[0m16:51:22.310580 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:51:22.311386 [info ] [MainThread]: 
[0m16:51:22.323801 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:51:22.324486 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:51:22.325531 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:51:22.325891 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:51:22.329974 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:51:22.331458 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:51:22.326147 => 2023-04-09 16:51:22.331338
[0m16:51:22.331846 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:51:22.370738 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:51:22.372140 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:51:22.372311 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:51:22.372445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:51:22.807705 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:51:22.808676 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:51:22.809163 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams->'red',
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m16:51:22.856826 [debug] [Thread-1  ]: Postgres adapter: Postgres error: operator does not exist: text -> unknown
LINE 23:         teams->'red',
                      ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m16:51:22.858054 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:51:22.903685 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:51:22.332057 => 2023-04-09 16:51:22.903402
[0m16:51:22.904545 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:51:22.945225 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  operator does not exist: text -> unknown
  LINE 23:         teams->'red',
                        ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:51:22.945809 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8901f85c-b0b9-4a03-80c2-f47e8ab93de4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056bc580>]}
[0m16:51:22.946349 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.62s]
[0m16:51:22.948118 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:51:22.949935 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:51:22.950229 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:22.950441 [debug] [MainThread]: On master: BEGIN
[0m16:51:22.950646 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:51:23.383241 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:51:23.384172 [debug] [MainThread]: On master: COMMIT
[0m16:51:23.384619 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:23.384994 [debug] [MainThread]: On master: COMMIT
[0m16:51:23.430844 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:51:23.431761 [debug] [MainThread]: On master: Close
[0m16:51:23.433403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:23.433756 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:51:23.434157 [info ] [MainThread]: 
[0m16:51:23.434684 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.89 seconds (2.89s).
[0m16:51:23.435588 [debug] [MainThread]: Command end result
[0m16:51:23.446162 [info ] [MainThread]: 
[0m16:51:23.446820 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:51:23.447246 [info ] [MainThread]: 
[0m16:51:23.447662 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:51:23.448049 [error] [MainThread]:   operator does not exist: text -> unknown
[0m16:51:23.448404 [error] [MainThread]:   LINE 23:         teams->'red',
[0m16:51:23.448748 [error] [MainThread]:                         ^
[0m16:51:23.449087 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m16:51:23.449427 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:51:23.449780 [info ] [MainThread]: 
[0m16:51:23.450084 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:51:23.450469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0eac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df2160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df2460>]}
[0m16:51:23.450785 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:51:51.097576 | 6c3a2e69-67a8-40f9-9f5b-4a00a7723554 ==============================
[0m16:51:51.097576 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:51:51.098930 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:51:51.099064 [debug] [MainThread]: Tracking: tracking
[0m16:51:51.118320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1093992b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a34b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a667d90>]}
[0m16:51:51.127160 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:51:51.175293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:51:51.175648 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:51:51.184869 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:51:51.194717 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:51:51.197733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c3a2e69-67a8-40f9-9f5b-4a00a7723554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac220d0>]}
[0m16:51:51.212125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c3a2e69-67a8-40f9-9f5b-4a00a7723554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac13190>]}
[0m16:51:51.212420 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:51:51.212615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c3a2e69-67a8-40f9-9f5b-4a00a7723554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a66a790>]}
[0m16:51:51.213306 [info ] [MainThread]: 
[0m16:51:51.214233 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:51:51.214763 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:51:51.220952 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:51:51.221167 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:51:51.221287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:51:51.755079 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:51:51.757373 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:51:51.759866 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:51:51.769278 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:51:51.769675 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:51:51.769935 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:51:52.211298 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:51:52.211732 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:51:52.211961 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:51:52.264960 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:51:52.267052 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:51:52.313949 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:51:52.328041 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:52.328444 [debug] [MainThread]: On master: BEGIN
[0m16:51:52.328775 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:51:52.766374 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:51:52.767080 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:52.767438 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:51:52.826141 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:51:52.828174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c3a2e69-67a8-40f9-9f5b-4a00a7723554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aabedf0>]}
[0m16:51:52.828746 [debug] [MainThread]: On master: ROLLBACK
[0m16:51:52.872862 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:52.873340 [debug] [MainThread]: On master: BEGIN
[0m16:51:52.968782 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:51:52.969770 [debug] [MainThread]: On master: COMMIT
[0m16:51:52.970236 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:52.970981 [debug] [MainThread]: On master: COMMIT
[0m16:51:53.015865 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:51:53.016759 [debug] [MainThread]: On master: Close
[0m16:51:53.018985 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:51:53.019886 [info ] [MainThread]: 
[0m16:51:53.032369 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:51:53.032971 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:51:53.033978 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:51:53.034334 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:51:53.038475 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:51:53.043036 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:51:53.034590 => 2023-04-09 16:51:53.042907
[0m16:51:53.043417 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:51:53.082248 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:51:53.090934 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:51:53.091115 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:51:53.091266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:51:53.527046 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:51:53.527537 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:51:53.527818 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams->>'red',
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m16:51:53.572870 [debug] [Thread-1  ]: Postgres adapter: Postgres error: operator does not exist: text ->> unknown
LINE 23:         teams->>'red',
                      ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m16:51:53.573668 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:51:53.619494 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:51:53.043630 => 2023-04-09 16:51:53.619161
[0m16:51:53.620502 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:51:53.661918 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  operator does not exist: text ->> unknown
  LINE 23:         teams->>'red',
                        ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:51:53.662451 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c3a2e69-67a8-40f9-9f5b-4a00a7723554', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a667ee0>]}
[0m16:51:53.662979 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.63s]
[0m16:51:53.664818 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:51:53.666691 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:51:53.666989 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:53.667197 [debug] [MainThread]: On master: BEGIN
[0m16:51:53.667390 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:51:54.115912 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:51:54.117368 [debug] [MainThread]: On master: COMMIT
[0m16:51:54.118057 [debug] [MainThread]: Using postgres connection "master"
[0m16:51:54.118766 [debug] [MainThread]: On master: COMMIT
[0m16:51:54.166755 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:51:54.167648 [debug] [MainThread]: On master: Close
[0m16:51:54.169111 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:51:54.169428 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:51:54.170052 [info ] [MainThread]: 
[0m16:51:54.170723 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m16:51:54.171416 [debug] [MainThread]: Command end result
[0m16:51:54.183348 [info ] [MainThread]: 
[0m16:51:54.183865 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:51:54.184199 [info ] [MainThread]: 
[0m16:51:54.184702 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:51:54.185051 [error] [MainThread]:   operator does not exist: text ->> unknown
[0m16:51:54.185371 [error] [MainThread]:   LINE 23:         teams->>'red',
[0m16:51:54.185663 [error] [MainThread]:                         ^
[0m16:51:54.185948 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m16:51:54.186232 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:51:54.186522 [info ] [MainThread]: 
[0m16:51:54.186823 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:51:54.187209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad0bcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aabf1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aabf2b0>]}
[0m16:51:54.187526 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:52:05.179538 | 3c18777e-234c-441d-b21c-a12b3232041b ==============================
[0m16:52:05.179538 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:52:05.180780 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:52:05.180924 [debug] [MainThread]: Tracking: tracking
[0m16:52:05.194697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104470a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110452580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110452310>]}
[0m16:52:05.202145 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:52:05.234768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:52:05.235085 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:52:05.243094 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:52:05.252359 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:52:05.255391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c18777e-234c-441d-b21c-a12b3232041b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d7fa0>]}
[0m16:52:05.266894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c18777e-234c-441d-b21c-a12b3232041b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108c7190>]}
[0m16:52:05.267152 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:52:05.267335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c18777e-234c-441d-b21c-a12b3232041b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104470a0>]}
[0m16:52:05.268059 [info ] [MainThread]: 
[0m16:52:05.269007 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:05.269528 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:52:05.276045 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:52:05.276245 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:52:05.276374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:05.739187 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m16:52:05.741488 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:52:05.743782 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:52:05.752584 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:52:05.752883 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:52:05.753134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:06.191473 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:52:06.192482 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:52:06.193138 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:52:06.244142 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:52:06.248019 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:52:06.293644 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:52:06.304820 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:06.305169 [debug] [MainThread]: On master: BEGIN
[0m16:52:06.305456 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:06.750457 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:52:06.751517 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:06.752183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:52:06.814240 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:52:06.818309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c18777e-234c-441d-b21c-a12b3232041b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110896f10>]}
[0m16:52:06.819214 [debug] [MainThread]: On master: ROLLBACK
[0m16:52:06.867042 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:06.868009 [debug] [MainThread]: On master: BEGIN
[0m16:52:06.962691 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:52:06.963946 [debug] [MainThread]: On master: COMMIT
[0m16:52:06.965271 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:06.965960 [debug] [MainThread]: On master: COMMIT
[0m16:52:07.013231 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:52:07.014383 [debug] [MainThread]: On master: Close
[0m16:52:07.016986 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:52:07.017795 [info ] [MainThread]: 
[0m16:52:07.029293 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:52:07.029958 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:52:07.030973 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:52:07.031319 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:52:07.035205 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:52:07.036558 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:52:07.031557 => 2023-04-09 16:52:07.036444
[0m16:52:07.036915 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:52:07.072695 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:52:07.074183 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:52:07.074362 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:52:07.074507 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:52:07.517257 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:52:07.518316 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:52:07.518914 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams.red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m16:52:07.566181 [debug] [Thread-1  ]: Postgres adapter: Postgres error: missing FROM-clause entry for table "teams"
LINE 23:         teams.red,
                 ^

[0m16:52:07.567266 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:52:07.612808 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:52:07.037119 => 2023-04-09 16:52:07.612418
[0m16:52:07.613907 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:52:07.653261 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  missing FROM-clause entry for table "teams"
  LINE 23:         teams.red,
                   ^
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:52:07.653797 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c18777e-234c-441d-b21c-a12b3232041b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104edd970>]}
[0m16:52:07.654302 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.62s]
[0m16:52:07.656088 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:52:07.658071 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:07.658384 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:07.658598 [debug] [MainThread]: On master: BEGIN
[0m16:52:07.658795 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:52:08.094666 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:52:08.095879 [debug] [MainThread]: On master: COMMIT
[0m16:52:08.096373 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:08.096883 [debug] [MainThread]: On master: COMMIT
[0m16:52:08.141858 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:52:08.142668 [debug] [MainThread]: On master: Close
[0m16:52:08.144634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:08.145116 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:52:08.145675 [info ] [MainThread]: 
[0m16:52:08.146395 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m16:52:08.147169 [debug] [MainThread]: Command end result
[0m16:52:08.158442 [info ] [MainThread]: 
[0m16:52:08.159070 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:52:08.159471 [info ] [MainThread]: 
[0m16:52:08.159858 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:52:08.160220 [error] [MainThread]:   missing FROM-clause entry for table "teams"
[0m16:52:08.160562 [error] [MainThread]:   LINE 23:         teams.red,
[0m16:52:08.160899 [error] [MainThread]:                    ^
[0m16:52:08.161229 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:52:08.161572 [info ] [MainThread]: 
[0m16:52:08.161932 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:52:08.162387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dc1a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108c7100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110163490>]}
[0m16:52:08.162715 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:52:22.218603 | 68d01d81-0076-4e2c-aa89-8af51ec04c81 ==============================
[0m16:52:22.218603 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:52:22.220200 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:52:22.220360 [debug] [MainThread]: Tracking: tracking
[0m16:52:22.246250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ac3400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112801790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112801dc0>]}
[0m16:52:22.256899 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:52:22.297163 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:52:22.297468 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:52:22.307263 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:52:22.317837 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:52:22.321212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68d01d81-0076-4e2c-aa89-8af51ec04c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113063f40>]}
[0m16:52:22.335910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68d01d81-0076-4e2c-aa89-8af51ec04c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130531c0>]}
[0m16:52:22.336324 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:52:22.336530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68d01d81-0076-4e2c-aa89-8af51ec04c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113053100>]}
[0m16:52:22.337311 [info ] [MainThread]: 
[0m16:52:22.338373 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:22.338943 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:52:22.346139 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:52:22.346388 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:52:22.346521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:22.794184 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m16:52:22.795559 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:52:22.796734 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:52:22.800259 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:52:22.800440 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:52:22.800551 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:23.259546 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:52:23.259799 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:52:23.259921 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:52:23.311794 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:52:23.312968 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:52:23.360626 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:52:23.366221 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:23.366453 [debug] [MainThread]: On master: BEGIN
[0m16:52:23.366575 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:23.837880 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:52:23.838482 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:23.838944 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:52:23.902723 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:52:23.905797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68d01d81-0076-4e2c-aa89-8af51ec04c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113021cd0>]}
[0m16:52:23.906715 [debug] [MainThread]: On master: ROLLBACK
[0m16:52:23.956538 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:23.957109 [debug] [MainThread]: On master: BEGIN
[0m16:52:24.059182 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:52:24.059494 [debug] [MainThread]: On master: COMMIT
[0m16:52:24.059893 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:24.060024 [debug] [MainThread]: On master: COMMIT
[0m16:52:24.110079 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:52:24.110437 [debug] [MainThread]: On master: Close
[0m16:52:24.111111 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:52:24.111366 [info ] [MainThread]: 
[0m16:52:24.115572 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:52:24.115837 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:52:24.116228 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:52:24.116354 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:52:24.118237 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:52:24.123435 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:52:24.116444 => 2023-04-09 16:52:24.123241
[0m16:52:24.123678 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:52:24.151038 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:52:24.159260 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:52:24.159489 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:52:24.159615 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:52:24.584412 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:52:24.584624 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:52:24.584729 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m16:52:24.630256 [debug] [Thread-1  ]: Postgres adapter: Postgres error: type "red" does not exist
LINE 23:         teams::red,
                        ^

[0m16:52:24.630584 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:52:24.677808 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:52:24.123897 => 2023-04-09 16:52:24.677625
[0m16:52:24.678412 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:52:24.703747 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  type "red" does not exist
  LINE 23:         teams::red,
                          ^
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:52:24.704035 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68d01d81-0076-4e2c-aa89-8af51ec04c81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126a81f0>]}
[0m16:52:24.704290 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.59s]
[0m16:52:24.705168 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:52:24.706961 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:52:24.707190 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:24.707300 [debug] [MainThread]: On master: BEGIN
[0m16:52:24.707414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:52:25.152908 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:52:25.153418 [debug] [MainThread]: On master: COMMIT
[0m16:52:25.153716 [debug] [MainThread]: Using postgres connection "master"
[0m16:52:25.154004 [debug] [MainThread]: On master: COMMIT
[0m16:52:25.202532 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:52:25.203368 [debug] [MainThread]: On master: Close
[0m16:52:25.205285 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:25.205815 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:52:25.206407 [info ] [MainThread]: 
[0m16:52:25.207278 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m16:52:25.208340 [debug] [MainThread]: Command end result
[0m16:52:25.229105 [info ] [MainThread]: 
[0m16:52:25.229884 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:52:25.230357 [info ] [MainThread]: 
[0m16:52:25.230849 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:52:25.231429 [error] [MainThread]:   type "red" does not exist
[0m16:52:25.231988 [error] [MainThread]:   LINE 23:         teams::red,
[0m16:52:25.232377 [error] [MainThread]:                           ^
[0m16:52:25.232827 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:52:25.233311 [info ] [MainThread]: 
[0m16:52:25.233781 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:52:25.234136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113142a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112801790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113022190>]}
[0m16:52:25.234311 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:53:36.040844 | 4616eff9-8c41-40d7-942e-0eac9b830e90 ==============================
[0m16:53:36.040844 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:53:36.042372 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:53:36.042525 [debug] [MainThread]: Tracking: tracking
[0m16:53:36.066572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fe4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d258b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d253a0>]}
[0m16:53:36.073893 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:53:36.106405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:53:36.106687 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:53:36.115089 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:53:36.124148 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:53:36.126964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4616eff9-8c41-40d7-942e-0eac9b830e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10646f0d0>]}
[0m16:53:36.139469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4616eff9-8c41-40d7-942e-0eac9b830e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645e190>]}
[0m16:53:36.139731 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:53:36.139932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4616eff9-8c41-40d7-942e-0eac9b830e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d2d070>]}
[0m16:53:36.140588 [info ] [MainThread]: 
[0m16:53:36.141586 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:53:36.142112 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:53:36.148453 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:53:36.148608 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:53:36.148735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:36.657125 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:53:36.659678 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:53:36.661866 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:53:36.670283 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:53:36.670625 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:53:36.670897 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:53:37.123227 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:53:37.125669 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:53:37.126491 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:53:37.180736 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:53:37.185495 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:53:37.232647 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:53:37.246289 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:37.246724 [debug] [MainThread]: On master: BEGIN
[0m16:53:37.247045 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:53:37.736701 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:53:37.738059 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:37.738756 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:53:37.803222 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:53:37.807205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4616eff9-8c41-40d7-942e-0eac9b830e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642de20>]}
[0m16:53:37.808051 [debug] [MainThread]: On master: ROLLBACK
[0m16:53:37.857058 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:37.858444 [debug] [MainThread]: On master: BEGIN
[0m16:53:37.959537 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:53:37.960584 [debug] [MainThread]: On master: COMMIT
[0m16:53:37.961108 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:37.961701 [debug] [MainThread]: On master: COMMIT
[0m16:53:38.014144 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:53:38.014783 [debug] [MainThread]: On master: Close
[0m16:53:38.016268 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:53:38.016895 [info ] [MainThread]: 
[0m16:53:38.026653 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:53:38.027287 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:53:38.028315 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:53:38.028696 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:53:38.032629 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:53:38.034082 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:53:38.028955 => 2023-04-09 16:53:38.033982
[0m16:53:38.034425 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:53:38.073098 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:53:38.074290 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:53:38.074454 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:53:38.074591 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:53:38.514537 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:53:38.515960 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:53:38.516601 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams->red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m16:53:38.563418 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "red" does not exist
LINE 23:         teams->red,
                        ^

[0m16:53:38.564691 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:53:38.611730 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:53:38.034629 => 2023-04-09 16:53:38.611307
[0m16:53:38.612884 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:53:38.651184 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  column "red" does not exist
  LINE 23:         teams->red,
                          ^
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:53:38.651753 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4616eff9-8c41-40d7-942e-0eac9b830e90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cf8160>]}
[0m16:53:38.652263 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.62s]
[0m16:53:38.654088 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:53:38.656091 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:53:38.656454 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:38.656714 [debug] [MainThread]: On master: BEGIN
[0m16:53:38.656955 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:53:39.107590 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:53:39.109148 [debug] [MainThread]: On master: COMMIT
[0m16:53:39.109846 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:39.110560 [debug] [MainThread]: On master: COMMIT
[0m16:53:39.159461 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:53:39.160977 [debug] [MainThread]: On master: Close
[0m16:53:39.163602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:53:39.164108 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:53:39.164706 [info ] [MainThread]: 
[0m16:53:39.165475 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m16:53:39.166222 [debug] [MainThread]: Command end result
[0m16:53:39.177414 [info ] [MainThread]: 
[0m16:53:39.178085 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:53:39.178521 [info ] [MainThread]: 
[0m16:53:39.178943 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:53:39.179346 [error] [MainThread]:   column "red" does not exist
[0m16:53:39.179722 [error] [MainThread]:   LINE 23:         teams->red,
[0m16:53:39.180087 [error] [MainThread]:                           ^
[0m16:53:39.180451 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:53:39.180824 [info ] [MainThread]: 
[0m16:53:39.181206 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:53:39.181626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106556d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d251c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642e2b0>]}
[0m16:53:39.181971 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:53:57.543601 | b4c357c5-4bb9-4018-af38-3ccd9a8f9b06 ==============================
[0m16:53:57.543601 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:53:57.544984 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:53:57.545167 [debug] [MainThread]: Tracking: tracking
[0m16:53:57.559369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f07430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1b760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f04d60>]}
[0m16:53:57.566419 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:53:57.597259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:53:57.597556 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:53:57.605703 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:53:57.614127 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:53:57.617005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b4c357c5-4bb9-4018-af38-3ccd9a8f9b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064a3fd0>]}
[0m16:53:57.632267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b4c357c5-4bb9-4018-af38-3ccd9a8f9b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106493190>]}
[0m16:53:57.632520 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:53:57.632707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4c357c5-4bb9-4018-af38-3ccd9a8f9b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1b760>]}
[0m16:53:57.633374 [info ] [MainThread]: 
[0m16:53:57.634349 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:53:57.634915 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:53:57.641712 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:53:57.641906 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:53:57.642034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:53:58.192608 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:53:58.198839 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:53:58.201969 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:53:58.211011 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:53:58.211356 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:53:58.211618 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:53:58.661059 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:53:58.662129 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:53:58.662765 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:53:58.717047 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:53:58.720552 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:53:58.767611 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:53:58.780622 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:58.781045 [debug] [MainThread]: On master: BEGIN
[0m16:53:58.781352 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:53:59.234957 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:53:59.235371 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:59.235658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:53:59.294736 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:53:59.296570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b4c357c5-4bb9-4018-af38-3ccd9a8f9b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106462dc0>]}
[0m16:53:59.297049 [debug] [MainThread]: On master: ROLLBACK
[0m16:53:59.346557 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:59.346870 [debug] [MainThread]: On master: BEGIN
[0m16:53:59.441482 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:53:59.441915 [debug] [MainThread]: On master: COMMIT
[0m16:53:59.442155 [debug] [MainThread]: Using postgres connection "master"
[0m16:53:59.442367 [debug] [MainThread]: On master: COMMIT
[0m16:53:59.492989 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:53:59.493391 [debug] [MainThread]: On master: Close
[0m16:53:59.494531 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:53:59.495002 [info ] [MainThread]: 
[0m16:53:59.503891 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:53:59.504425 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:53:59.505306 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:53:59.505620 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:53:59.509010 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:53:59.513510 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:53:59.505818 => 2023-04-09 16:53:59.513376
[0m16:53:59.513920 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:53:59.549756 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:53:59.557268 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:53:59.557454 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:53:59.557590 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:53:59.999704 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:54:00.001072 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:54:00.001831 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams->'red',
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m16:54:00.048982 [debug] [Thread-1  ]: Postgres adapter: Postgres error: operator does not exist: text -> unknown
LINE 23:         teams->'red',
                      ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m16:54:00.049800 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:54:00.096556 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:53:59.514103 => 2023-04-09 16:54:00.096375
[0m16:54:00.097110 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:54:00.131515 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  operator does not exist: text -> unknown
  LINE 23:         teams->'red',
                        ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:54:00.131961 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b4c357c5-4bb9-4018-af38-3ccd9a8f9b06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1c130>]}
[0m16:54:00.132387 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.63s]
[0m16:54:00.133930 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:54:00.135492 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:54:00.135743 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:00.135933 [debug] [MainThread]: On master: BEGIN
[0m16:54:00.136111 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:54:00.575953 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:54:00.576452 [debug] [MainThread]: On master: COMMIT
[0m16:54:00.576776 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:00.577087 [debug] [MainThread]: On master: COMMIT
[0m16:54:00.623662 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:54:00.624626 [debug] [MainThread]: On master: Close
[0m16:54:00.626905 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:00.627446 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:54:00.627853 [info ] [MainThread]: 
[0m16:54:00.628409 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m16:54:00.629052 [debug] [MainThread]: Command end result
[0m16:54:00.642270 [info ] [MainThread]: 
[0m16:54:00.642798 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:54:00.643132 [info ] [MainThread]: 
[0m16:54:00.643452 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:54:00.643754 [error] [MainThread]:   operator does not exist: text -> unknown
[0m16:54:00.644060 [error] [MainThread]:   LINE 23:         teams->'red',
[0m16:54:00.644599 [error] [MainThread]:                         ^
[0m16:54:00.644937 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m16:54:00.645245 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:54:00.645592 [info ] [MainThread]: 
[0m16:54:00.645924 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:54:00.646343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10708bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1cbb0>]}
[0m16:54:00.646685 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:54:08.488087 | d1ec6803-503a-4108-bdf1-155e4b408a71 ==============================
[0m16:54:08.488087 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:54:08.489201 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:54:08.489310 [debug] [MainThread]: Tracking: tracking
[0m16:54:08.503181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610b760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f4d60>]}
[0m16:54:08.510791 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:54:08.542299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:54:08.542589 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:54:08.549723 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:54:08.558263 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:54:08.561086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd1ec6803-503a-4108-bdf1-155e4b408a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba4fd0>]}
[0m16:54:08.576088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd1ec6803-503a-4108-bdf1-155e4b408a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b93190>]}
[0m16:54:08.576382 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:54:08.576572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1ec6803-503a-4108-bdf1-155e4b408a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610b760>]}
[0m16:54:08.577224 [info ] [MainThread]: 
[0m16:54:08.578192 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:54:08.578712 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:54:08.585322 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:54:08.585564 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:54:08.585704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:09.032729 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m16:54:09.035119 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:54:09.037412 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:54:09.046431 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:54:09.046742 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:54:09.046995 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:09.540371 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:54:09.541541 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:54:09.542210 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:54:09.597198 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:54:09.601413 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:54:09.650343 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:54:09.664113 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:09.664637 [debug] [MainThread]: On master: BEGIN
[0m16:54:09.664975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:54:10.102061 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:54:10.103441 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:10.104129 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:54:10.161079 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:54:10.165622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd1ec6803-503a-4108-bdf1-155e4b408a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b61dc0>]}
[0m16:54:10.166692 [debug] [MainThread]: On master: ROLLBACK
[0m16:54:10.211125 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:10.211875 [debug] [MainThread]: On master: BEGIN
[0m16:54:10.303865 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:54:10.305190 [debug] [MainThread]: On master: COMMIT
[0m16:54:10.306005 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:10.306718 [debug] [MainThread]: On master: COMMIT
[0m16:54:10.351113 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:54:10.352004 [debug] [MainThread]: On master: Close
[0m16:54:10.354436 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:54:10.355222 [info ] [MainThread]: 
[0m16:54:10.368226 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:54:10.368870 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:54:10.369881 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:54:10.370233 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:54:10.374307 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:54:10.375672 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:54:10.370481 => 2023-04-09 16:54:10.375584
[0m16:54:10.375972 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:54:10.414417 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:54:10.415745 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:54:10.415884 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:54:10.416006 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:54:10.866616 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:54:10.868008 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:54:10.868645 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams->'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m16:54:10.918521 [debug] [Thread-1  ]: Postgres adapter: Postgres error: operator does not exist: text -> unknown
LINE 23:         teams->'red' as red,
                      ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m16:54:10.919802 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m16:54:10.970438 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:54:10.376154 => 2023-04-09 16:54:10.969989
[0m16:54:10.971700 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:54:11.013562 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  operator does not exist: text -> unknown
  LINE 23:         teams->'red' as red,
                        ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:54:11.014079 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd1ec6803-503a-4108-bdf1-155e4b408a71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063f4100>]}
[0m16:54:11.014575 [error] [Thread-1  ]: 1 of 1 ERROR creating sql view model dev_staging.base_metadata ................. [[31mERROR[0m in 0.64s]
[0m16:54:11.016349 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:54:11.018395 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:54:11.018774 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:11.019029 [debug] [MainThread]: On master: BEGIN
[0m16:54:11.019279 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:54:11.490980 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:54:11.492309 [debug] [MainThread]: On master: COMMIT
[0m16:54:11.493016 [debug] [MainThread]: Using postgres connection "master"
[0m16:54:11.493698 [debug] [MainThread]: On master: COMMIT
[0m16:54:11.545835 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:54:11.547223 [debug] [MainThread]: On master: Close
[0m16:54:11.549331 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:11.549909 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:54:11.550490 [info ] [MainThread]: 
[0m16:54:11.551113 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.97 seconds (2.97s).
[0m16:54:11.551801 [debug] [MainThread]: Command end result
[0m16:54:11.562671 [info ] [MainThread]: 
[0m16:54:11.563319 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:54:11.563744 [info ] [MainThread]: 
[0m16:54:11.564131 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m16:54:11.564502 [error] [MainThread]:   operator does not exist: text -> unknown
[0m16:54:11.564854 [error] [MainThread]:   LINE 23:         teams->'red' as red,
[0m16:54:11.565191 [error] [MainThread]:                         ^
[0m16:54:11.565521 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m16:54:11.565851 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m16:54:11.566189 [info ] [MainThread]: 
[0m16:54:11.566548 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:54:11.567000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d8bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b62400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b62250>]}
[0m16:54:11.567384 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 16:55:51.125557 | be64087e-52c6-4824-b126-060256fd9f6c ==============================
[0m16:55:51.125557 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:55:51.126963 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:55:51.127112 [debug] [MainThread]: Tracking: tracking
[0m16:55:51.147868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ff53a0>]}
[0m16:55:51.155266 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:55:51.191852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:55:51.192146 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m16:55:51.199595 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m16:55:51.208770 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:55:51.211842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be64087e-52c6-4824-b126-060256fd9f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071630d0>]}
[0m16:55:51.226814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be64087e-52c6-4824-b126-060256fd9f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107151160>]}
[0m16:55:51.227079 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:55:51.227257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be64087e-52c6-4824-b126-060256fd9f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b9460>]}
[0m16:55:51.227931 [info ] [MainThread]: 
[0m16:55:51.228875 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:55:51.229367 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:55:51.235695 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:55:51.235898 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:55:51.236020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:55:51.763944 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:55:51.770335 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:55:51.773644 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:55:51.784023 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:55:51.784499 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:55:51.784823 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:55:52.240440 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:55:52.241813 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:55:52.242482 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:55:52.296518 [debug] [ThreadPool]: SQL status: SELECT 1 in 0 seconds
[0m16:55:52.301688 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:55:52.349070 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:55:52.363245 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:52.363745 [debug] [MainThread]: On master: BEGIN
[0m16:55:52.364075 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:55:52.832858 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:55:52.833472 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:52.833798 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:55:52.898404 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:55:52.903321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be64087e-52c6-4824-b126-060256fd9f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107122490>]}
[0m16:55:52.904224 [debug] [MainThread]: On master: ROLLBACK
[0m16:55:52.955894 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:52.957192 [debug] [MainThread]: On master: BEGIN
[0m16:55:53.060449 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:55:53.061679 [debug] [MainThread]: On master: COMMIT
[0m16:55:53.062425 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:53.063107 [debug] [MainThread]: On master: COMMIT
[0m16:55:53.110217 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:55:53.111079 [debug] [MainThread]: On master: Close
[0m16:55:53.113500 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:55:53.114505 [info ] [MainThread]: 
[0m16:55:53.128316 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m16:55:53.128926 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m16:55:53.129906 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m16:55:53.130255 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m16:55:53.134330 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m16:55:53.138598 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 16:55:53.130501 => 2023-04-09 16:55:53.138465
[0m16:55:53.138984 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m16:55:53.178188 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m16:55:53.191228 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:55:53.191387 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m16:55:53.191525 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:55:53.666743 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:55:53.668080 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:55:53.668704 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json->'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m16:55:53.728115 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m16:55:53.745441 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:55:53.745871 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */
alter table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" rename to "base_metadata"
[0m16:55:53.794773 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:55:53.823329 [debug] [Thread-1  ]: On model.warehouse.base_metadata: COMMIT
[0m16:55:53.823613 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:55:53.823826 [debug] [Thread-1  ]: On model.warehouse.base_metadata: COMMIT
[0m16:55:53.872054 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:55:53.880458 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m16:55:53.880765 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */
drop view if exists "DataWarehouse"."dev_staging"."base_metadata__dbt_backup" cascade
[0m16:55:53.929789 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m16:55:53.933510 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 16:55:53.139181 => 2023-04-09 16:55:53.933403
[0m16:55:53.933926 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m16:55:53.935441 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be64087e-52c6-4824-b126-060256fd9f6c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10721cd90>]}
[0m16:55:53.936229 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_staging.base_metadata ..................... [[32mCREATE VIEW[0m in 0.81s]
[0m16:55:53.938821 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m16:55:53.941376 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:55:53.941822 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:53.942134 [debug] [MainThread]: On master: BEGIN
[0m16:55:53.942423 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:55:54.412363 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:55:54.413824 [debug] [MainThread]: On master: COMMIT
[0m16:55:54.414503 [debug] [MainThread]: Using postgres connection "master"
[0m16:55:54.415598 [debug] [MainThread]: On master: COMMIT
[0m16:55:54.466678 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:55:54.468009 [debug] [MainThread]: On master: Close
[0m16:55:54.470421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:55:54.470904 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m16:55:54.471477 [info ] [MainThread]: 
[0m16:55:54.472137 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m16:55:54.472900 [debug] [MainThread]: Command end result
[0m16:55:54.486627 [info ] [MainThread]: 
[0m16:55:54.487246 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:55:54.487672 [info ] [MainThread]: 
[0m16:55:54.488067 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:55:54.488545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10724bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107180940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107122d30>]}
[0m16:55:54.488941 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:05:13.073771 | c60ea9c5-ffa0-4218-9754-400155c4ab2f ==============================
[0m17:05:13.073771 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:05:13.075101 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:05:13.075227 [debug] [MainThread]: Tracking: tracking
[0m17:05:13.099528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b412b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077b3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9cd90>]}
[0m17:05:13.106905 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:05:13.139153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:05:13.139433 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:05:13.147877 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:05:13.156692 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:05:13.159744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c60ea9c5-ffa0-4218-9754-400155c4ab2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f270d0>]}
[0m17:05:13.174824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c60ea9c5-ffa0-4218-9754-400155c4ab2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f16190>]}
[0m17:05:13.175060 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:05:13.175256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c60ea9c5-ffa0-4218-9754-400155c4ab2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a9f790>]}
[0m17:05:13.175916 [info ] [MainThread]: 
[0m17:05:13.176910 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:05:13.177391 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:05:13.184006 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:05:13.184212 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:05:13.184329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:13.675415 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m17:05:13.678395 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:05:13.680205 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:05:13.690538 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:05:13.690761 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:05:13.690884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:14.142919 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:05:14.143828 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:05:14.144448 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:05:14.199258 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:05:14.202911 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:05:14.249364 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:05:14.261626 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:14.262076 [debug] [MainThread]: On master: BEGIN
[0m17:05:14.262384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:05:14.700436 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:05:14.701713 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:14.702312 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:05:14.760819 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:05:14.764484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c60ea9c5-ffa0-4218-9754-400155c4ab2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6a760>]}
[0m17:05:14.765326 [debug] [MainThread]: On master: ROLLBACK
[0m17:05:14.809481 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:14.810213 [debug] [MainThread]: On master: BEGIN
[0m17:05:14.906058 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:05:14.906498 [debug] [MainThread]: On master: COMMIT
[0m17:05:14.906812 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:14.907093 [debug] [MainThread]: On master: COMMIT
[0m17:05:14.952758 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:05:14.953069 [debug] [MainThread]: On master: Close
[0m17:05:14.953809 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:05:14.954106 [info ] [MainThread]: 
[0m17:05:14.961867 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:05:14.962277 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m17:05:14.962866 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:05:14.963061 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:05:14.966101 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:05:14.967463 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:05:14.963191 => 2023-04-09 17:05:14.967383
[0m17:05:14.967695 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:05:14.995619 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:05:14.996683 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:05:14.996811 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:05:14.996922 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:05:15.468672 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:05:15.468885 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:05:15.468983 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json->'red'::varchar as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m17:05:15.527111 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:05:15.531750 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:05:15.531955 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */
alter table "DataWarehouse"."dev_staging"."base_metadata" rename to "base_metadata__dbt_backup"
[0m17:05:15.582203 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:05:15.584514 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:05:15.584679 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */
alter table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" rename to "base_metadata"
[0m17:05:15.633695 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:05:15.655335 [debug] [Thread-1  ]: On model.warehouse.base_metadata: COMMIT
[0m17:05:15.655827 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:05:15.656014 [debug] [Thread-1  ]: On model.warehouse.base_metadata: COMMIT
[0m17:05:15.706429 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:05:15.711615 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:05:15.711946 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */
drop view if exists "DataWarehouse"."dev_staging"."base_metadata__dbt_backup" cascade
[0m17:05:15.764174 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:05:15.765691 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:05:14.967816 => 2023-04-09 17:05:15.765640
[0m17:05:15.765931 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:05:15.766724 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c60ea9c5-ffa0-4218-9754-400155c4ab2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fdff10>]}
[0m17:05:15.767108 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_staging.base_metadata ..................... [[32mCREATE VIEW[0m in 0.80s]
[0m17:05:15.768474 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:05:15.770717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:05:15.771069 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:15.771264 [debug] [MainThread]: On master: BEGIN
[0m17:05:15.771426 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:05:16.218292 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:05:16.219416 [debug] [MainThread]: On master: COMMIT
[0m17:05:16.219824 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:16.220223 [debug] [MainThread]: On master: COMMIT
[0m17:05:16.270668 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:05:16.272148 [debug] [MainThread]: On master: Close
[0m17:05:16.274188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:16.274560 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:05:16.275021 [info ] [MainThread]: 
[0m17:05:16.275609 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m17:05:16.276619 [debug] [MainThread]: Command end result
[0m17:05:16.291694 [info ] [MainThread]: 
[0m17:05:16.292655 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:16.293308 [info ] [MainThread]: 
[0m17:05:16.294123 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:05:16.295431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6a760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107edcb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107edc790>]}
[0m17:05:16.296400 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:05:37.034014 | 655a086b-0f1f-4cdd-8cb5-7728a2eda88a ==============================
[0m17:05:37.034014 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:05:37.035421 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:05:37.035606 [debug] [MainThread]: Tracking: tracking
[0m17:05:37.059186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a4d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057cb340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab4d90>]}
[0m17:05:37.067280 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:05:37.104904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:05:37.105216 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:05:37.114460 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:05:37.124317 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:05:37.127654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '655a086b-0f1f-4cdd-8cb5-7728a2eda88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f3e0d0>]}
[0m17:05:37.153612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '655a086b-0f1f-4cdd-8cb5-7728a2eda88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f2f190>]}
[0m17:05:37.153900 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:05:37.154115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '655a086b-0f1f-4cdd-8cb5-7728a2eda88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ab7790>]}
[0m17:05:37.154904 [info ] [MainThread]: 
[0m17:05:37.155933 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:05:37.156477 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:05:37.164281 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:05:37.164533 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:05:37.164675 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:37.682568 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m17:05:37.686693 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:05:37.690027 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:05:37.700988 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:05:37.701434 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:05:37.701786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:38.189206 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:05:38.189804 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:05:38.190210 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:05:38.246732 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:05:38.248798 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:05:38.299436 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:05:38.307614 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:38.308030 [debug] [MainThread]: On master: BEGIN
[0m17:05:38.308298 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:05:38.759490 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:05:38.760963 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:38.761666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:05:38.825922 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:05:38.831016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '655a086b-0f1f-4cdd-8cb5-7728a2eda88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7ca30>]}
[0m17:05:38.831944 [debug] [MainThread]: On master: ROLLBACK
[0m17:05:38.882492 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:38.883094 [debug] [MainThread]: On master: BEGIN
[0m17:05:38.980970 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:05:38.981483 [debug] [MainThread]: On master: COMMIT
[0m17:05:38.981834 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:38.982126 [debug] [MainThread]: On master: COMMIT
[0m17:05:39.032625 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:05:39.033228 [debug] [MainThread]: On master: Close
[0m17:05:39.034640 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:05:39.035154 [info ] [MainThread]: 
[0m17:05:39.047856 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:05:39.048444 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m17:05:39.049288 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:05:39.049576 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:05:39.053123 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:05:39.058876 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:05:39.049775 => 2023-04-09 17:05:39.058756
[0m17:05:39.059209 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:05:39.097385 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:05:39.109661 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:05:39.109936 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:05:39.110222 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:05:39.556527 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:05:39.557349 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:05:39.557999 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json->'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m17:05:39.612273 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:05:39.622638 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:05:39.623039 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */
alter table "DataWarehouse"."dev_staging"."base_metadata" rename to "base_metadata__dbt_backup"
[0m17:05:39.675683 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:05:39.680552 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:05:39.680935 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */
alter table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" rename to "base_metadata"
[0m17:05:39.728892 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:05:39.758210 [debug] [Thread-1  ]: On model.warehouse.base_metadata: COMMIT
[0m17:05:39.758573 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:05:39.758770 [debug] [Thread-1  ]: On model.warehouse.base_metadata: COMMIT
[0m17:05:39.808743 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:05:39.816390 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:05:39.816693 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */
drop view if exists "DataWarehouse"."dev_staging"."base_metadata__dbt_backup" cascade
[0m17:05:39.866174 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:05:39.870702 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:05:39.059381 => 2023-04-09 17:05:39.870517
[0m17:05:39.871307 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:05:39.873142 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '655a086b-0f1f-4cdd-8cb5-7728a2eda88a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10611bf10>]}
[0m17:05:39.874065 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_staging.base_metadata ..................... [[32mCREATE VIEW[0m in 0.82s]
[0m17:05:39.876585 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:05:39.879145 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:05:39.879535 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:39.879820 [debug] [MainThread]: On master: BEGIN
[0m17:05:39.880101 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:05:40.333662 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:05:40.335137 [debug] [MainThread]: On master: COMMIT
[0m17:05:40.335824 [debug] [MainThread]: Using postgres connection "master"
[0m17:05:40.336363 [debug] [MainThread]: On master: COMMIT
[0m17:05:40.387471 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:05:40.388365 [debug] [MainThread]: On master: Close
[0m17:05:40.390884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:40.391537 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:05:40.392195 [info ] [MainThread]: 
[0m17:05:40.392921 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.24 seconds (3.24s).
[0m17:05:40.393862 [debug] [MainThread]: Command end result
[0m17:05:40.408088 [info ] [MainThread]: 
[0m17:05:40.408702 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:40.409129 [info ] [MainThread]: 
[0m17:05:40.409526 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:05:40.410037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f5cd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f7ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105efdeb0>]}
[0m17:05:40.410430 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:09:27.324779 | a741260f-6665-47f9-b238-e4e9206ddc69 ==============================
[0m17:09:27.324779 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:09:27.326103 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:09:27.326261 [debug] [MainThread]: Tracking: tracking
[0m17:09:27.348710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c8130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10763f310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107928e50>]}
[0m17:09:27.355943 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:09:27.388106 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:09:27.388396 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:09:27.396585 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:09:27.405413 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:09:27.408367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a741260f-6665-47f9-b238-e4e9206ddc69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107db20d0>]}
[0m17:09:27.422023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a741260f-6665-47f9-b238-e4e9206ddc69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da1190>]}
[0m17:09:27.422287 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:09:27.422470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a741260f-6665-47f9-b238-e4e9206ddc69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792b520>]}
[0m17:09:27.423084 [info ] [MainThread]: 
[0m17:09:27.424055 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:27.424559 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:09:27.430768 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:09:27.430954 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:09:27.431075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:27.942678 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m17:09:27.944755 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:09:27.946405 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:09:27.953050 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:09:27.953332 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:09:27.953507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:09:28.383183 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:09:28.383624 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:09:28.384061 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:09:28.435271 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:09:28.437079 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:09:28.484961 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:09:28.495957 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:28.496787 [debug] [MainThread]: On master: BEGIN
[0m17:09:28.497235 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:28.968881 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:09:28.969545 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:28.969854 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:09:29.032409 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:09:29.035550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a741260f-6665-47f9-b238-e4e9206ddc69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df96a0>]}
[0m17:09:29.036175 [debug] [MainThread]: On master: ROLLBACK
[0m17:09:29.085061 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:29.085615 [debug] [MainThread]: On master: BEGIN
[0m17:09:29.183608 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:09:29.184206 [debug] [MainThread]: On master: COMMIT
[0m17:09:29.184631 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:29.184937 [debug] [MainThread]: On master: COMMIT
[0m17:09:29.235715 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:09:29.236347 [debug] [MainThread]: On master: Close
[0m17:09:29.237637 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:09:29.238615 [info ] [MainThread]: 
[0m17:09:29.253125 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:09:29.253994 [info ] [Thread-1  ]: 1 of 1 START sql view model dev_staging.base_metadata .......................... [RUN]
[0m17:09:29.256026 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:09:29.257214 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:09:29.263296 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:09:29.265475 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:09:29.257796 => 2023-04-09 17:09:29.265332
[0m17:09:29.265840 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:09:29.303057 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:09:29.304191 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:09:29.304334 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:09:29.304449 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:09:29.740921 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:09:29.741770 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:09:29.742089 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  create view "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        replace(teams,'''','')::json->'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
[0m17:09:29.799662 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0 seconds
[0m17:09:29.813414 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:09:29.814159 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */
alter table "DataWarehouse"."dev_staging"."base_metadata" rename to "base_metadata__dbt_backup"
[0m17:09:29.860687 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:09:29.869119 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:09:29.869835 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */
alter table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" rename to "base_metadata"
[0m17:09:29.919229 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m17:09:29.954247 [debug] [Thread-1  ]: On model.warehouse.base_metadata: COMMIT
[0m17:09:29.954532 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:09:29.954707 [debug] [Thread-1  ]: On model.warehouse.base_metadata: COMMIT
[0m17:09:30.000441 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m17:09:30.011612 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:09:30.012031 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */
drop view if exists "DataWarehouse"."dev_staging"."base_metadata__dbt_backup" cascade
[0m17:09:30.065498 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m17:09:30.071092 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:09:29.266005 => 2023-04-09 17:09:30.070881
[0m17:09:30.071868 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:09:30.074627 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a741260f-6665-47f9-b238-e4e9206ddc69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6cf70>]}
[0m17:09:30.076222 [info ] [Thread-1  ]: 1 of 1 OK created sql view model dev_staging.base_metadata ..................... [[32mCREATE VIEW[0m in 0.82s]
[0m17:09:30.081151 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:09:30.086373 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:09:30.087217 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:30.087695 [debug] [MainThread]: On master: BEGIN
[0m17:09:30.088173 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:30.561700 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:09:30.563103 [debug] [MainThread]: On master: COMMIT
[0m17:09:30.563788 [debug] [MainThread]: Using postgres connection "master"
[0m17:09:30.564575 [debug] [MainThread]: On master: COMMIT
[0m17:09:30.616325 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:09:30.617097 [debug] [MainThread]: On master: Close
[0m17:09:30.618763 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:30.619251 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:09:30.619704 [info ] [MainThread]: 
[0m17:09:30.620700 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m17:09:30.621715 [debug] [MainThread]: Command end result
[0m17:09:30.637206 [info ] [MainThread]: 
[0m17:09:30.638130 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:09:30.638936 [info ] [MainThread]: 
[0m17:09:30.639819 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:09:30.640474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10792b520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd16d0>]}
[0m17:09:30.640862 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:10:16.166761 | ad1e2506-8cfa-4a83-b255-07c87b437464 ==============================
[0m17:10:16.166761 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:10:16.168093 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:10:16.168254 [debug] [MainThread]: Tracking: tracking
[0m17:10:16.193008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c6c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077090a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107709a90>]}
[0m17:10:16.200824 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:10:16.208654 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:10:16.208916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ad1e2506-8cfa-4a83-b255-07c87b437464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454d970>]}
[0m17:10:16.527404 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:10:16.556510 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:10:16.559274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad1e2506-8cfa-4a83-b255-07c87b437464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e77100>]}
[0m17:10:16.574581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad1e2506-8cfa-4a83-b255-07c87b437464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7ed00>]}
[0m17:10:16.574810 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:10:16.574978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad1e2506-8cfa-4a83-b255-07c87b437464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c6be0>]}
[0m17:10:16.575585 [info ] [MainThread]: 
[0m17:10:16.576509 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:16.577052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:10:16.583620 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:10:16.583832 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:10:16.583968 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:17.078040 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m17:10:17.079705 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:10:17.081315 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:10:17.087379 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:10:17.087616 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:10:17.087800 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:17.540826 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:10:17.541415 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:10:17.541805 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:10:17.597682 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:10:17.600130 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:10:17.650407 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:10:17.659781 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:17.660123 [debug] [MainThread]: On master: BEGIN
[0m17:10:17.660378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:18.119953 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:10:18.121311 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:18.121998 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:10:18.182462 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:10:18.187039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad1e2506-8cfa-4a83-b255-07c87b437464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e57d00>]}
[0m17:10:18.188005 [debug] [MainThread]: On master: ROLLBACK
[0m17:10:18.233938 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:18.234633 [debug] [MainThread]: On master: BEGIN
[0m17:10:18.331004 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:10:18.332272 [debug] [MainThread]: On master: COMMIT
[0m17:10:18.332929 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:18.333500 [debug] [MainThread]: On master: COMMIT
[0m17:10:18.382063 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:10:18.383502 [debug] [MainThread]: On master: Close
[0m17:10:18.386136 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:10:18.387116 [info ] [MainThread]: 
[0m17:10:18.400573 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:10:18.401217 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:10:18.402214 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:10:18.402566 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:10:18.406650 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:10:18.411116 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:10:18.402799 => 2023-04-09 17:10:18.410976
[0m17:10:18.411528 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:10:18.450696 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:10:18.460270 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:10:18.460436 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:10:18.460575 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:10:18.909766 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:10:18.911474 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:10:18.912184 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        replace(teams,'''','')::json->'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:10:18.969523 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "red" is invalid.
CONTEXT:  JSON data, line 1: {red...

[0m17:10:18.969843 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:10:19.015020 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:10:18.411759 => 2023-04-09 17:10:19.014931
[0m17:10:19.015295 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:10:19.036844 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "red" is invalid.
  CONTEXT:  JSON data, line 1: {red...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:10:19.037159 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad1e2506-8cfa-4a83-b255-07c87b437464', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f42cd0>]}
[0m17:10:19.037443 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.64s]
[0m17:10:19.038398 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:10:19.039452 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:19.039629 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:19.039752 [debug] [MainThread]: On master: BEGIN
[0m17:10:19.039871 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:19.496455 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:10:19.497492 [debug] [MainThread]: On master: COMMIT
[0m17:10:19.497969 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:19.498382 [debug] [MainThread]: On master: COMMIT
[0m17:10:19.548242 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:10:19.549391 [debug] [MainThread]: On master: Close
[0m17:10:19.551264 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:19.551721 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:10:19.552127 [info ] [MainThread]: 
[0m17:10:19.552645 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.98 seconds (2.98s).
[0m17:10:19.553162 [debug] [MainThread]: Command end result
[0m17:10:19.565114 [info ] [MainThread]: 
[0m17:10:19.565693 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:10:19.566029 [info ] [MainThread]: 
[0m17:10:19.566351 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:10:19.566656 [error] [MainThread]:   invalid input syntax for type json
[0m17:10:19.566943 [error] [MainThread]:   DETAIL:  Token "red" is invalid.
[0m17:10:19.567235 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {red...
[0m17:10:19.567511 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:10:19.567800 [info ] [MainThread]: 
[0m17:10:19.568301 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:10:19.568728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a22280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e57c40>]}
[0m17:10:19.569062 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:10:52.174706 | c64a789a-4a71-4215-a097-378b2a7f5a63 ==============================
[0m17:10:52.174706 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:10:52.175860 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:10:52.175980 [debug] [MainThread]: Tracking: tracking
[0m17:10:52.196530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067892b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11850b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187f4d90>]}
[0m17:10:52.204445 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:10:52.211966 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:10:52.212223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c64a789a-4a71-4215-a097-378b2a7f5a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067892b0>]}
[0m17:10:52.544825 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:10:52.577928 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:10:52.580985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c64a789a-4a71-4215-a097-378b2a7f5a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118da70a0>]}
[0m17:10:52.593468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c64a789a-4a71-4215-a097-378b2a7f5a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118535c10>]}
[0m17:10:52.593772 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:10:52.593968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c64a789a-4a71-4215-a097-378b2a7f5a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11850b340>]}
[0m17:10:52.595087 [info ] [MainThread]: 
[0m17:10:52.596142 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:52.596636 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:10:52.603251 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:10:52.603484 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:10:52.603608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:53.134532 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m17:10:53.138452 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:10:53.141698 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:10:53.152078 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:10:53.152561 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:10:53.152881 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:10:53.593797 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:10:53.595242 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:10:53.595912 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:10:53.649788 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:10:53.655041 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:10:53.699797 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:10:53.714147 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:53.714617 [debug] [MainThread]: On master: BEGIN
[0m17:10:53.714936 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:10:54.172470 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:10:54.173084 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:54.173490 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:10:54.236111 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:10:54.238660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c64a789a-4a71-4215-a097-378b2a7f5a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11850b340>]}
[0m17:10:54.239243 [debug] [MainThread]: On master: ROLLBACK
[0m17:10:54.285736 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:54.286540 [debug] [MainThread]: On master: BEGIN
[0m17:10:54.381703 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:10:54.383104 [debug] [MainThread]: On master: COMMIT
[0m17:10:54.383814 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:54.384480 [debug] [MainThread]: On master: COMMIT
[0m17:10:54.431499 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:10:54.432731 [debug] [MainThread]: On master: Close
[0m17:10:54.434721 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:10:54.435373 [info ] [MainThread]: 
[0m17:10:54.447630 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:10:54.448356 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:10:54.449366 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:10:54.449731 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:10:54.453466 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:10:54.454802 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:10:54.449979 => 2023-04-09 17:10:54.454691
[0m17:10:54.455172 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:10:54.495226 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:10:54.496211 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:10:54.496358 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:10:54.496487 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:10:54.938570 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:10:54.939885 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:10:54.940494 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json->'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:10:54.996247 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m17:10:54.996812 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:10:55.044725 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:10:54.455386 => 2023-04-09 17:10:55.044375
[0m17:10:55.045693 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:10:55.083941 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:10:55.084531 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c64a789a-4a71-4215-a097-378b2a7f5a63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118dd2d30>]}
[0m17:10:55.085047 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.64s]
[0m17:10:55.086778 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:10:55.088654 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:10:55.088958 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:55.089165 [debug] [MainThread]: On master: BEGIN
[0m17:10:55.089365 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:10:55.534467 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:10:55.535902 [debug] [MainThread]: On master: COMMIT
[0m17:10:55.536609 [debug] [MainThread]: Using postgres connection "master"
[0m17:10:55.537335 [debug] [MainThread]: On master: COMMIT
[0m17:10:55.585490 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:10:55.586928 [debug] [MainThread]: On master: Close
[0m17:10:55.589362 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:55.589850 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:10:55.590366 [info ] [MainThread]: 
[0m17:10:55.591015 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m17:10:55.591719 [debug] [MainThread]: Command end result
[0m17:10:55.602621 [info ] [MainThread]: 
[0m17:10:55.603227 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:10:55.603634 [info ] [MainThread]: 
[0m17:10:55.604029 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:10:55.604403 [error] [MainThread]:   invalid input syntax for type json
[0m17:10:55.604768 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m17:10:55.605121 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m17:10:55.605467 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:10:55.605831 [info ] [MainThread]: 
[0m17:10:55.606207 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:10:55.606690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11850b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e507c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f42fd0>]}
[0m17:10:55.607070 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:11:18.975421 | 217da81b-72ba-46db-ae4f-e9d069ced226 ==============================
[0m17:11:18.975421 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:11:18.976566 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:11:18.976682 [debug] [MainThread]: Tracking: tracking
[0m17:11:18.991260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a232b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10369b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103984d90>]}
[0m17:11:18.999320 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:11:19.030558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:11:19.030852 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:11:19.038095 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:11:19.046343 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:11:19.049111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '217da81b-72ba-46db-ae4f-e9d069ced226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e0f0d0>]}
[0m17:11:19.062483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '217da81b-72ba-46db-ae4f-e9d069ced226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dff190>]}
[0m17:11:19.062743 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:11:19.062924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '217da81b-72ba-46db-ae4f-e9d069ced226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103987790>]}
[0m17:11:19.063609 [info ] [MainThread]: 
[0m17:11:19.064541 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:11:19.065085 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:11:19.071422 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:11:19.071698 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:11:19.071834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:19.575257 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m17:11:19.577602 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:11:19.579897 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:11:19.587751 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:11:19.588109 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:11:19.588362 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:20.040702 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:11:20.040996 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:11:20.041155 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:11:20.094192 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:11:20.095397 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:11:20.142815 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:11:20.147035 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:20.147277 [debug] [MainThread]: On master: BEGIN
[0m17:11:20.147418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:20.594982 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:11:20.595479 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:20.595795 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:11:20.657800 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:11:20.660052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '217da81b-72ba-46db-ae4f-e9d069ced226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e2e700>]}
[0m17:11:20.660586 [debug] [MainThread]: On master: ROLLBACK
[0m17:11:20.707594 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:20.708094 [debug] [MainThread]: On master: BEGIN
[0m17:11:20.803318 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:11:20.803802 [debug] [MainThread]: On master: COMMIT
[0m17:11:20.804140 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:20.804431 [debug] [MainThread]: On master: COMMIT
[0m17:11:20.852802 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:11:20.853440 [debug] [MainThread]: On master: Close
[0m17:11:20.855313 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:11:20.856043 [info ] [MainThread]: 
[0m17:11:20.864686 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:11:20.865363 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:11:20.866405 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:11:20.866767 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:11:20.870541 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:11:20.874984 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:11:20.867008 => 2023-04-09 17:11:20.874852
[0m17:11:20.875383 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:11:20.916150 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:11:20.924506 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:11:20.924674 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:11:20.924811 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:11:21.359981 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:11:21.360450 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:11:21.360720 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json->> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:11:21.420061 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m17:11:21.421037 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:11:21.466514 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:11:20.875708 => 2023-04-09 17:11:21.466255
[0m17:11:21.467378 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:11:21.505959 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:11:21.506573 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '217da81b-72ba-46db-ae4f-e9d069ced226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ec7f10>]}
[0m17:11:21.507085 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.64s]
[0m17:11:21.508891 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:11:21.511029 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:11:21.511377 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:21.511629 [debug] [MainThread]: On master: BEGIN
[0m17:11:21.511862 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:21.966412 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:11:21.967466 [debug] [MainThread]: On master: COMMIT
[0m17:11:21.968097 [debug] [MainThread]: Using postgres connection "master"
[0m17:11:21.968702 [debug] [MainThread]: On master: COMMIT
[0m17:11:22.016551 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:11:22.017558 [debug] [MainThread]: On master: Close
[0m17:11:22.020228 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:22.020865 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:11:22.021479 [info ] [MainThread]: 
[0m17:11:22.022169 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m17:11:22.023069 [debug] [MainThread]: Command end result
[0m17:11:22.036787 [info ] [MainThread]: 
[0m17:11:22.037581 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:11:22.037991 [info ] [MainThread]: 
[0m17:11:22.038332 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:11:22.038640 [error] [MainThread]:   invalid input syntax for type json
[0m17:11:22.038938 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m17:11:22.039224 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m17:11:22.039512 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:11:22.039815 [info ] [MainThread]: 
[0m17:11:22.040136 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:11:22.040564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ef6e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e6b8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e6bb50>]}
[0m17:11:22.040902 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:12:19.350042 | 3b3a9e70-d79a-41a1-9bb5-404ade8ceffc ==============================
[0m17:12:19.350042 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:12:19.351565 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:12:19.351728 [debug] [MainThread]: Tracking: tracking
[0m17:12:19.370099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a86130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ff940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079e8e50>]}
[0m17:12:19.378373 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:12:19.421889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:12:19.422238 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:12:19.432476 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:12:19.445626 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:12:19.449006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b3a9e70-d79a-41a1-9bb5-404ade8ceffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e730d0>]}
[0m17:12:19.462939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b3a9e70-d79a-41a1-9bb5-404ade8ceffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e64190>]}
[0m17:12:19.463208 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:12:19.463438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b3a9e70-d79a-41a1-9bb5-404ade8ceffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ec520>]}
[0m17:12:19.464193 [info ] [MainThread]: 
[0m17:12:19.465208 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:19.465820 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:12:19.472936 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:12:19.473181 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:12:19.473329 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:20.050781 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m17:12:20.054492 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:12:20.057288 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:12:20.063171 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:12:20.063454 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:12:20.063621 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:20.505244 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:12:20.505513 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:12:20.505658 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:12:20.558113 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:12:20.560882 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:12:20.606614 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:12:20.613559 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:20.613910 [debug] [MainThread]: On master: BEGIN
[0m17:12:20.614111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:21.068682 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:12:21.069209 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:21.069663 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:12:21.131450 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:12:21.133930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b3a9e70-d79a-41a1-9bb5-404ade8ceffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ebb6a0>]}
[0m17:12:21.134527 [debug] [MainThread]: On master: ROLLBACK
[0m17:12:21.184429 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:21.185025 [debug] [MainThread]: On master: BEGIN
[0m17:12:21.283294 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:12:21.283859 [debug] [MainThread]: On master: COMMIT
[0m17:12:21.284209 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:21.284540 [debug] [MainThread]: On master: COMMIT
[0m17:12:21.335106 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:12:21.335702 [debug] [MainThread]: On master: Close
[0m17:12:21.336902 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:12:21.337381 [info ] [MainThread]: 
[0m17:12:21.349291 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:12:21.350263 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:12:21.351836 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:12:21.352541 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:12:21.358041 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:12:21.360524 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:12:21.352965 => 2023-04-09 17:12:21.360328
[0m17:12:21.361071 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:12:21.410573 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:12:21.412178 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:12:21.412348 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:12:21.412496 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:12:21.869065 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:12:21.869529 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:12:21.869796 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json -> red as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:12:21.920241 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "red" does not exist
LINE 27:         teams::json -> red as red,
                                ^

[0m17:12:21.921077 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:12:21.970564 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:12:21.361312 => 2023-04-09 17:12:21.970415
[0m17:12:21.971025 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:12:22.002361 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  column "red" does not exist
  LINE 27:         teams::json -> red as red,
                                  ^
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:12:22.002634 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b3a9e70-d79a-41a1-9bb5-404ade8ceffc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f2df70>]}
[0m17:12:22.002860 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.65s]
[0m17:12:22.003697 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:12:22.004808 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:22.004987 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:22.005097 [debug] [MainThread]: On master: BEGIN
[0m17:12:22.005202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:22.472489 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:12:22.473187 [debug] [MainThread]: On master: COMMIT
[0m17:12:22.473597 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:22.473980 [debug] [MainThread]: On master: COMMIT
[0m17:12:22.527690 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:12:22.528533 [debug] [MainThread]: On master: Close
[0m17:12:22.530125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:22.530498 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:12:22.530827 [info ] [MainThread]: 
[0m17:12:22.531289 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m17:12:22.531883 [debug] [MainThread]: Command end result
[0m17:12:22.544318 [info ] [MainThread]: 
[0m17:12:22.545248 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:12:22.546037 [info ] [MainThread]: 
[0m17:12:22.546894 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:12:22.547532 [error] [MainThread]:   column "red" does not exist
[0m17:12:22.548150 [error] [MainThread]:   LINE 27:         teams::json -> red as red,
[0m17:12:22.548748 [error] [MainThread]:                                   ^
[0m17:12:22.549272 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:12:22.549827 [info ] [MainThread]: 
[0m17:12:22.550539 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:12:22.551598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f5bee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f12940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f12bb0>]}
[0m17:12:22.552221 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:12:32.755172 | 7df90319-fb01-4d16-9b52-4de47789973e ==============================
[0m17:12:32.755172 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:12:32.756446 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:12:32.756578 [debug] [MainThread]: Tracking: tracking
[0m17:12:32.775389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106927130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066758b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066753a0>]}
[0m17:12:32.783246 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:12:32.816536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:12:32.816842 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:12:32.824261 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:12:32.833909 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:12:32.836777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7df90319-fb01-4d16-9b52-4de47789973e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc00d0>]}
[0m17:12:32.863025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7df90319-fb01-4d16-9b52-4de47789973e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dac190>]}
[0m17:12:32.863292 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:12:32.863473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7df90319-fb01-4d16-9b52-4de47789973e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667d700>]}
[0m17:12:32.864132 [info ] [MainThread]: 
[0m17:12:32.865061 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:32.865591 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:12:32.872226 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:12:32.872440 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:12:32.872572 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:33.328471 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m17:12:33.329722 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:12:33.330861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:12:33.335347 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:12:33.335596 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:12:33.335767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:33.800608 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:12:33.801632 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:12:33.802126 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:12:33.859562 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:12:33.862902 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:12:33.912269 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:12:33.921922 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:33.922404 [debug] [MainThread]: On master: BEGIN
[0m17:12:33.922709 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:34.378755 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:12:34.379699 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:34.380173 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:12:34.443175 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:12:34.447378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7df90319-fb01-4d16-9b52-4de47789973e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ddea30>]}
[0m17:12:34.448312 [debug] [MainThread]: On master: ROLLBACK
[0m17:12:34.496627 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:34.497698 [debug] [MainThread]: On master: BEGIN
[0m17:12:34.594904 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:12:34.596029 [debug] [MainThread]: On master: COMMIT
[0m17:12:34.596558 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:34.597041 [debug] [MainThread]: On master: COMMIT
[0m17:12:34.653893 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:12:34.655097 [debug] [MainThread]: On master: Close
[0m17:12:34.657351 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:12:34.658112 [info ] [MainThread]: 
[0m17:12:34.670654 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:12:34.671299 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:12:34.672318 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:12:34.672667 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:12:34.676803 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:12:34.680838 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:12:34.672922 => 2023-04-09 17:12:34.680736
[0m17:12:34.681182 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:12:34.722135 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:12:34.730025 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:12:34.730168 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:12:34.730291 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:12:35.189159 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:12:35.189996 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:12:35.190559 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json -> "red" as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:12:35.241720 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "red" does not exist
LINE 27:         teams::json -> "red" as red,
                                ^

[0m17:12:35.242632 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:12:35.292225 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:12:34.681375 => 2023-04-09 17:12:35.291986
[0m17:12:35.293015 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:12:35.328414 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  column "red" does not exist
  LINE 27:         teams::json -> "red" as red,
                                  ^
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:12:35.328951 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7df90319-fb01-4d16-9b52-4de47789973e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e77f40>]}
[0m17:12:35.329457 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.66s]
[0m17:12:35.331248 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:12:35.333129 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:35.333403 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:35.333603 [debug] [MainThread]: On master: BEGIN
[0m17:12:35.333792 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:35.800219 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:12:35.801319 [debug] [MainThread]: On master: COMMIT
[0m17:12:35.801809 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:35.802303 [debug] [MainThread]: On master: COMMIT
[0m17:12:35.851009 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:12:35.852444 [debug] [MainThread]: On master: Close
[0m17:12:35.854884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:35.855338 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:12:35.855841 [info ] [MainThread]: 
[0m17:12:35.856584 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m17:12:35.857305 [debug] [MainThread]: Command end result
[0m17:12:35.870974 [info ] [MainThread]: 
[0m17:12:35.871593 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:12:35.871991 [info ] [MainThread]: 
[0m17:12:35.872381 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:12:35.872751 [error] [MainThread]:   column "red" does not exist
[0m17:12:35.873105 [error] [MainThread]:   LINE 27:         teams::json -> "red" as red,
[0m17:12:35.873446 [error] [MainThread]:                                   ^
[0m17:12:35.873781 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:12:35.874128 [info ] [MainThread]: 
[0m17:12:35.874446 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:12:35.874826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ea6eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5cb80>]}
[0m17:12:35.875134 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:12:51.245491 | 824c3543-25a9-439a-83a6-f64559026709 ==============================
[0m17:12:51.245491 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:12:51.246823 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:12:51.246981 [debug] [MainThread]: Tracking: tracking
[0m17:12:51.267053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040b4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df53a0>]}
[0m17:12:51.275797 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:12:51.317368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:12:51.317678 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:12:51.327370 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:12:51.338397 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:12:51.341884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '824c3543-25a9-439a-83a6-f64559026709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10453f0d0>]}
[0m17:12:51.354236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '824c3543-25a9-439a-83a6-f64559026709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10452f220>]}
[0m17:12:51.354510 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:12:51.354698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '824c3543-25a9-439a-83a6-f64559026709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044b29d0>]}
[0m17:12:51.355597 [info ] [MainThread]: 
[0m17:12:51.357073 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:51.357947 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:12:51.365536 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:12:51.365766 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:12:51.365908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:51.864863 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m17:12:51.869242 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:12:51.872541 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:12:51.882871 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:12:51.883339 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:12:51.883673 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:52.359525 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:12:52.360587 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:12:52.361082 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:12:52.418249 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:12:52.423000 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:12:52.474155 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:12:52.486266 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:52.486678 [debug] [MainThread]: On master: BEGIN
[0m17:12:52.486992 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:52.940200 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:12:52.941269 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:52.941782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:12:53.006817 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:12:53.009123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '824c3543-25a9-439a-83a6-f64559026709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10457da00>]}
[0m17:12:53.009701 [debug] [MainThread]: On master: ROLLBACK
[0m17:12:53.058510 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:53.059394 [debug] [MainThread]: On master: BEGIN
[0m17:12:53.157183 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:12:53.158121 [debug] [MainThread]: On master: COMMIT
[0m17:12:53.158662 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:53.159148 [debug] [MainThread]: On master: COMMIT
[0m17:12:53.208975 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:12:53.209629 [debug] [MainThread]: On master: Close
[0m17:12:53.211103 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:12:53.211898 [info ] [MainThread]: 
[0m17:12:53.223126 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:12:53.223601 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:12:53.224239 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:12:53.224436 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:12:53.226945 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:12:53.227972 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:12:53.224568 => 2023-04-09 17:12:53.227886
[0m17:12:53.228210 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:12:53.267482 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:12:53.268633 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:12:53.268829 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:12:53.268978 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:12:53.706529 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:12:53.707701 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:12:53.708228 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:12:53.764171 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m17:12:53.765197 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:12:53.812743 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:12:53.228335 => 2023-04-09 17:12:53.812453
[0m17:12:53.813687 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:12:53.852604 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:12:53.853226 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '824c3543-25a9-439a-83a6-f64559026709', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045f8f40>]}
[0m17:12:53.853745 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.63s]
[0m17:12:53.855500 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:12:53.857281 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:53.857600 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:53.857814 [debug] [MainThread]: On master: BEGIN
[0m17:12:53.858019 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:54.315492 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:12:54.316177 [debug] [MainThread]: On master: COMMIT
[0m17:12:54.316555 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:54.316950 [debug] [MainThread]: On master: COMMIT
[0m17:12:54.367499 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:12:54.368289 [debug] [MainThread]: On master: Close
[0m17:12:54.370575 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:54.371055 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:12:54.371625 [info ] [MainThread]: 
[0m17:12:54.372580 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m17:12:54.373552 [debug] [MainThread]: Command end result
[0m17:12:54.384528 [info ] [MainThread]: 
[0m17:12:54.385196 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:12:54.385624 [info ] [MainThread]: 
[0m17:12:54.386025 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:12:54.386405 [error] [MainThread]:   invalid input syntax for type json
[0m17:12:54.386765 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m17:12:54.387106 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m17:12:54.387443 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:12:54.387797 [info ] [MainThread]: 
[0m17:12:54.388162 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:12:54.388625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10461dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045dda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045dde50>]}
[0m17:12:54.389019 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:15:32.339633 | 6faee10a-d591-47a7-852d-258eb0690c2a ==============================
[0m17:15:32.339633 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:15:32.341117 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:15:32.341244 [debug] [MainThread]: Tracking: tracking
[0m17:15:32.360058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10770c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10744d3a0>]}
[0m17:15:32.367277 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:15:32.403412 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:15:32.403743 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:15:32.413578 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:15:32.424449 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:15:32.427863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6faee10a-d591-47a7-852d-258eb0690c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b980d0>]}
[0m17:15:32.442036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6faee10a-d591-47a7-852d-258eb0690c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b88220>]}
[0m17:15:32.442336 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:15:32.442531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6faee10a-d591-47a7-852d-258eb0690c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b0d880>]}
[0m17:15:32.443259 [info ] [MainThread]: 
[0m17:15:32.444231 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:15:32.444741 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:15:32.451307 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:15:32.451518 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:15:32.451638 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:32.977554 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m17:15:32.981314 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:15:32.984912 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:15:32.995939 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:15:32.996416 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:15:32.996740 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:33.460549 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:15:33.461103 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:15:33.461404 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:15:33.517018 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:15:33.519282 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:15:33.571238 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:15:33.581415 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:33.581692 [debug] [MainThread]: On master: BEGIN
[0m17:15:33.581836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:34.036170 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:15:34.036839 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:34.037385 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:15:34.101115 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:15:34.105766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6faee10a-d591-47a7-852d-258eb0690c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb6a00>]}
[0m17:15:34.106710 [debug] [MainThread]: On master: ROLLBACK
[0m17:15:34.154281 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:34.155645 [debug] [MainThread]: On master: BEGIN
[0m17:15:34.252839 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:15:34.254300 [debug] [MainThread]: On master: COMMIT
[0m17:15:34.255020 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:34.255691 [debug] [MainThread]: On master: COMMIT
[0m17:15:34.303077 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:15:34.303800 [debug] [MainThread]: On master: Close
[0m17:15:34.305128 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:15:34.305632 [info ] [MainThread]: 
[0m17:15:34.318164 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:15:34.318816 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:15:34.319827 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:15:34.320188 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:15:34.324403 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:15:34.329063 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:15:34.320442 => 2023-04-09 17:15:34.328935
[0m17:15:34.329482 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:15:34.369699 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:15:34.378232 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:15:34.378422 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:15:34.378577 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:15:34.847608 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:15:34.848875 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:15:34.849426 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:15:34.917205 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "True" is invalid.
CONTEXT:  JSON data, line 1: {"red": {"has_won": True...

[0m17:15:34.918351 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:15:34.969395 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:15:34.329686 => 2023-04-09 17:15:34.968958
[0m17:15:34.970707 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:15:35.010074 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "True" is invalid.
  CONTEXT:  JSON data, line 1: {"red": {"has_won": True...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:15:35.010577 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6faee10a-d591-47a7-852d-258eb0690c2a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c51f40>]}
[0m17:15:35.011021 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.69s]
[0m17:15:35.012569 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:15:35.014434 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:15:35.014757 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:35.014978 [debug] [MainThread]: On master: BEGIN
[0m17:15:35.015181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:35.459080 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:15:35.460364 [debug] [MainThread]: On master: COMMIT
[0m17:15:35.460905 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:35.461385 [debug] [MainThread]: On master: COMMIT
[0m17:15:35.509720 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:15:35.510918 [debug] [MainThread]: On master: Close
[0m17:15:35.513146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:35.513619 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:15:35.514155 [info ] [MainThread]: 
[0m17:15:35.514767 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.07 seconds (3.07s).
[0m17:15:35.515897 [debug] [MainThread]: Command end result
[0m17:15:35.529540 [info ] [MainThread]: 
[0m17:15:35.530154 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:15:35.530562 [info ] [MainThread]: 
[0m17:15:35.530957 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:15:35.531330 [error] [MainThread]:   invalid input syntax for type json
[0m17:15:35.531680 [error] [MainThread]:   DETAIL:  Token "True" is invalid.
[0m17:15:35.532019 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {"red": {"has_won": True...
[0m17:15:35.532362 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:15:35.532708 [info ] [MainThread]: 
[0m17:15:35.533065 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:15:35.533535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c77fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c36a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c36e80>]}
[0m17:15:35.533891 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:16:31.825418 | 3637616c-0c93-4a4b-8745-ef3b2808cf3f ==============================
[0m17:16:31.825418 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:16:31.826748 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:16:31.826911 [debug] [MainThread]: Tracking: tracking
[0m17:16:31.845677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108106c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081490a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108149a90>]}
[0m17:16:31.852946 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:16:31.890665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:16:31.890971 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:16:31.899421 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:16:31.907904 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:16:31.910823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3637616c-0c93-4a4b-8745-ef3b2808cf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088959a0>]}
[0m17:16:31.924375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3637616c-0c93-4a4b-8745-ef3b2808cf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108884220>]}
[0m17:16:31.924614 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:16:31.924784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3637616c-0c93-4a4b-8745-ef3b2808cf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108805790>]}
[0m17:16:31.925431 [info ] [MainThread]: 
[0m17:16:31.926437 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:16:31.927015 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:16:31.933543 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:16:31.933746 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:16:31.933872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:16:32.455313 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m17:16:32.459358 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:16:32.462803 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:16:32.472950 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:16:32.473336 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:16:32.473646 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:16:32.925394 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:16:32.927190 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:16:32.927718 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:16:32.980239 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:16:32.983562 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:16:33.030357 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:16:33.043996 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:33.044402 [debug] [MainThread]: On master: BEGIN
[0m17:16:33.044723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:16:33.499830 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:16:33.501003 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:33.501570 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:16:33.561899 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:16:33.564450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3637616c-0c93-4a4b-8745-ef3b2808cf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088b1a30>]}
[0m17:16:33.565237 [debug] [MainThread]: On master: ROLLBACK
[0m17:16:33.611730 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:33.612535 [debug] [MainThread]: On master: BEGIN
[0m17:16:33.707549 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:16:33.708847 [debug] [MainThread]: On master: COMMIT
[0m17:16:33.709552 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:33.710319 [debug] [MainThread]: On master: COMMIT
[0m17:16:33.760303 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:16:33.761590 [debug] [MainThread]: On master: Close
[0m17:16:33.764015 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:16:33.764773 [info ] [MainThread]: 
[0m17:16:33.775434 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:16:33.776071 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:16:33.777096 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:16:33.777453 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:16:33.781418 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:16:33.783048 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:16:33.777714 => 2023-04-09 17:16:33.782967
[0m17:16:33.783347 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:16:33.824671 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:16:33.825999 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:16:33.826141 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:16:33.826266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:16:34.298909 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:16:34.300033 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:16:34.300481 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        replace(replace(teams::text, '''', '"'), 'True', 'true')::json->'red' as red,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:16:34.359084 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "False" is invalid.
CONTEXT:  JSON data, line 1: ...: 5, "rounds_lost": 1}, "blue": {"has_won": False...

[0m17:16:34.360235 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:16:34.412562 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:16:33.783530 => 2023-04-09 17:16:34.412310
[0m17:16:34.413318 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:16:34.452596 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "False" is invalid.
  CONTEXT:  JSON data, line 1: ...: 5, "rounds_lost": 1}, "blue": {"has_won": False...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:16:34.453142 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3637616c-0c93-4a4b-8745-ef3b2808cf3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10894de50>]}
[0m17:16:34.453659 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.68s]
[0m17:16:34.455403 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:16:34.457191 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:16:34.457503 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:34.457727 [debug] [MainThread]: On master: BEGIN
[0m17:16:34.457926 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:16:34.894021 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:16:34.895243 [debug] [MainThread]: On master: COMMIT
[0m17:16:34.895743 [debug] [MainThread]: Using postgres connection "master"
[0m17:16:34.896208 [debug] [MainThread]: On master: COMMIT
[0m17:16:34.943957 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:16:34.944668 [debug] [MainThread]: On master: Close
[0m17:16:34.946151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:16:34.946530 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:16:34.946895 [info ] [MainThread]: 
[0m17:16:34.947368 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m17:16:34.948192 [debug] [MainThread]: Command end result
[0m17:16:34.958996 [info ] [MainThread]: 
[0m17:16:34.959601 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:16:34.960009 [info ] [MainThread]: 
[0m17:16:34.960405 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:16:34.960779 [error] [MainThread]:   invalid input syntax for type json
[0m17:16:34.961136 [error] [MainThread]:   DETAIL:  Token "False" is invalid.
[0m17:16:34.961482 [error] [MainThread]:   CONTEXT:  JSON data, line 1: ...: 5, "rounds_lost": 1}, "blue": {"has_won": False...
[0m17:16:34.961828 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:16:34.962184 [info ] [MainThread]: 
[0m17:16:34.962555 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:16:34.963016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897cdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108936820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108936af0>]}
[0m17:16:34.963394 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:17:26.084514 | 570aaeda-58bf-4bd8-9e6f-e6267311ebf3 ==============================
[0m17:17:26.084514 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:17:26.085965 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:17:26.086126 [debug] [MainThread]: Tracking: tracking
[0m17:17:26.101727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102ece670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c4b940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f34e50>]}
[0m17:17:26.109040 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:17:26.139856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:26.140136 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:17:26.148050 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:17:26.156507 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:17:26.159353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '570aaeda-58bf-4bd8-9e6f-e6267311ebf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043bf0d0>]}
[0m17:17:26.176096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '570aaeda-58bf-4bd8-9e6f-e6267311ebf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043b1190>]}
[0m17:17:26.176363 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:17:26.176550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '570aaeda-58bf-4bd8-9e6f-e6267311ebf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f37280>]}
[0m17:17:26.177240 [info ] [MainThread]: 
[0m17:17:26.178225 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:17:26.178812 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:17:26.185709 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:17:26.185922 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:17:26.186053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:26.740495 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m17:17:26.744604 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:17:26.747896 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:17:26.758733 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:17:26.759139 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:17:26.759451 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:27.236489 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:17:27.237461 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:17:27.237870 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:17:27.292972 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:17:27.296563 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:17:27.347073 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:17:27.360640 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:27.361094 [debug] [MainThread]: On master: BEGIN
[0m17:17:27.361419 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:27.817022 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:17:27.818008 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:27.818773 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:17:27.880268 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:17:27.884125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '570aaeda-58bf-4bd8-9e6f-e6267311ebf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10452a6a0>]}
[0m17:17:27.884969 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:27.933269 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:27.934232 [debug] [MainThread]: On master: BEGIN
[0m17:17:28.028079 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:17:28.028383 [debug] [MainThread]: On master: COMMIT
[0m17:17:28.028553 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:28.028692 [debug] [MainThread]: On master: COMMIT
[0m17:17:28.075345 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:17:28.075878 [debug] [MainThread]: On master: Close
[0m17:17:28.077024 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:17:28.077494 [info ] [MainThread]: 
[0m17:17:28.082516 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:17:28.082803 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:17:28.083383 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:17:28.083539 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:17:28.085244 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:17:28.089419 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:17:28.083642 => 2023-04-09 17:17:28.089319
[0m17:17:28.089682 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:17:28.117384 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:17:28.124572 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:17:28.124757 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:17:28.124871 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:17:28.578470 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:17:28.578814 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:17:28.578995 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json->red->>has_won as red_has_won,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:17:28.626512 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "red" does not exist
LINE 27:         teams::json->red->>has_won as red_has_won,
                              ^

[0m17:17:28.627143 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:17:28.673792 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:17:28.089778 => 2023-04-09 17:17:28.673713
[0m17:17:28.674051 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:17:28.692628 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  column "red" does not exist
  LINE 27:         teams::json->red->>has_won as red_has_won,
                                ^
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:17:28.692910 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '570aaeda-58bf-4bd8-9e6f-e6267311ebf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10459df70>]}
[0m17:17:28.693150 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.61s]
[0m17:17:28.693995 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:17:28.695944 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:17:28.696167 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:28.696283 [debug] [MainThread]: On master: BEGIN
[0m17:17:28.696388 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:29.145636 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:17:29.146904 [debug] [MainThread]: On master: COMMIT
[0m17:17:29.147307 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:29.147730 [debug] [MainThread]: On master: COMMIT
[0m17:17:29.195125 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:17:29.196079 [debug] [MainThread]: On master: Close
[0m17:17:29.197889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:29.198268 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:17:29.198722 [info ] [MainThread]: 
[0m17:17:29.199324 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.02 seconds (3.02s).
[0m17:17:29.200052 [debug] [MainThread]: Command end result
[0m17:17:29.215016 [info ] [MainThread]: 
[0m17:17:29.215691 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:17:29.216101 [info ] [MainThread]: 
[0m17:17:29.216492 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:17:29.216860 [error] [MainThread]:   column "red" does not exist
[0m17:17:29.217205 [error] [MainThread]:   LINE 27:         teams::json->red->>has_won as red_has_won,
[0m17:17:29.217543 [error] [MainThread]:                                 ^
[0m17:17:29.217879 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:17:29.218228 [info ] [MainThread]: 
[0m17:17:29.218597 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:17:29.219061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045ccee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104582940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104582bb0>]}
[0m17:17:29.219418 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:17:43.356642 | 80f0283d-589b-44f6-8e52-a91190792f8b ==============================
[0m17:17:43.356642 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:17:43.358123 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:17:43.358293 [debug] [MainThread]: Tracking: tracking
[0m17:17:43.375905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dad0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dae580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dae310>]}
[0m17:17:43.384700 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:17:43.435057 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:43.435388 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:17:43.444611 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:17:43.455098 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:17:43.458283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80f0283d-589b-44f6-8e52-a91190792f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108364fa0>]}
[0m17:17:43.470158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80f0283d-589b-44f6-8e52-a91190792f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108353190>]}
[0m17:17:43.470451 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:17:43.470654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80f0283d-589b-44f6-8e52-a91190792f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dad0a0>]}
[0m17:17:43.471486 [info ] [MainThread]: 
[0m17:17:43.472633 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:17:43.473267 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:17:43.479788 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:17:43.480001 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:17:43.480121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:43.945764 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m17:17:43.947136 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:17:43.948431 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:17:43.953780 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:17:43.953991 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:17:43.954159 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:44.404543 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:17:44.405281 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:17:44.405697 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:17:44.459219 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:17:44.463151 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:17:44.511173 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:17:44.524393 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:44.524848 [debug] [MainThread]: On master: BEGIN
[0m17:17:44.525157 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:44.999441 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:17:44.999926 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:45.000223 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:17:45.062126 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:17:45.064163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80f0283d-589b-44f6-8e52-a91190792f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108381a60>]}
[0m17:17:45.064707 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:45.112824 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:45.113464 [debug] [MainThread]: On master: BEGIN
[0m17:17:45.216592 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:17:45.217977 [debug] [MainThread]: On master: COMMIT
[0m17:17:45.218678 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:45.219329 [debug] [MainThread]: On master: COMMIT
[0m17:17:45.269882 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:17:45.271187 [debug] [MainThread]: On master: Close
[0m17:17:45.273555 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:17:45.274338 [info ] [MainThread]: 
[0m17:17:45.285496 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:17:45.286164 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:17:45.287197 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:17:45.287552 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:17:45.291529 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:17:45.293377 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:17:45.287807 => 2023-04-09 17:17:45.293271
[0m17:17:45.293749 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:17:45.337817 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:17:45.338589 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:17:45.338737 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:17:45.338864 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:17:45.775466 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:17:45.776596 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:17:45.777040 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json->'red'->>'has_won' as red_has_won,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:17:45.831044 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m17:17:45.832265 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:17:45.876526 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:17:45.294138 => 2023-04-09 17:17:45.876412
[0m17:17:45.876941 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:17:45.912134 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:17:45.912555 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80f0283d-589b-44f6-8e52-a91190792f8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10851deb0>]}
[0m17:17:45.912952 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.63s]
[0m17:17:45.914303 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:17:45.915790 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:17:45.916068 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:45.916255 [debug] [MainThread]: On master: BEGIN
[0m17:17:45.916429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:46.366128 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:17:46.366902 [debug] [MainThread]: On master: COMMIT
[0m17:17:46.367297 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:46.367671 [debug] [MainThread]: On master: COMMIT
[0m17:17:46.420728 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:17:46.421443 [debug] [MainThread]: On master: Close
[0m17:17:46.422676 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:46.423148 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:17:46.423618 [info ] [MainThread]: 
[0m17:17:46.424305 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m17:17:46.425048 [debug] [MainThread]: Command end result
[0m17:17:46.435385 [info ] [MainThread]: 
[0m17:17:46.436045 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:17:46.436457 [info ] [MainThread]: 
[0m17:17:46.436847 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:17:46.437217 [error] [MainThread]:   invalid input syntax for type json
[0m17:17:46.437571 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m17:17:46.437917 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m17:17:46.438258 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:17:46.438609 [info ] [MainThread]: 
[0m17:17:46.438980 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:17:46.439443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108543ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107abf2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108506880>]}
[0m17:17:46.439823 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:17:54.992227 | 71fb47bf-2fb0-40ae-8bcc-8841efa22052 ==============================
[0m17:17:54.992227 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:17:54.993800 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:17:54.993929 [debug] [MainThread]: Tracking: tracking
[0m17:17:55.032548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108023430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d37f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108020d60>]}
[0m17:17:55.039850 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:17:55.070759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:55.071049 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:17:55.078226 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:17:55.086727 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:17:55.089608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71fb47bf-2fb0-40ae-8bcc-8841efa22052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084abfd0>]}
[0m17:17:55.102687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71fb47bf-2fb0-40ae-8bcc-8841efa22052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10849b190>]}
[0m17:17:55.102966 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:17:55.103158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71fb47bf-2fb0-40ae-8bcc-8841efa22052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d37f70>]}
[0m17:17:55.103855 [info ] [MainThread]: 
[0m17:17:55.104855 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:17:55.105422 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:17:55.111935 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:17:55.112185 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:17:55.112309 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:55.550684 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m17:17:55.555633 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:17:55.558679 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:17:55.568223 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:17:55.568602 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:17:55.568916 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:56.023899 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:17:56.024204 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:17:56.024376 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:17:56.078437 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:17:56.079925 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:17:56.128068 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:17:56.136929 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:56.137302 [debug] [MainThread]: On master: BEGIN
[0m17:17:56.137619 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:56.591544 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:17:56.592585 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:56.593013 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:17:56.654852 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:17:56.658513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71fb47bf-2fb0-40ae-8bcc-8841efa22052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084caa30>]}
[0m17:17:56.659350 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:56.709800 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:56.710492 [debug] [MainThread]: On master: BEGIN
[0m17:17:56.805229 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:17:56.806028 [debug] [MainThread]: On master: COMMIT
[0m17:17:56.806546 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:56.806949 [debug] [MainThread]: On master: COMMIT
[0m17:17:56.856223 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:17:56.857137 [debug] [MainThread]: On master: Close
[0m17:17:56.858828 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:17:56.859363 [info ] [MainThread]: 
[0m17:17:56.869394 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:17:56.870097 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:17:56.871169 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:17:56.871561 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:17:56.875805 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:17:56.880169 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:17:56.871822 => 2023-04-09 17:17:56.880028
[0m17:17:56.880561 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:17:56.921801 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:17:56.929683 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:17:56.929835 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:17:56.929961 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:17:57.389470 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:17:57.390770 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:17:57.391336 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams->'red'->>'has_won' as red_has_won,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:17:57.441905 [debug] [Thread-1  ]: Postgres adapter: Postgres error: operator does not exist: text -> unknown
LINE 27:         teams->'red'->>'has_won' as red_has_won,
                      ^
HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.

[0m17:17:57.442524 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:17:57.491126 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:17:56.880770 => 2023-04-09 17:17:57.491011
[0m17:17:57.491457 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:17:57.516313 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  operator does not exist: text -> unknown
  LINE 27:         teams->'red'->>'has_won' as red_has_won,
                        ^
  HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:17:57.516660 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71fb47bf-2fb0-40ae-8bcc-8841efa22052', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108565ee0>]}
[0m17:17:57.516968 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.65s]
[0m17:17:57.518048 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:17:57.519273 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:17:57.519494 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:57.519647 [debug] [MainThread]: On master: BEGIN
[0m17:17:57.519789 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:57.968776 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:17:57.969441 [debug] [MainThread]: On master: COMMIT
[0m17:17:57.969809 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:57.970170 [debug] [MainThread]: On master: COMMIT
[0m17:17:58.016869 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:17:58.017779 [debug] [MainThread]: On master: Close
[0m17:17:58.019754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:58.020260 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:17:58.020707 [info ] [MainThread]: 
[0m17:17:58.021521 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.92 seconds (2.92s).
[0m17:17:58.022532 [debug] [MainThread]: Command end result
[0m17:17:58.032808 [info ] [MainThread]: 
[0m17:17:58.033094 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:17:58.033246 [info ] [MainThread]: 
[0m17:17:58.033397 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:17:58.033537 [error] [MainThread]:   operator does not exist: text -> unknown
[0m17:17:58.033668 [error] [MainThread]:   LINE 27:         teams->'red'->>'has_won' as red_has_won,
[0m17:17:58.033793 [error] [MainThread]:                         ^
[0m17:17:58.033916 [error] [MainThread]:   HINT:  No operator matches the given name and argument types. You might need to add explicit type casts.
[0m17:17:58.034039 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:17:58.034166 [info ] [MainThread]: 
[0m17:17:58.034298 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:17:58.034502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108594e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085488b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108548b20>]}
[0m17:17:58.034660 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:18:12.256659 | ce35ba57-0080-4142-839f-f14bb4dc987a ==============================
[0m17:18:12.256659 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:18:12.257816 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:18:12.257935 [debug] [MainThread]: Tracking: tracking
[0m17:18:12.271492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10390b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10361f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103908d60>]}
[0m17:18:12.279412 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:18:12.309418 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:18:12.309699 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:18:12.316933 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:18:12.325294 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:18:12.328113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce35ba57-0080-4142-839f-f14bb4dc987a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ea4fd0>]}
[0m17:18:12.338596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce35ba57-0080-4142-839f-f14bb4dc987a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e95190>]}
[0m17:18:12.338843 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:18:12.339028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce35ba57-0080-4142-839f-f14bb4dc987a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10361f760>]}
[0m17:18:12.339670 [info ] [MainThread]: 
[0m17:18:12.340620 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:18:12.341165 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:18:12.347638 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:18:12.347864 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:18:12.347999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:12.821743 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m17:18:12.826130 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:18:12.829811 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:18:12.839531 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:18:12.839940 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:18:12.840253 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:13.294192 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:18:13.295185 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:18:13.295730 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:18:13.346396 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:18:13.351119 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:18:13.399695 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:18:13.412258 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:13.412780 [debug] [MainThread]: On master: BEGIN
[0m17:18:13.413098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:13.863830 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:18:13.864612 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:13.865104 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:18:13.926737 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:18:13.930805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce35ba57-0080-4142-839f-f14bb4dc987a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ec1a30>]}
[0m17:18:13.931708 [debug] [MainThread]: On master: ROLLBACK
[0m17:18:13.980034 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:13.981184 [debug] [MainThread]: On master: BEGIN
[0m17:18:14.079122 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:18:14.079924 [debug] [MainThread]: On master: COMMIT
[0m17:18:14.080316 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:14.080679 [debug] [MainThread]: On master: COMMIT
[0m17:18:14.128777 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:18:14.129821 [debug] [MainThread]: On master: Close
[0m17:18:14.131952 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:18:14.132731 [info ] [MainThread]: 
[0m17:18:14.144059 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:18:14.144699 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:18:14.145690 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:18:14.146053 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:18:14.150232 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:18:14.151813 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:18:14.146298 => 2023-04-09 17:18:14.151693
[0m17:18:14.152223 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:18:14.194024 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:18:14.195062 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:18:14.195220 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:18:14.195362 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:18:14.653115 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:18:14.654180 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:18:14.654556 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json->'red'->>'has_won' as red_has_won,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:18:14.720322 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m17:18:14.721383 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:18:14.769101 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:18:14.152472 => 2023-04-09 17:18:14.768794
[0m17:18:14.770046 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:18:14.809520 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:18:14.810057 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ce35ba57-0080-4142-839f-f14bb4dc987a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10505dee0>]}
[0m17:18:14.810560 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.66s]
[0m17:18:14.812362 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:18:14.814518 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:18:14.814917 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:14.815180 [debug] [MainThread]: On master: BEGIN
[0m17:18:14.815412 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:18:15.294064 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:18:15.294481 [debug] [MainThread]: On master: COMMIT
[0m17:18:15.294768 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:15.295043 [debug] [MainThread]: On master: COMMIT
[0m17:18:15.344373 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:18:15.344940 [debug] [MainThread]: On master: Close
[0m17:18:15.346151 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:15.346510 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:18:15.346829 [info ] [MainThread]: 
[0m17:18:15.347305 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m17:18:15.347959 [debug] [MainThread]: Command end result
[0m17:18:15.352274 [info ] [MainThread]: 
[0m17:18:15.352544 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:18:15.352710 [info ] [MainThread]: 
[0m17:18:15.352868 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:18:15.353017 [error] [MainThread]:   invalid input syntax for type json
[0m17:18:15.353156 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m17:18:15.353290 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m17:18:15.353513 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:18:15.353697 [info ] [MainThread]: 
[0m17:18:15.353865 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:18:15.354075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10508de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050418b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105041b20>]}
[0m17:18:15.354326 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:19:04.356202 | 75ce349c-8cb9-4193-8dbc-87e248a3aeec ==============================
[0m17:19:04.356202 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:19:04.357525 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:19:04.357662 [debug] [MainThread]: Tracking: tracking
[0m17:19:04.380618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104934130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046758b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046753a0>]}
[0m17:19:04.388350 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:19:04.423933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:19:04.424229 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:19:04.432912 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:19:04.442300 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:19:04.445226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75ce349c-8cb9-4193-8dbc-87e248a3aeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dc00d0>]}
[0m17:19:04.461050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75ce349c-8cb9-4193-8dbc-87e248a3aeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db1190>]}
[0m17:19:04.461295 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:19:04.461462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ce349c-8cb9-4193-8dbc-87e248a3aeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046753a0>]}
[0m17:19:04.462101 [info ] [MainThread]: 
[0m17:19:04.463074 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:19:04.463561 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:19:04.469575 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:19:04.469767 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:19:04.469890 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:04.981706 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m17:19:04.984138 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:19:04.986440 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:19:04.995308 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:19:04.995700 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:19:04.995957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:05.577587 [debug] [ThreadPool]: SQL status: BEGIN in 1 seconds
[0m17:19:05.580040 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:19:05.580769 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:19:05.636686 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:19:05.641318 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:19:05.686263 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:19:05.699067 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:05.699519 [debug] [MainThread]: On master: BEGIN
[0m17:19:05.699838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:06.152527 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:19:06.153793 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:06.154470 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:19:06.216008 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:19:06.220531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ce349c-8cb9-4193-8dbc-87e248a3aeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104dffa30>]}
[0m17:19:06.221407 [debug] [MainThread]: On master: ROLLBACK
[0m17:19:06.270378 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:06.271333 [debug] [MainThread]: On master: BEGIN
[0m17:19:06.371131 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:19:06.372318 [debug] [MainThread]: On master: COMMIT
[0m17:19:06.373050 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:06.373779 [debug] [MainThread]: On master: COMMIT
[0m17:19:06.423145 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:19:06.424414 [debug] [MainThread]: On master: Close
[0m17:19:06.427018 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:19:06.427815 [info ] [MainThread]: 
[0m17:19:06.438755 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:19:06.439298 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:19:06.440131 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:19:06.440417 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:19:06.443882 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:19:06.448098 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:19:06.440621 => 2023-04-09 17:19:06.447965
[0m17:19:06.448488 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:19:06.490426 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:19:06.500033 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:19:06.500205 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:19:06.500348 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:06.970967 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:19:06.971570 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:19:06.971961 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json::red,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:19:07.023242 [debug] [Thread-1  ]: Postgres adapter: Postgres error: type "red" does not exist
LINE 27:         teams::json::red,
                              ^

[0m17:19:07.024170 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:19:07.073934 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:19:06.448701 => 2023-04-09 17:19:07.073677
[0m17:19:07.074853 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:19:07.112769 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  type "red" does not exist
  LINE 27:         teams::json::red,
                                ^
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:19:07.113290 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '75ce349c-8cb9-4193-8dbc-87e248a3aeec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e7af40>]}
[0m17:19:07.113796 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.67s]
[0m17:19:07.115508 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:19:07.117486 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:19:07.117777 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:07.117995 [debug] [MainThread]: On master: BEGIN
[0m17:19:07.118195 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:19:07.568544 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:19:07.569890 [debug] [MainThread]: On master: COMMIT
[0m17:19:07.570572 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:07.571250 [debug] [MainThread]: On master: COMMIT
[0m17:19:07.619796 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:19:07.620906 [debug] [MainThread]: On master: Close
[0m17:19:07.622777 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:07.623283 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:19:07.623867 [info ] [MainThread]: 
[0m17:19:07.624641 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m17:19:07.625599 [debug] [MainThread]: Command end result
[0m17:19:07.639642 [info ] [MainThread]: 
[0m17:19:07.640239 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:19:07.640640 [info ] [MainThread]: 
[0m17:19:07.641020 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:19:07.641397 [error] [MainThread]:   type "red" does not exist
[0m17:19:07.641748 [error] [MainThread]:   LINE 27:         teams::json::red,
[0m17:19:07.642089 [error] [MainThread]:                                 ^
[0m17:19:07.642426 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:19:07.642775 [info ] [MainThread]: 
[0m17:19:07.643144 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:19:07.643624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e9efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d33a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e5e940>]}
[0m17:19:07.644030 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:19:14.951899 | 7aee633b-44d9-44cb-85e2-1cdbb7cea2f5 ==============================
[0m17:19:14.951899 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:19:14.953037 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:19:14.953148 [debug] [MainThread]: Tracking: tracking
[0m17:19:14.972495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063014c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106303580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106303310>]}
[0m17:19:14.981714 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:19:15.017802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:19:15.018121 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:19:15.025710 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:19:15.035750 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:19:15.038936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7aee633b-44d9-44cb-85e2-1cdbb7cea2f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106787fa0>]}
[0m17:19:15.049808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7aee633b-44d9-44cb-85e2-1cdbb7cea2f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106777190>]}
[0m17:19:15.050073 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:19:15.050246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aee633b-44d9-44cb-85e2-1cdbb7cea2f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063014c0>]}
[0m17:19:15.050914 [info ] [MainThread]: 
[0m17:19:15.051869 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:19:15.052406 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:19:15.058706 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:19:15.058920 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:19:15.059059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:15.518929 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m17:19:15.520446 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:19:15.522002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:19:15.527159 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:19:15.527387 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:19:15.527541 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:15.989054 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:19:15.989971 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:19:15.990708 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:19:16.045540 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:19:16.047699 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:19:16.095502 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:19:16.105266 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:16.105745 [debug] [MainThread]: On master: BEGIN
[0m17:19:16.106061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:16.556514 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:19:16.557843 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:16.558522 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:19:16.619457 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:19:16.623669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7aee633b-44d9-44cb-85e2-1cdbb7cea2f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a6a60>]}
[0m17:19:16.624683 [debug] [MainThread]: On master: ROLLBACK
[0m17:19:16.673121 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:16.674005 [debug] [MainThread]: On master: BEGIN
[0m17:19:16.769195 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:19:16.770597 [debug] [MainThread]: On master: COMMIT
[0m17:19:16.771328 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:16.772033 [debug] [MainThread]: On master: COMMIT
[0m17:19:16.819326 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:19:16.820457 [debug] [MainThread]: On master: Close
[0m17:19:16.822573 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:19:16.823464 [info ] [MainThread]: 
[0m17:19:16.835697 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:19:16.836290 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:19:16.837241 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:19:16.837574 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:19:16.841728 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:19:16.843386 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:19:16.837813 => 2023-04-09 17:19:16.843262
[0m17:19:16.843729 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:19:16.885532 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:19:16.886416 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:19:16.886561 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:19:16.886686 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:17.342262 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:19:17.343496 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:19:17.344092 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json:red,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:19:17.393844 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ":"
LINE 27:         teams::json:red,
                            ^

[0m17:19:17.394697 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:19:17.445372 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:19:16.843937 => 2023-04-09 17:19:17.444968
[0m17:19:17.446498 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:19:17.487417 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  syntax error at or near ":"
  LINE 27:         teams::json:red,
                              ^
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:19:17.488026 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7aee633b-44d9-44cb-85e2-1cdbb7cea2f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067ccee0>]}
[0m17:19:17.488531 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.65s]
[0m17:19:17.490327 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:19:17.492340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:19:17.492697 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:17.492972 [debug] [MainThread]: On master: BEGIN
[0m17:19:17.493199 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:19:17.941505 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:19:17.942859 [debug] [MainThread]: On master: COMMIT
[0m17:19:17.943551 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:17.944181 [debug] [MainThread]: On master: COMMIT
[0m17:19:17.992524 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:19:17.993978 [debug] [MainThread]: On master: Close
[0m17:19:17.996451 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:17.996879 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:19:17.997401 [info ] [MainThread]: 
[0m17:19:17.998105 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m17:19:17.998825 [debug] [MainThread]: Command end result
[0m17:19:18.009512 [info ] [MainThread]: 
[0m17:19:18.010150 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:19:18.010553 [info ] [MainThread]: 
[0m17:19:18.010936 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:19:18.011300 [error] [MainThread]:   syntax error at or near ":"
[0m17:19:18.011643 [error] [MainThread]:   LINE 27:         teams::json:red,
[0m17:19:18.011978 [error] [MainThread]:                               ^
[0m17:19:18.012309 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:19:18.012653 [info ] [MainThread]: 
[0m17:19:18.013025 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:19:18.013480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106870e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682a880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10682aaf0>]}
[0m17:19:18.013854 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:19:50.562910 | 485c66e7-321e-4d7b-8330-32ba04719c64 ==============================
[0m17:19:50.562910 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:19:50.564011 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:19:50.564140 [debug] [MainThread]: Tracking: tracking
[0m17:19:50.578743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104283430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10378b760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104280d60>]}
[0m17:19:50.586255 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:19:50.616085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:19:50.616370 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:19:50.623490 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:19:50.631734 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:19:50.634564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '485c66e7-321e-4d7b-8330-32ba04719c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105022fd0>]}
[0m17:19:50.646016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '485c66e7-321e-4d7b-8330-32ba04719c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105014190>]}
[0m17:19:50.646255 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:19:50.646425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '485c66e7-321e-4d7b-8330-32ba04719c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10378b760>]}
[0m17:19:50.647064 [info ] [MainThread]: 
[0m17:19:50.647993 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:19:50.648556 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:19:50.654721 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:19:50.654911 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:19:50.655031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:51.158253 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m17:19:51.161789 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:19:51.164271 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:19:51.173707 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:19:51.174095 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:19:51.174376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:51.635793 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:19:51.636292 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:19:51.636613 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:19:51.690919 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:19:51.692861 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:19:51.739833 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:19:51.746444 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:51.746777 [debug] [MainThread]: On master: BEGIN
[0m17:19:51.746975 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:52.189277 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:19:52.190362 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:52.190831 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:19:52.250402 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:19:52.252542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '485c66e7-321e-4d7b-8330-32ba04719c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105040a30>]}
[0m17:19:52.253116 [debug] [MainThread]: On master: ROLLBACK
[0m17:19:52.299717 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:52.300204 [debug] [MainThread]: On master: BEGIN
[0m17:19:52.394006 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:19:52.395160 [debug] [MainThread]: On master: COMMIT
[0m17:19:52.395616 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:52.396573 [debug] [MainThread]: On master: COMMIT
[0m17:19:52.441562 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:19:52.442812 [debug] [MainThread]: On master: Close
[0m17:19:52.445032 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:19:52.445830 [info ] [MainThread]: 
[0m17:19:52.457605 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:19:52.458286 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:19:52.459282 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:19:52.459622 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:19:52.463758 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:19:52.469985 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:19:52.459853 => 2023-04-09 17:19:52.469832
[0m17:19:52.470440 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:19:52.512487 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:19:52.522400 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:19:52.522561 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:19:52.522708 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:19:52.979986 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:19:52.980488 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:19:52.980825 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json->'red',
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:19:53.046215 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m17:19:53.047210 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:19:53.100081 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:19:52.470695 => 2023-04-09 17:19:53.099812
[0m17:19:53.101031 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:19:53.142836 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:19:53.143397 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '485c66e7-321e-4d7b-8330-32ba04719c64', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050dcee0>]}
[0m17:19:53.143900 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.68s]
[0m17:19:53.145649 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:19:53.147499 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:19:53.147849 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:53.148077 [debug] [MainThread]: On master: BEGIN
[0m17:19:53.148286 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:19:53.593430 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:19:53.594804 [debug] [MainThread]: On master: COMMIT
[0m17:19:53.595506 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:53.596211 [debug] [MainThread]: On master: COMMIT
[0m17:19:53.643075 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:19:53.644321 [debug] [MainThread]: On master: Close
[0m17:19:53.646879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:53.647391 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:19:53.647939 [info ] [MainThread]: 
[0m17:19:53.648667 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m17:19:53.649359 [debug] [MainThread]: Command end result
[0m17:19:53.662897 [info ] [MainThread]: 
[0m17:19:53.663504 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:19:53.663914 [info ] [MainThread]: 
[0m17:19:53.664333 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:19:53.664695 [error] [MainThread]:   invalid input syntax for type json
[0m17:19:53.665043 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m17:19:53.665386 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m17:19:53.665720 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:19:53.666069 [info ] [MainThread]: 
[0m17:19:53.666430 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:19:53.666906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10520de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c0b20>]}
[0m17:19:53.667303 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:20:00.181367 | cc98c91e-a16a-4cf7-adcd-5a57e01db6c4 ==============================
[0m17:20:00.181367 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:20:00.182521 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:20:00.182637 [debug] [MainThread]: Tracking: tracking
[0m17:20:00.195478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e9d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10444b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104734d90>]}
[0m17:20:00.202541 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:20:00.233677 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:20:00.233962 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:20:00.241030 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:20:00.249218 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:20:00.251968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc98c91e-a16a-4cf7-adcd-5a57e01db6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc00d0>]}
[0m17:20:00.266076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc98c91e-a16a-4cf7-adcd-5a57e01db6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104baf190>]}
[0m17:20:00.266343 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:20:00.266537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc98c91e-a16a-4cf7-adcd-5a57e01db6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104737790>]}
[0m17:20:00.267227 [info ] [MainThread]: 
[0m17:20:00.268269 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:20:00.268813 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:20:00.275409 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:20:00.275618 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:20:00.275752 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:00.742862 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m17:20:00.748814 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:20:00.752606 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:20:00.763852 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:20:00.764247 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:20:00.764552 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:20:01.219327 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:20:01.220404 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:20:01.221081 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:20:01.278149 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:20:01.282387 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:20:01.332432 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:20:01.341967 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:01.342195 [debug] [MainThread]: On master: BEGIN
[0m17:20:01.342323 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:20:01.816881 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:20:01.817757 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:01.818293 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:20:01.880755 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:20:01.884573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc98c91e-a16a-4cf7-adcd-5a57e01db6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bdea30>]}
[0m17:20:01.885196 [debug] [MainThread]: On master: ROLLBACK
[0m17:20:01.933107 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:01.934023 [debug] [MainThread]: On master: BEGIN
[0m17:20:02.037679 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:20:02.038565 [debug] [MainThread]: On master: COMMIT
[0m17:20:02.038936 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:02.039262 [debug] [MainThread]: On master: COMMIT
[0m17:20:02.091693 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:20:02.093175 [debug] [MainThread]: On master: Close
[0m17:20:02.095963 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:20:02.096894 [info ] [MainThread]: 
[0m17:20:02.107556 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:20:02.108225 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:20:02.109245 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:20:02.109581 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:20:02.113712 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:20:02.115287 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:20:02.109816 => 2023-04-09 17:20:02.115170
[0m17:20:02.115719 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:20:02.157570 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:20:02.158836 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:20:02.159004 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:20:02.159139 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:20:02.596897 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:20:02.598193 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:20:02.598798 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json->>'red',
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:20:02.659243 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m17:20:02.660648 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:20:02.706751 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:20:02.115970 => 2023-04-09 17:20:02.706311
[0m17:20:02.708032 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:20:02.745337 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:20:02.745928 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc98c91e-a16a-4cf7-adcd-5a57e01db6c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c79f10>]}
[0m17:20:02.746449 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.64s]
[0m17:20:02.748245 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:20:02.750527 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:20:02.750921 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:02.751179 [debug] [MainThread]: On master: BEGIN
[0m17:20:02.751413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:20:03.211220 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:20:03.212650 [debug] [MainThread]: On master: COMMIT
[0m17:20:03.213496 [debug] [MainThread]: Using postgres connection "master"
[0m17:20:03.214083 [debug] [MainThread]: On master: COMMIT
[0m17:20:03.263828 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:20:03.264942 [debug] [MainThread]: On master: Close
[0m17:20:03.266919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:03.267911 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:20:03.268596 [info ] [MainThread]: 
[0m17:20:03.269297 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.00 seconds (3.00s).
[0m17:20:03.270058 [debug] [MainThread]: Command end result
[0m17:20:03.280659 [info ] [MainThread]: 
[0m17:20:03.281284 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:20:03.281694 [info ] [MainThread]: 
[0m17:20:03.282081 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:20:03.282445 [error] [MainThread]:   invalid input syntax for type json
[0m17:20:03.282805 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m17:20:03.283147 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m17:20:03.283482 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:20:03.283828 [info ] [MainThread]: 
[0m17:20:03.284190 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:20:03.284660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ca7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c5d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c5db50>]}
[0m17:20:03.285047 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:21:36.907321 | fde4a2c7-14ef-4408-89f9-c1e51f910eb5 ==============================
[0m17:21:36.907321 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:21:36.908613 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:21:36.908726 [debug] [MainThread]: Tracking: tracking
[0m17:21:36.926917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072a7430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11114b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111434e50>]}
[0m17:21:36.934089 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:21:36.969496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:21:36.969797 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:21:36.977161 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:21:36.986116 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:21:36.989026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fde4a2c7-14ef-4408-89f9-c1e51f910eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118c00d0>]}
[0m17:21:37.002589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fde4a2c7-14ef-4408-89f9-c1e51f910eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118af190>]}
[0m17:21:37.002855 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:21:37.003037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fde4a2c7-14ef-4408-89f9-c1e51f910eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111437790>]}
[0m17:21:37.003763 [info ] [MainThread]: 
[0m17:21:37.004742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:21:37.005363 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:21:37.011715 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:21:37.011909 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:21:37.012077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:37.533719 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m17:21:37.535351 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:21:37.537066 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:21:37.543013 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:21:37.543276 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:21:37.543465 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:37.988931 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:21:37.989810 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:21:37.990308 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:21:38.045188 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:21:38.049435 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:21:38.098024 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:21:38.110908 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:38.111442 [debug] [MainThread]: On master: BEGIN
[0m17:21:38.111761 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:38.563819 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:21:38.564834 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:38.565504 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:21:38.628502 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:21:38.633230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fde4a2c7-14ef-4408-89f9-c1e51f910eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b2a6a0>]}
[0m17:21:38.634240 [debug] [MainThread]: On master: ROLLBACK
[0m17:21:38.681202 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:38.682022 [debug] [MainThread]: On master: BEGIN
[0m17:21:38.778456 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:21:38.779536 [debug] [MainThread]: On master: COMMIT
[0m17:21:38.780258 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:38.780909 [debug] [MainThread]: On master: COMMIT
[0m17:21:38.830299 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:21:38.831400 [debug] [MainThread]: On master: Close
[0m17:21:38.834020 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:21:38.834827 [info ] [MainThread]: 
[0m17:21:38.845883 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:21:38.846480 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:21:38.847500 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:21:38.847856 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:21:38.852018 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:21:38.856857 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:21:38.848101 => 2023-04-09 17:21:38.856735
[0m17:21:38.857249 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:21:38.899548 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:21:38.909715 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:21:38.909880 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:21:38.910023 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:21:39.379552 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:21:39.382511 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:21:39.382921 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:21:39.439178 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m17:21:39.439865 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:21:39.488381 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:21:38.857453 => 2023-04-09 17:21:39.488162
[0m17:21:39.489079 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:21:39.525203 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:21:39.525740 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fde4a2c7-14ef-4408-89f9-c1e51f910eb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b9cf70>]}
[0m17:21:39.526257 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.68s]
[0m17:21:39.528080 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:21:39.530171 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:21:39.530557 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:39.530820 [debug] [MainThread]: On master: BEGIN
[0m17:21:39.531058 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:40.022209 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:21:40.022938 [debug] [MainThread]: On master: COMMIT
[0m17:21:40.023323 [debug] [MainThread]: Using postgres connection "master"
[0m17:21:40.023698 [debug] [MainThread]: On master: COMMIT
[0m17:21:40.078166 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:21:40.079653 [debug] [MainThread]: On master: Close
[0m17:21:40.082043 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:40.083157 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:21:40.083966 [info ] [MainThread]: 
[0m17:21:40.084634 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m17:21:40.085303 [debug] [MainThread]: Command end result
[0m17:21:40.099265 [info ] [MainThread]: 
[0m17:21:40.099888 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:21:40.100305 [info ] [MainThread]: 
[0m17:21:40.100701 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:21:40.101072 [error] [MainThread]:   invalid input syntax for type json
[0m17:21:40.101421 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m17:21:40.101761 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m17:21:40.102099 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:21:40.102458 [info ] [MainThread]: 
[0m17:21:40.102827 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:21:40.103290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bcbee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b81940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b81bb0>]}
[0m17:21:40.103666 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:21:59.068322 | 2d96ad2e-b0bc-4ef7-ad29-67c31b556bc8 ==============================
[0m17:21:59.068322 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:21:59.069543 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:21:59.069719 [debug] [MainThread]: Tracking: tracking
[0m17:21:59.086262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bdf0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bea580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bea310>]}
[0m17:21:59.094611 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:21:59.134374 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:21:59.134742 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:21:59.144801 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:21:59.156123 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:21:59.159597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d96ad2e-b0bc-4ef7-ad29-67c31b556bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806efa0>]}
[0m17:21:59.172241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d96ad2e-b0bc-4ef7-ad29-67c31b556bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10805f190>]}
[0m17:21:59.172575 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:21:59.172764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d96ad2e-b0bc-4ef7-ad29-67c31b556bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bdf0a0>]}
[0m17:21:59.173577 [info ] [MainThread]: 
[0m17:21:59.174667 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:21:59.175394 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:21:59.182788 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:21:59.183016 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:21:59.183218 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:59.689390 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m17:21:59.692672 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:21:59.695049 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:21:59.703934 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:21:59.704327 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:21:59.704588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:00.155182 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:22:00.156663 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:22:00.157436 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:22:00.211749 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:22:00.217074 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:22:00.265513 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:22:00.279836 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:00.280324 [debug] [MainThread]: On master: BEGIN
[0m17:22:00.280640 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:22:00.758084 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:22:00.759392 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:00.760096 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:22:00.824514 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:22:00.829012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d96ad2e-b0bc-4ef7-ad29-67c31b556bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10808ea60>]}
[0m17:22:00.830099 [debug] [MainThread]: On master: ROLLBACK
[0m17:22:00.884914 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:00.885958 [debug] [MainThread]: On master: BEGIN
[0m17:22:00.987120 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:22:00.987698 [debug] [MainThread]: On master: COMMIT
[0m17:22:00.988012 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:00.988322 [debug] [MainThread]: On master: COMMIT
[0m17:22:01.037955 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:22:01.038761 [debug] [MainThread]: On master: Close
[0m17:22:01.040514 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:22:01.041181 [info ] [MainThread]: 
[0m17:22:01.050511 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:22:01.050916 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:22:01.051550 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:22:01.051770 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:22:01.055716 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:22:01.057256 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:22:01.051926 => 2023-04-09 17:22:01.057179
[0m17:22:01.057513 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:22:01.099114 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:22:01.100556 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:22:01.100716 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:22:01.100858 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:01.552206 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:22:01.553384 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:22:01.554007 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::varchar::json,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:22:01.613567 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m17:22:01.614549 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:22:01.663100 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:22:01.057664 => 2023-04-09 17:22:01.662785
[0m17:22:01.664031 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:22:01.704798 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:22:01.705376 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d96ad2e-b0bc-4ef7-ad29-67c31b556bc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108129eb0>]}
[0m17:22:01.705900 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.65s]
[0m17:22:01.707701 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:22:01.709809 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:22:01.710221 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:01.710460 [debug] [MainThread]: On master: BEGIN
[0m17:22:01.710664 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:22:02.160297 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:22:02.161399 [debug] [MainThread]: On master: COMMIT
[0m17:22:02.161936 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:02.162430 [debug] [MainThread]: On master: COMMIT
[0m17:22:02.211506 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:22:02.212498 [debug] [MainThread]: On master: Close
[0m17:22:02.214932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:02.215396 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:22:02.215940 [info ] [MainThread]: 
[0m17:22:02.216679 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.04 seconds (3.04s).
[0m17:22:02.217434 [debug] [MainThread]: Command end result
[0m17:22:02.228712 [info ] [MainThread]: 
[0m17:22:02.229320 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:22:02.229732 [info ] [MainThread]: 
[0m17:22:02.230116 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:22:02.230473 [error] [MainThread]:   invalid input syntax for type json
[0m17:22:02.230818 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m17:22:02.231155 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m17:22:02.231487 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:22:02.231833 [info ] [MainThread]: 
[0m17:22:02.232188 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:22:02.232635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108158e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108112880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108112af0>]}
[0m17:22:02.233000 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:22:13.110952 | 08a67929-8fae-4589-ae6d-5a8516c799c6 ==============================
[0m17:22:13.110952 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:22:13.112021 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:22:13.112150 [debug] [MainThread]: Tracking: tracking
[0m17:22:13.128771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058252b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10658b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106874d90>]}
[0m17:22:13.135850 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:22:13.165268 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:22:13.165572 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:22:13.172775 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:22:13.181496 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:22:13.184677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08a67929-8fae-4589-ae6d-5a8516c799c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cff0d0>]}
[0m17:22:13.202049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08a67929-8fae-4589-ae6d-5a8516c799c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cee190>]}
[0m17:22:13.202334 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:22:13.202584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08a67929-8fae-4589-ae6d-5a8516c799c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106878790>]}
[0m17:22:13.203390 [info ] [MainThread]: 
[0m17:22:13.205108 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:22:13.205885 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:22:13.212710 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:22:13.212905 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:22:13.213034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:13.698499 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m17:22:13.701309 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:22:13.703432 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:22:13.712285 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:22:13.712599 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:22:13.712858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:22:14.158509 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:22:14.159023 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:22:14.159339 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:22:14.210746 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:22:14.213229 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:22:14.260962 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:22:14.275301 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:14.275692 [debug] [MainThread]: On master: BEGIN
[0m17:22:14.275998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:22:14.728802 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:22:14.729831 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:14.730499 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:22:14.793048 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:22:14.796957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08a67929-8fae-4589-ae6d-5a8516c799c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d1ca30>]}
[0m17:22:14.797768 [debug] [MainThread]: On master: ROLLBACK
[0m17:22:14.846402 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:14.847453 [debug] [MainThread]: On master: BEGIN
[0m17:22:14.944842 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:22:14.945832 [debug] [MainThread]: On master: COMMIT
[0m17:22:14.946367 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:14.946893 [debug] [MainThread]: On master: COMMIT
[0m17:22:14.996739 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:22:14.997401 [debug] [MainThread]: On master: Close
[0m17:22:14.998700 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:22:14.999409 [info ] [MainThread]: 
[0m17:22:15.008805 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:22:15.009273 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:22:15.009996 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:22:15.010249 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:22:15.013809 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:22:15.019885 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:22:15.010434 => 2023-04-09 17:22:15.019756
[0m17:22:15.020245 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:22:15.058695 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:22:15.066412 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:22:15.066613 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:22:15.066758 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:22:15.511355 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:22:15.512627 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:22:15.513240 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::text::json,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:22:15.569979 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m17:22:15.570871 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:22:15.622300 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:22:15.020404 => 2023-04-09 17:22:15.622027
[0m17:22:15.623145 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:22:15.664318 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:22:15.664854 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08a67929-8fae-4589-ae6d-5a8516c799c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106db7f10>]}
[0m17:22:15.665330 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.66s]
[0m17:22:15.666915 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:22:15.668818 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:22:15.669142 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:15.669370 [debug] [MainThread]: On master: BEGIN
[0m17:22:15.669577 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:22:16.139553 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:22:16.140530 [debug] [MainThread]: On master: COMMIT
[0m17:22:16.141221 [debug] [MainThread]: Using postgres connection "master"
[0m17:22:16.141905 [debug] [MainThread]: On master: COMMIT
[0m17:22:16.193625 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:22:16.194997 [debug] [MainThread]: On master: Close
[0m17:22:16.197240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:16.197635 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:22:16.198072 [info ] [MainThread]: 
[0m17:22:16.198558 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.99 seconds (2.99s).
[0m17:22:16.199187 [debug] [MainThread]: Command end result
[0m17:22:16.212289 [info ] [MainThread]: 
[0m17:22:16.212895 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:22:16.213303 [info ] [MainThread]: 
[0m17:22:16.213698 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:22:16.214093 [error] [MainThread]:   invalid input syntax for type json
[0m17:22:16.214467 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m17:22:16.214811 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m17:22:16.215151 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:22:16.215499 [info ] [MainThread]: 
[0m17:22:16.215870 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:22:16.216354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f01f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d45b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d451c0>]}
[0m17:22:16.216739 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:23:18.753618 | 396ad5a9-e3fc-4d78-a71d-a23521eedf27 ==============================
[0m17:23:18.753618 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:23:18.754893 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:23:18.755048 [debug] [MainThread]: Tracking: tracking
[0m17:23:18.771619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107de8130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b298b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b293a0>]}
[0m17:23:18.779368 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:23:18.812464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:23:18.812767 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m17:23:18.820528 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m17:23:18.831292 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:23:18.838971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '396ad5a9-e3fc-4d78-a71d-a23521eedf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082740d0>]}
[0m17:23:18.853859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '396ad5a9-e3fc-4d78-a71d-a23521eedf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108263220>]}
[0m17:23:18.854204 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:23:18.854413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '396ad5a9-e3fc-4d78-a71d-a23521eedf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081e7880>]}
[0m17:23:18.855270 [info ] [MainThread]: 
[0m17:23:18.859095 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:23:18.860371 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:23:18.877760 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:23:18.878065 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:23:18.878230 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:19.377057 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m17:23:19.379334 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:23:19.381674 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:23:19.391844 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:23:19.392294 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:23:19.392694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:19.833924 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:23:19.834619 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:23:19.834952 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:23:19.886552 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:23:19.889966 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:23:19.936713 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:23:19.956423 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:19.957292 [debug] [MainThread]: On master: BEGIN
[0m17:23:19.957711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:23:20.433586 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:23:20.434313 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:20.434820 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:23:20.497505 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:23:20.500471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '396ad5a9-e3fc-4d78-a71d-a23521eedf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b8970>]}
[0m17:23:20.501425 [debug] [MainThread]: On master: ROLLBACK
[0m17:23:20.550340 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:20.551038 [debug] [MainThread]: On master: BEGIN
[0m17:23:20.652531 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:23:20.653427 [debug] [MainThread]: On master: COMMIT
[0m17:23:20.654055 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:20.654526 [debug] [MainThread]: On master: COMMIT
[0m17:23:20.703972 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:23:20.704754 [debug] [MainThread]: On master: Close
[0m17:23:20.706661 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:23:20.707474 [info ] [MainThread]: 
[0m17:23:20.719860 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:23:20.720618 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:23:20.722009 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:23:20.722398 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:23:20.726791 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:23:20.728737 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:23:20.722658 => 2023-04-09 17:23:20.728610
[0m17:23:20.729114 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:23:20.771816 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:23:20.773080 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:23:20.773282 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:23:20.773409 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:23:21.225635 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:23:21.226235 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:23:21.226521 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::jsonb,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:23:21.288950 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m17:23:21.289641 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:23:21.335854 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:23:20.729317 => 2023-04-09 17:23:21.335758
[0m17:23:21.336126 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:23:21.361076 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:23:21.361439 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '396ad5a9-e3fc-4d78-a71d-a23521eedf27', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10832df40>]}
[0m17:23:21.361783 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.64s]
[0m17:23:21.363419 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:23:21.368697 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:23:21.368925 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:21.369045 [debug] [MainThread]: On master: BEGIN
[0m17:23:21.369157 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:23:21.805879 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:23:21.807166 [debug] [MainThread]: On master: COMMIT
[0m17:23:21.808349 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:21.809182 [debug] [MainThread]: On master: COMMIT
[0m17:23:21.857257 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:23:21.858568 [debug] [MainThread]: On master: Close
[0m17:23:21.860578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:21.860961 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:23:21.861435 [info ] [MainThread]: 
[0m17:23:21.862027 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.01 seconds (3.01s).
[0m17:23:21.862691 [debug] [MainThread]: Command end result
[0m17:23:21.873590 [info ] [MainThread]: 
[0m17:23:21.874179 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:23:21.874587 [info ] [MainThread]: 
[0m17:23:21.874983 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:23:21.875347 [error] [MainThread]:   invalid input syntax for type json
[0m17:23:21.875697 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m17:23:21.876038 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m17:23:21.876376 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:23:21.876720 [info ] [MainThread]: 
[0m17:23:21.877082 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:23:21.877540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108353fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108311a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108311e50>]}
[0m17:23:21.877911 [debug] [MainThread]: Flushing usage events


============================== 2023-04-09 17:23:51.242389 | 5c126d9c-b8d5-4d9c-a31e-2a3b242cde76 ==============================
[0m17:23:51.242389 [info ] [MainThread]: Running with dbt=1.4.5
[0m17:23:51.243832 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m17:23:51.244003 [debug] [MainThread]: Tracking: tracking
[0m17:23:51.258590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057df340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ac8d90>]}
[0m17:23:51.268425 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m17:23:51.303259 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:23:51.303456 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:23:51.303803 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m17:23:51.307352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c126d9c-b8d5-4d9c-a31e-2a3b242cde76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f1b0d0>]}
[0m17:23:51.319402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c126d9c-b8d5-4d9c-a31e-2a3b242cde76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee6610>]}
[0m17:23:51.319646 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m17:23:51.319817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c126d9c-b8d5-4d9c-a31e-2a3b242cde76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105acc790>]}
[0m17:23:51.320454 [info ] [MainThread]: 
[0m17:23:51.321418 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:23:51.321903 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m17:23:51.327965 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m17:23:51.328160 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m17:23:51.328281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:23:51.840504 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m17:23:51.843070 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m17:23:51.845554 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m17:23:51.854679 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:23:51.855076 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m17:23:51.855525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:23:52.313167 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m17:23:52.314590 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m17:23:52.315260 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m17:23:52.369663 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m17:23:52.373212 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m17:23:52.425182 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m17:23:52.438304 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:52.438782 [debug] [MainThread]: On master: BEGIN
[0m17:23:52.439098 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:23:52.905499 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:23:52.906916 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:52.907648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:23:52.968765 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m17:23:52.971670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c126d9c-b8d5-4d9c-a31e-2a3b242cde76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f9c880>]}
[0m17:23:52.972371 [debug] [MainThread]: On master: ROLLBACK
[0m17:23:53.021776 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:53.022691 [debug] [MainThread]: On master: BEGIN
[0m17:23:53.121299 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:23:53.122293 [debug] [MainThread]: On master: COMMIT
[0m17:23:53.122981 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:53.123619 [debug] [MainThread]: On master: COMMIT
[0m17:23:53.171068 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:23:53.172042 [debug] [MainThread]: On master: Close
[0m17:23:53.174305 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m17:23:53.175150 [info ] [MainThread]: 
[0m17:23:53.185944 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m17:23:53.186568 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m17:23:53.187561 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m17:23:53.187899 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m17:23:53.193221 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m17:23:53.198838 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-09 17:23:53.188134 => 2023-04-09 17:23:53.198692
[0m17:23:53.199300 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m17:23:53.240311 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m17:23:53.253825 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:23:53.253987 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m17:23:53.254129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m17:23:53.704042 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m17:23:53.705310 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m17:23:53.705939 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::jsonb,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m17:23:53.822258 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m17:23:53.823258 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m17:23:53.877557 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-09 17:23:53.199563 => 2023-04-09 17:23:53.877301
[0m17:23:53.878400 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m17:23:53.916614 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:23:53.917219 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c126d9c-b8d5-4d9c-a31e-2a3b242cde76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fddf70>]}
[0m17:23:53.917808 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.73s]
[0m17:23:53.919891 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m17:23:53.921962 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:23:53.922311 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:53.922552 [debug] [MainThread]: On master: BEGIN
[0m17:23:53.922783 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:23:54.418521 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m17:23:54.419835 [debug] [MainThread]: On master: COMMIT
[0m17:23:54.420544 [debug] [MainThread]: Using postgres connection "master"
[0m17:23:54.421213 [debug] [MainThread]: On master: COMMIT
[0m17:23:54.471505 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m17:23:54.472332 [debug] [MainThread]: On master: Close
[0m17:23:54.473809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:23:54.474200 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m17:23:54.474720 [info ] [MainThread]: 
[0m17:23:54.475287 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m17:23:54.476155 [debug] [MainThread]: Command end result
[0m17:23:54.487312 [info ] [MainThread]: 
[0m17:23:54.487920 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:23:54.488308 [info ] [MainThread]: 
[0m17:23:54.488630 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m17:23:54.488941 [error] [MainThread]:   invalid input syntax for type json
[0m17:23:54.489239 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m17:23:54.489527 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m17:23:54.489812 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m17:23:54.490102 [info ] [MainThread]: 
[0m17:23:54.490408 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m17:23:54.490799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb3d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ee6310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057dc0a0>]}
[0m17:23:54.491122 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 14:51:46.050145 | 8aac2733-f766-459c-b8d7-b56a39f2546f ==============================
[0m14:51:46.050145 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:51:46.051679 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:51:46.051818 [debug] [MainThread]: Tracking: tracking
[0m14:51:46.078214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10428ec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d00a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d0a90>]}
[0m14:51:46.088638 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:51:46.478066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:51:46.478464 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m14:51:46.494617 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m14:51:46.512916 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m14:51:46.517847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8aac2733-f766-459c-b8d7-b56a39f2546f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a1e9a0>]}
[0m14:51:46.535081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8aac2733-f766-459c-b8d7-b56a39f2546f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a0b220>]}
[0m14:51:46.535425 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:51:46.535695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aac2733-f766-459c-b8d7-b56a39f2546f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10498d790>]}
[0m14:51:46.536625 [info ] [MainThread]: 
[0m14:51:46.538101 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:46.538995 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m14:51:46.548655 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m14:51:46.548913 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:51:46.549099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:51:47.095012 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m14:51:47.100178 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m14:51:47.103616 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m14:51:47.114548 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:51:47.114967 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m14:51:47.115285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:51:47.536490 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:51:47.537463 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:51:47.538087 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m14:51:47.591560 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m14:51:47.596614 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m14:51:47.641292 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m14:51:47.653994 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:47.654480 [debug] [MainThread]: On master: BEGIN
[0m14:51:47.654813 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:51:48.089516 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:51:48.090850 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:48.091512 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:51:48.151431 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m14:51:48.155935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aac2733-f766-459c-b8d7-b56a39f2546f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104a3ba30>]}
[0m14:51:48.156879 [debug] [MainThread]: On master: ROLLBACK
[0m14:51:48.202092 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:48.203003 [debug] [MainThread]: On master: BEGIN
[0m14:51:48.295888 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:51:48.297055 [debug] [MainThread]: On master: COMMIT
[0m14:51:48.297752 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:48.298409 [debug] [MainThread]: On master: COMMIT
[0m14:51:48.345186 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:51:48.346418 [debug] [MainThread]: On master: Close
[0m14:51:48.349147 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m14:51:48.349850 [info ] [MainThread]: 
[0m14:51:48.361678 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m14:51:48.362325 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m14:51:48.363311 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m14:51:48.363644 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m14:51:48.367814 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m14:51:48.372079 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-17 14:51:48.363870 => 2023-04-17 14:51:48.371950
[0m14:51:48.372455 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m14:51:48.412970 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m14:51:48.422812 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m14:51:48.422985 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m14:51:48.423129 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:51:48.855613 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:51:48.856718 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m14:51:48.857271 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::jsonb->'red' as red,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m14:51:48.927563 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m14:51:48.928878 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m14:51:48.977119 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-17 14:51:48.372653 => 2023-04-17 14:51:48.976832
[0m14:51:48.977980 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m14:51:49.066210 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m14:51:49.067013 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8aac2733-f766-459c-b8d7-b56a39f2546f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad4e50>]}
[0m14:51:49.067817 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.70s]
[0m14:51:49.070435 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m14:51:49.073037 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:51:49.073426 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:49.073706 [debug] [MainThread]: On master: BEGIN
[0m14:51:49.073981 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:51:49.513974 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:51:49.515401 [debug] [MainThread]: On master: COMMIT
[0m14:51:49.516075 [debug] [MainThread]: Using postgres connection "master"
[0m14:51:49.516591 [debug] [MainThread]: On master: COMMIT
[0m14:51:49.561716 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:51:49.562546 [debug] [MainThread]: On master: Close
[0m14:51:49.564995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:51:49.565423 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m14:51:49.565951 [info ] [MainThread]: 
[0m14:51:49.566706 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.03 seconds (3.03s).
[0m14:51:49.567457 [debug] [MainThread]: Command end result
[0m14:51:49.581118 [info ] [MainThread]: 
[0m14:51:49.581670 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:51:49.582046 [info ] [MainThread]: 
[0m14:51:49.582406 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m14:51:49.582744 [error] [MainThread]:   invalid input syntax for type json
[0m14:51:49.583070 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m14:51:49.583393 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m14:51:49.583710 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m14:51:49.584037 [info ] [MainThread]: 
[0m14:51:49.584380 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:51:49.584827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b04dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104abdaf0>]}
[0m14:51:49.585200 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 14:52:57.135745 | e46b5efa-fbe1-45f0-8996-5741ad1a3af9 ==============================
[0m14:52:57.135745 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:52:57.136910 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:52:57.137023 [debug] [MainThread]: Tracking: tracking
[0m14:52:57.152135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb8430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ccf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb4d60>]}
[0m14:52:57.159532 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:52:57.190615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:52:57.190884 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m14:52:57.198074 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m14:52:57.206408 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m14:52:57.209250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e46b5efa-fbe1-45f0-8996-5741ad1a3af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110163fd0>]}
[0m14:52:57.222586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e46b5efa-fbe1-45f0-8996-5741ad1a3af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110150190>]}
[0m14:52:57.222840 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:52:57.223020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e46b5efa-fbe1-45f0-8996-5741ad1a3af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ccf70>]}
[0m14:52:57.223689 [info ] [MainThread]: 
[0m14:52:57.224701 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:57.225240 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m14:52:57.231513 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m14:52:57.231720 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:52:57.231842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:57.713888 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m14:52:57.718911 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m14:52:57.722739 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m14:52:57.732537 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:52:57.732919 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m14:52:57.733231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:52:58.168498 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:52:58.169416 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:52:58.170021 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m14:52:58.223641 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m14:52:58.228136 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m14:52:58.276856 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m14:52:58.289989 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:58.290374 [debug] [MainThread]: On master: BEGIN
[0m14:52:58.290677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:58.730430 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:52:58.731790 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:58.732453 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:52:58.793419 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m14:52:58.798738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e46b5efa-fbe1-45f0-8996-5741ad1a3af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110183730>]}
[0m14:52:58.800011 [debug] [MainThread]: On master: ROLLBACK
[0m14:52:58.846845 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:58.847757 [debug] [MainThread]: On master: BEGIN
[0m14:52:58.941705 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:52:58.943101 [debug] [MainThread]: On master: COMMIT
[0m14:52:58.943821 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:58.944463 [debug] [MainThread]: On master: COMMIT
[0m14:52:58.991868 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:52:58.992839 [debug] [MainThread]: On master: Close
[0m14:52:58.995512 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m14:52:58.996275 [info ] [MainThread]: 
[0m14:52:59.007155 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m14:52:59.007795 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m14:52:59.008892 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m14:52:59.009328 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m14:52:59.013600 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m14:52:59.015231 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-17 14:52:59.009587 => 2023-04-17 14:52:59.015103
[0m14:52:59.015611 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m14:52:59.057051 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m14:52:59.058614 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m14:52:59.058779 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m14:52:59.058908 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:52:59.489873 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:52:59.490897 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m14:52:59.491475 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::jsonb #>'red' as red,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m14:52:59.537066 [debug] [Thread-1  ]: Postgres adapter: Postgres error: malformed array literal: "red"
LINE 27:         teams::jsonb #>'red' as red,
                                ^
DETAIL:  Array value must start with "{" or dimension information.

[0m14:52:59.538004 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m14:52:59.583005 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-17 14:52:59.015797 => 2023-04-17 14:52:59.582617
[0m14:52:59.584733 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m14:52:59.624875 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  malformed array literal: "red"
  LINE 27:         teams::jsonb #>'red' as red,
                                  ^
  DETAIL:  Array value must start with "{" or dimension information.
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m14:52:59.625392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e46b5efa-fbe1-45f0-8996-5741ad1a3af9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110363160>]}
[0m14:52:59.625877 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.62s]
[0m14:52:59.627678 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m14:52:59.629802 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:52:59.630138 [debug] [MainThread]: Using postgres connection "master"
[0m14:52:59.630375 [debug] [MainThread]: On master: BEGIN
[0m14:52:59.630597 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:00.083876 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:53:00.085164 [debug] [MainThread]: On master: COMMIT
[0m14:53:00.085832 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:00.086475 [debug] [MainThread]: On master: COMMIT
[0m14:53:00.130334 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:53:00.131566 [debug] [MainThread]: On master: Close
[0m14:53:00.133730 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:00.134263 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m14:53:00.134718 [info ] [MainThread]: 
[0m14:53:00.135290 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m14:53:00.135955 [debug] [MainThread]: Command end result
[0m14:53:00.146587 [info ] [MainThread]: 
[0m14:53:00.147189 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:53:00.147592 [info ] [MainThread]: 
[0m14:53:00.147981 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m14:53:00.148337 [error] [MainThread]:   malformed array literal: "red"
[0m14:53:00.148672 [error] [MainThread]:   LINE 27:         teams::jsonb #>'red' as red,
[0m14:53:00.148995 [error] [MainThread]:                                   ^
[0m14:53:00.149312 [error] [MainThread]:   DETAIL:  Array value must start with "{" or dimension information.
[0m14:53:00.149602 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m14:53:00.149869 [info ] [MainThread]: 
[0m14:53:00.150154 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:53:00.150535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11034ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101bf8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101bfb20>]}
[0m14:53:00.150857 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 14:53:10.241570 | 67da20ee-947c-4643-848c-4daa61ff1dd1 ==============================
[0m14:53:10.241570 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:53:10.242711 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:53:10.242824 [debug] [MainThread]: Tracking: tracking
[0m14:53:10.258044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039a44c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039a7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039a7310>]}
[0m14:53:10.265699 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:53:10.295017 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:53:10.295295 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m14:53:10.302352 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m14:53:10.310661 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m14:53:10.313488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '67da20ee-947c-4643-848c-4daa61ff1dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104264fa0>]}
[0m14:53:10.326274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '67da20ee-947c-4643-848c-4daa61ff1dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104255190>]}
[0m14:53:10.326515 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:53:10.326682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67da20ee-947c-4643-848c-4daa61ff1dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039a44c0>]}
[0m14:53:10.327292 [info ] [MainThread]: 
[0m14:53:10.328256 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:10.328831 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m14:53:10.335346 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m14:53:10.335536 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:53:10.335653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:10.801273 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m14:53:10.805110 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m14:53:10.807887 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m14:53:10.816900 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:53:10.817289 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m14:53:10.817581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:11.251840 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:53:11.252590 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:53:11.253009 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m14:53:11.304741 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m14:53:11.309159 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m14:53:11.355660 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m14:53:11.366825 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:11.367240 [debug] [MainThread]: On master: BEGIN
[0m14:53:11.367537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:11.805902 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:53:11.807272 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:11.807930 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:53:11.868661 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m14:53:11.873498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '67da20ee-947c-4643-848c-4daa61ff1dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042a1a60>]}
[0m14:53:11.874438 [debug] [MainThread]: On master: ROLLBACK
[0m14:53:11.922337 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:11.923546 [debug] [MainThread]: On master: BEGIN
[0m14:53:12.016497 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:53:12.017888 [debug] [MainThread]: On master: COMMIT
[0m14:53:12.018778 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:12.019427 [debug] [MainThread]: On master: COMMIT
[0m14:53:12.063457 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:53:12.064094 [debug] [MainThread]: On master: Close
[0m14:53:12.065297 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m14:53:12.065752 [info ] [MainThread]: 
[0m14:53:12.075019 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m14:53:12.075658 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m14:53:12.076542 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m14:53:12.076831 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m14:53:12.080300 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m14:53:12.084357 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-17 14:53:12.077033 => 2023-04-17 14:53:12.084230
[0m14:53:12.084749 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m14:53:12.128245 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m14:53:12.137908 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m14:53:12.138095 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m14:53:12.138244 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:53:12.582451 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:53:12.583363 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m14:53:12.584103 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json #>'red' as red,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m14:53:12.630553 [debug] [Thread-1  ]: Postgres adapter: Postgres error: malformed array literal: "red"
LINE 27:         teams::json #>'red' as red,
                               ^
DETAIL:  Array value must start with "{" or dimension information.

[0m14:53:12.631374 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m14:53:12.678903 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-17 14:53:12.084952 => 2023-04-17 14:53:12.678573
[0m14:53:12.680105 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m14:53:12.721672 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  malformed array literal: "red"
  LINE 27:         teams::json #>'red' as red,
                                 ^
  DETAIL:  Array value must start with "{" or dimension information.
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m14:53:12.722258 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '67da20ee-947c-4643-848c-4daa61ff1dd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10431deb0>]}
[0m14:53:12.722792 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.65s]
[0m14:53:12.724575 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m14:53:12.726859 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:12.727233 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:12.727496 [debug] [MainThread]: On master: BEGIN
[0m14:53:12.727733 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:13.146962 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:53:13.147960 [debug] [MainThread]: On master: COMMIT
[0m14:53:13.148719 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:13.149357 [debug] [MainThread]: On master: COMMIT
[0m14:53:13.193212 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:53:13.194403 [debug] [MainThread]: On master: Close
[0m14:53:13.196217 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:13.196611 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m14:53:13.197062 [info ] [MainThread]: 
[0m14:53:13.197577 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m14:53:13.198276 [debug] [MainThread]: Command end result
[0m14:53:13.211544 [info ] [MainThread]: 
[0m14:53:13.212289 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:53:13.212727 [info ] [MainThread]: 
[0m14:53:13.213291 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m14:53:13.213739 [error] [MainThread]:   malformed array literal: "red"
[0m14:53:13.214051 [error] [MainThread]:   LINE 27:         teams::json #>'red' as red,
[0m14:53:13.214340 [error] [MainThread]:                                  ^
[0m14:53:13.214611 [error] [MainThread]:   DETAIL:  Array value must start with "{" or dimension information.
[0m14:53:13.214880 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m14:53:13.215159 [info ] [MainThread]: 
[0m14:53:13.215463 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:53:13.215836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10434ce20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104307880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104307af0>]}
[0m14:53:13.216151 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 14:53:49.994063 | 6846c11c-92cd-45c8-add2-b6264adda42b ==============================
[0m14:53:49.994063 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:53:49.995209 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:53:49.995319 [debug] [MainThread]: Tracking: tracking
[0m14:53:50.008896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f77430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f74d60>]}
[0m14:53:50.016419 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:53:50.047066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:53:50.047331 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m14:53:50.054510 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m14:53:50.062781 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m14:53:50.065615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6846c11c-92cd-45c8-add2-b6264adda42b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109522fd0>]}
[0m14:53:50.075743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6846c11c-92cd-45c8-add2-b6264adda42b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109514190>]}
[0m14:53:50.075979 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:53:50.076141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6846c11c-92cd-45c8-add2-b6264adda42b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c8c760>]}
[0m14:53:50.076752 [info ] [MainThread]: 
[0m14:53:50.077717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:50.078258 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m14:53:50.084590 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m14:53:50.084798 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:53:50.084923 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:53:50.563879 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m14:53:50.566993 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m14:53:50.569383 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m14:53:50.579497 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:53:50.579935 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m14:53:50.580228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:53:51.003508 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:53:51.004044 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:53:51.004354 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m14:53:51.056252 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m14:53:51.059184 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m14:53:51.105678 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m14:53:51.117907 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:51.118381 [debug] [MainThread]: On master: BEGIN
[0m14:53:51.118703 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:53:51.548195 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:53:51.549217 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:51.549810 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:53:51.610702 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m14:53:51.614121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6846c11c-92cd-45c8-add2-b6264adda42b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109560a30>]}
[0m14:53:51.614941 [debug] [MainThread]: On master: ROLLBACK
[0m14:53:51.660702 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:51.661726 [debug] [MainThread]: On master: BEGIN
[0m14:53:51.754467 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:53:51.755665 [debug] [MainThread]: On master: COMMIT
[0m14:53:51.756326 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:51.756989 [debug] [MainThread]: On master: COMMIT
[0m14:53:51.803826 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:53:51.804813 [debug] [MainThread]: On master: Close
[0m14:53:51.807031 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m14:53:51.807794 [info ] [MainThread]: 
[0m14:53:51.817403 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m14:53:51.818094 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m14:53:51.819138 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m14:53:51.819494 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m14:53:51.823851 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m14:53:51.825185 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-17 14:53:51.819738 => 2023-04-17 14:53:51.825068
[0m14:53:51.825581 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m14:53:51.868629 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m14:53:51.869512 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m14:53:51.869664 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m14:53:51.869788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:53:52.298915 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:53:52.299774 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m14:53:52.300134 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json #>{'red'} as red,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m14:53:52.346252 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "{"
LINE 27:         teams::json #>{'red'} as red,
                               ^

[0m14:53:52.346744 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m14:53:52.392186 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-17 14:53:51.825822 => 2023-04-17 14:53:52.392036
[0m14:53:52.392653 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m14:53:52.419714 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  syntax error at or near "{"
  LINE 27:         teams::json #>{'red'} as red,
                                 ^
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m14:53:52.420034 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6846c11c-92cd-45c8-add2-b6264adda42b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972b0d0>]}
[0m14:53:52.420319 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.60s]
[0m14:53:52.421308 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m14:53:52.422742 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:53:52.422946 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:52.423079 [debug] [MainThread]: On master: BEGIN
[0m14:53:52.423202 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:53:52.851609 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:53:52.852777 [debug] [MainThread]: On master: COMMIT
[0m14:53:52.853286 [debug] [MainThread]: Using postgres connection "master"
[0m14:53:52.853779 [debug] [MainThread]: On master: COMMIT
[0m14:53:52.897179 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:53:52.898085 [debug] [MainThread]: On master: Close
[0m14:53:52.900548 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:53:52.900988 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m14:53:52.901485 [info ] [MainThread]: 
[0m14:53:52.902167 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m14:53:52.902989 [debug] [MainThread]: Command end result
[0m14:53:52.914126 [info ] [MainThread]: 
[0m14:53:52.914761 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:53:52.915158 [info ] [MainThread]: 
[0m14:53:52.915529 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m14:53:52.915886 [error] [MainThread]:   syntax error at or near "{"
[0m14:53:52.916228 [error] [MainThread]:   LINE 27:         teams::json #>{'red'} as red,
[0m14:53:52.916559 [error] [MainThread]:                                  ^
[0m14:53:52.916882 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m14:53:52.917222 [info ] [MainThread]: 
[0m14:53:52.917583 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:53:52.918038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10970ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c1b20>]}
[0m14:53:52.918386 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 14:54:09.475205 | 69648a19-a2da-4fa5-af65-e550f72d6aa8 ==============================
[0m14:54:09.475205 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:54:09.476387 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:54:09.476490 [debug] [MainThread]: Tracking: tracking
[0m14:54:09.495752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105183400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104db4dc0>]}
[0m14:54:09.504766 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:54:09.541644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:54:09.541940 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m14:54:09.550168 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m14:54:09.560299 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m14:54:09.563259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '69648a19-a2da-4fa5-af65-e550f72d6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105722f40>]}
[0m14:54:09.576293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '69648a19-a2da-4fa5-af65-e550f72d6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105713190>]}
[0m14:54:09.576548 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:54:09.576726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69648a19-a2da-4fa5-af65-e550f72d6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1011c9e80>]}
[0m14:54:09.577351 [info ] [MainThread]: 
[0m14:54:09.578250 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:09.578782 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m14:54:09.586291 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m14:54:09.586617 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:54:09.586758 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:54:10.063661 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m14:54:10.067757 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m14:54:10.071239 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m14:54:10.083000 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:54:10.083468 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m14:54:10.083757 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:54:10.519850 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:54:10.520329 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:54:10.520614 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m14:54:10.570878 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m14:54:10.573575 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m14:54:10.619701 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m14:54:10.630968 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:10.631464 [debug] [MainThread]: On master: BEGIN
[0m14:54:10.631753 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:54:11.061751 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:54:11.062443 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:11.062940 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:54:11.123855 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m14:54:11.127168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '69648a19-a2da-4fa5-af65-e550f72d6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105740a60>]}
[0m14:54:11.127956 [debug] [MainThread]: On master: ROLLBACK
[0m14:54:11.174674 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:11.175395 [debug] [MainThread]: On master: BEGIN
[0m14:54:11.269412 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:54:11.270442 [debug] [MainThread]: On master: COMMIT
[0m14:54:11.271114 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:11.271810 [debug] [MainThread]: On master: COMMIT
[0m14:54:11.315544 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:54:11.316132 [debug] [MainThread]: On master: Close
[0m14:54:11.318003 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m14:54:11.318918 [info ] [MainThread]: 
[0m14:54:11.333199 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m14:54:11.334286 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m14:54:11.335748 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m14:54:11.336532 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m14:54:11.341824 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m14:54:11.346366 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-17 14:54:11.336980 => 2023-04-17 14:54:11.346205
[0m14:54:11.346798 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m14:54:11.387409 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m14:54:11.394244 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m14:54:11.394428 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m14:54:11.394536 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:54:11.834011 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:54:11.834892 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m14:54:11.835432 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::json #>'{red}' as red,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m14:54:11.896012 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m14:54:11.896963 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m14:54:11.942090 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-17 14:54:11.347091 => 2023-04-17 14:54:11.941846
[0m14:54:11.942803 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m14:54:11.990717 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m14:54:11.991707 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '69648a19-a2da-4fa5-af65-e550f72d6aa8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105765ee0>]}
[0m14:54:11.992601 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.66s]
[0m14:54:11.995435 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m14:54:11.999005 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:54:11.999460 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:11.999762 [debug] [MainThread]: On master: BEGIN
[0m14:54:12.000032 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:12.427591 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:54:12.428262 [debug] [MainThread]: On master: COMMIT
[0m14:54:12.428997 [debug] [MainThread]: Using postgres connection "master"
[0m14:54:12.429536 [debug] [MainThread]: On master: COMMIT
[0m14:54:12.473499 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:54:12.473773 [debug] [MainThread]: On master: Close
[0m14:54:12.474401 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:12.474531 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m14:54:12.474670 [info ] [MainThread]: 
[0m14:54:12.475011 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.90 seconds (2.90s).
[0m14:54:12.475285 [debug] [MainThread]: Command end result
[0m14:54:12.490975 [info ] [MainThread]: 
[0m14:54:12.491400 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:54:12.491649 [info ] [MainThread]: 
[0m14:54:12.491951 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m14:54:12.492481 [error] [MainThread]:   invalid input syntax for type json
[0m14:54:12.492887 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m14:54:12.493445 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m14:54:12.493996 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m14:54:12.494284 [info ] [MainThread]: 
[0m14:54:12.494684 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:54:12.494986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10580cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c6ac0>]}
[0m14:54:12.495334 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 14:56:30.279200 | 74ed1056-e5d5-4492-b691-5c8c4ad95dd0 ==============================
[0m14:56:30.279200 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:56:30.280291 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:56:30.280400 [debug] [MainThread]: Tracking: tracking
[0m14:56:30.293520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10897fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab50a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ab5a90>]}
[0m14:56:30.300769 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:56:30.330574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:56:30.330848 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m14:56:30.337945 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m14:56:30.346264 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m14:56:30.349131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74ed1056-e5d5-4492-b691-5c8c4ad95dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095259a0>]}
[0m14:56:30.359535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74ed1056-e5d5-4492-b691-5c8c4ad95dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109516220>]}
[0m14:56:30.359769 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:56:30.359932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74ed1056-e5d5-4492-b691-5c8c4ad95dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091738e0>]}
[0m14:56:30.360551 [info ] [MainThread]: 
[0m14:56:30.361544 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:56:30.362214 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m14:56:30.368473 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m14:56:30.368691 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:56:30.368826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:56:30.838370 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m14:56:30.841036 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m14:56:30.843731 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m14:56:30.853256 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:56:30.853621 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m14:56:30.853932 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:56:31.282394 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:56:31.283802 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:56:31.284528 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m14:56:31.336679 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m14:56:31.341562 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m14:56:31.388765 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m14:56:31.401289 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:31.401723 [debug] [MainThread]: On master: BEGIN
[0m14:56:31.402036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:56:31.832027 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:56:31.832975 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:31.833619 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:56:31.890914 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m14:56:31.895886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74ed1056-e5d5-4492-b691-5c8c4ad95dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109543a30>]}
[0m14:56:31.897120 [debug] [MainThread]: On master: ROLLBACK
[0m14:56:31.944029 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:31.944881 [debug] [MainThread]: On master: BEGIN
[0m14:56:32.033828 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:56:32.035207 [debug] [MainThread]: On master: COMMIT
[0m14:56:32.035936 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:32.036606 [debug] [MainThread]: On master: COMMIT
[0m14:56:32.080386 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:56:32.081440 [debug] [MainThread]: On master: Close
[0m14:56:32.083112 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m14:56:32.083625 [info ] [MainThread]: 
[0m14:56:32.094649 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m14:56:32.095316 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m14:56:32.096412 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m14:56:32.096775 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m14:56:32.100966 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m14:56:32.102472 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-17 14:56:32.097006 => 2023-04-17 14:56:32.102345
[0m14:56:32.102902 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m14:56:32.146149 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m14:56:32.147318 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m14:56:32.147462 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m14:56:32.147581 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:56:32.586092 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:56:32.587124 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m14:56:32.587670 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams::jsonb,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m14:56:32.649329 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m14:56:32.650491 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m14:56:32.697753 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-17 14:56:32.103144 => 2023-04-17 14:56:32.697404
[0m14:56:32.698805 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m14:56:32.737645 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m14:56:32.738260 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74ed1056-e5d5-4492-b691-5c8c4ad95dd0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10972ca90>]}
[0m14:56:32.738762 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.64s]
[0m14:56:32.740556 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m14:56:32.742624 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:56:32.742986 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:32.743235 [debug] [MainThread]: On master: BEGIN
[0m14:56:32.743458 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:56:33.175774 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:56:33.177157 [debug] [MainThread]: On master: COMMIT
[0m14:56:33.177806 [debug] [MainThread]: Using postgres connection "master"
[0m14:56:33.178457 [debug] [MainThread]: On master: COMMIT
[0m14:56:33.221583 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:56:33.222378 [debug] [MainThread]: On master: Close
[0m14:56:33.224724 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:56:33.225306 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m14:56:33.225955 [info ] [MainThread]: 
[0m14:56:33.226641 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m14:56:33.227469 [debug] [MainThread]: Command end result
[0m14:56:33.238976 [info ] [MainThread]: 
[0m14:56:33.239614 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:56:33.240021 [info ] [MainThread]: 
[0m14:56:33.240426 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m14:56:33.240785 [error] [MainThread]:   invalid input syntax for type json
[0m14:56:33.241120 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m14:56:33.241443 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m14:56:33.241759 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m14:56:33.242090 [info ] [MainThread]: 
[0m14:56:33.242442 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:56:33.242905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109702b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c7970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1095c7d60>]}
[0m14:56:33.243290 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 15:09:24.533364 | 820aa8db-949a-429c-8b5a-2718bc5ffae8 ==============================
[0m15:09:24.533364 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:09:24.534555 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:09:24.534703 [debug] [MainThread]: Tracking: tracking
[0m15:09:24.548115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077ab430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c0760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077a8d60>]}
[0m15:09:24.555529 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:09:24.585381 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:09:24.585659 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m15:09:24.592823 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m15:09:24.601225 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m15:09:24.604009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '820aa8db-949a-429c-8b5a-2718bc5ffae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c34fd0>]}
[0m15:09:24.616868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '820aa8db-949a-429c-8b5a-2718bc5ffae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c22190>]}
[0m15:09:24.617125 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:09:24.617293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '820aa8db-949a-429c-8b5a-2718bc5ffae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c0760>]}
[0m15:09:24.617924 [info ] [MainThread]: 
[0m15:09:24.618873 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:09:24.619428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m15:09:24.625772 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m15:09:24.625953 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:09:24.626073 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:25.115514 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m15:09:25.118944 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m15:09:25.122039 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m15:09:25.131182 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m15:09:25.131555 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m15:09:25.131866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:09:25.556589 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:09:25.557293 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m15:09:25.557678 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m15:09:25.607664 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m15:09:25.611622 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m15:09:25.656450 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m15:09:25.670545 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:25.671037 [debug] [MainThread]: On master: BEGIN
[0m15:09:25.671339 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:09:26.091468 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:09:26.092465 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:26.093081 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:09:26.149910 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m15:09:26.155182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '820aa8db-949a-429c-8b5a-2718bc5ffae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c50a30>]}
[0m15:09:26.156004 [debug] [MainThread]: On master: ROLLBACK
[0m15:09:26.202914 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:26.203909 [debug] [MainThread]: On master: BEGIN
[0m15:09:26.297797 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:09:26.299097 [debug] [MainThread]: On master: COMMIT
[0m15:09:26.299786 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:26.300429 [debug] [MainThread]: On master: COMMIT
[0m15:09:26.345589 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:09:26.346565 [debug] [MainThread]: On master: Close
[0m15:09:26.348829 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m15:09:26.349452 [info ] [MainThread]: 
[0m15:09:26.360079 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m15:09:26.360620 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m15:09:26.361364 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m15:09:26.361622 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m15:09:26.364673 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m15:09:26.368452 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-17 15:09:26.361794 => 2023-04-17 15:09:26.368339
[0m15:09:26.368782 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m15:09:26.400400 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m15:09:26.409319 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m15:09:26.409461 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m15:09:26.409565 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:09:26.844376 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:09:26.845504 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m15:09:26.845945 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        replace(teams,'"','')::json->'red' as red,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m15:09:26.906424 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type json
DETAIL:  Token "'" is invalid.
CONTEXT:  JSON data, line 1: {'...

[0m15:09:26.906925 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m15:09:26.958005 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-17 15:09:26.368940 => 2023-04-17 15:09:26.957526
[0m15:09:26.959324 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m15:09:27.000850 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  invalid input syntax for type json
  DETAIL:  Token "'" is invalid.
  CONTEXT:  JSON data, line 1: {'...
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m15:09:27.001422 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '820aa8db-949a-429c-8b5a-2718bc5ffae8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cecee0>]}
[0m15:09:27.001925 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.64s]
[0m15:09:27.003712 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m15:09:27.006045 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:09:27.006424 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:27.006679 [debug] [MainThread]: On master: BEGIN
[0m15:09:27.006909 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:09:27.444703 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:09:27.445751 [debug] [MainThread]: On master: COMMIT
[0m15:09:27.446409 [debug] [MainThread]: Using postgres connection "master"
[0m15:09:27.447053 [debug] [MainThread]: On master: COMMIT
[0m15:09:27.495141 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:09:27.497223 [debug] [MainThread]: On master: Close
[0m15:09:27.499807 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:09:27.501149 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m15:09:27.501667 [info ] [MainThread]: 
[0m15:09:27.502352 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m15:09:27.503194 [debug] [MainThread]: Command end result
[0m15:09:27.514412 [info ] [MainThread]: 
[0m15:09:27.514759 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:09:27.514957 [info ] [MainThread]: 
[0m15:09:27.515140 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m15:09:27.515316 [error] [MainThread]:   invalid input syntax for type json
[0m15:09:27.515480 [error] [MainThread]:   DETAIL:  Token "'" is invalid.
[0m15:09:27.515635 [error] [MainThread]:   CONTEXT:  JSON data, line 1: {'...
[0m15:09:27.515792 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m15:09:27.515953 [info ] [MainThread]: 
[0m15:09:27.516127 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:09:27.516365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd1b20>]}
[0m15:09:27.516561 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 15:12:43.590336 | 1ca9f0cb-0cc5-4438-a05e-efbb03cfc1a4 ==============================
[0m15:12:43.590336 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:12:43.592557 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:12:43.592725 [debug] [MainThread]: Tracking: tracking
[0m15:12:43.679178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107934790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107934dc0>]}
[0m15:12:43.691036 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:12:43.732065 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:12:43.732350 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m15:12:43.739680 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m15:12:43.748010 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m15:12:43.750827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ca9f0cb-0cc5-4438-a05e-efbb03cfc1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ba2f40>]}
[0m15:12:43.762330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ca9f0cb-0cc5-4438-a05e-efbb03cfc1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b93220>]}
[0m15:12:43.762568 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:12:43.762735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ca9f0cb-0cc5-4438-a05e-efbb03cfc1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b177c0>]}
[0m15:12:43.763347 [info ] [MainThread]: 
[0m15:12:43.764283 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:12:43.764853 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m15:12:43.771343 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m15:12:43.771543 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:12:43.771661 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:12:44.287958 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m15:12:44.291488 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m15:12:44.294970 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m15:12:44.305069 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m15:12:44.305550 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m15:12:44.305846 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:12:44.738139 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:12:44.739202 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m15:12:44.739703 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m15:12:44.789219 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m15:12:44.794232 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m15:12:44.837632 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m15:12:44.851315 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:44.851783 [debug] [MainThread]: On master: BEGIN
[0m15:12:44.852090 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:12:45.278163 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:12:45.278647 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:45.278932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:12:45.337918 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m15:12:45.342280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ca9f0cb-0cc5-4438-a05e-efbb03cfc1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bc3a30>]}
[0m15:12:45.343219 [debug] [MainThread]: On master: ROLLBACK
[0m15:12:45.388175 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:45.389049 [debug] [MainThread]: On master: BEGIN
[0m15:12:45.482124 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:12:45.482889 [debug] [MainThread]: On master: COMMIT
[0m15:12:45.483389 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:45.483831 [debug] [MainThread]: On master: COMMIT
[0m15:12:45.526988 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:12:45.527655 [debug] [MainThread]: On master: Close
[0m15:12:45.529185 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m15:12:45.529838 [info ] [MainThread]: 
[0m15:12:45.538917 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m15:12:45.539296 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m15:12:45.539793 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m15:12:45.539961 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m15:12:45.542017 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m15:12:45.543507 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-17 15:12:45.540076 => 2023-04-17 15:12:45.543356
[0m15:12:45.543923 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m15:12:45.573571 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m15:12:45.574989 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m15:12:45.575103 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m15:12:45.575198 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:12:45.993593 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:12:45.994552 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m15:12:45.995271 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        replace(replace(teams,"'{",""),"}'","")::json->'red' as red,

        -- replace(teams,'"','')::json->'red' as red,
        -- replace(teams::text, '''', '"')::json->'red' as red,
        -- teams::json -> 'red' as red,
        -- teams:red:has_won::varchar as red_has_won,
        -- teams:red:rounds_won::varchar as red_rounds_won,
        -- teams:red:rounds_lost::varchar as red_rounds_lost,
        -- teams:blue:has_won::varchar as blue_has_won,
        -- teams:blue:rounds_won::varchar as blue_rounds_won,
        -- teams:blue:rounds_lost::varchar as blue_rounds_lost,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m15:12:46.043269 [debug] [Thread-1  ]: Postgres adapter: Postgres error: zero-length delimited identifier at or near """"
LINE 27:         replace(replace(teams,"'{",""),"}'","")::json->'red'...
                                            ^

[0m15:12:46.044615 [debug] [Thread-1  ]: On model.warehouse.base_metadata: ROLLBACK
[0m15:12:46.092848 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-17 15:12:45.544166 => 2023-04-17 15:12:46.092462
[0m15:12:46.093865 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m15:12:46.134601 [debug] [Thread-1  ]: Database Error in model base_metadata (models/staging/base_metadata.sql)
  zero-length delimited identifier at or near """"
  LINE 27:         replace(replace(teams,"'{",""),"}'","")::json->'red'...
                                              ^
  compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m15:12:46.135204 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ca9f0cb-0cc5-4438-a05e-efbb03cfc1a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110dacac0>]}
[0m15:12:46.135714 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.base_metadata ................ [[31mERROR[0m in 0.60s]
[0m15:12:46.137525 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m15:12:46.139606 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:12:46.139959 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:46.140196 [debug] [MainThread]: On master: BEGIN
[0m15:12:46.140416 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:12:46.571905 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:12:46.573236 [debug] [MainThread]: On master: COMMIT
[0m15:12:46.573941 [debug] [MainThread]: Using postgres connection "master"
[0m15:12:46.574625 [debug] [MainThread]: On master: COMMIT
[0m15:12:46.622235 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:12:46.623367 [debug] [MainThread]: On master: Close
[0m15:12:46.625519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:46.625941 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m15:12:46.626397 [info ] [MainThread]: 
[0m15:12:46.626962 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m15:12:46.627625 [debug] [MainThread]: Command end result
[0m15:12:46.638697 [info ] [MainThread]: 
[0m15:12:46.639270 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:12:46.639653 [info ] [MainThread]: 
[0m15:12:46.640019 [error] [MainThread]: [33mDatabase Error in model base_metadata (models/staging/base_metadata.sql)[0m
[0m15:12:46.640375 [error] [MainThread]:   zero-length delimited identifier at or near """"
[0m15:12:46.640709 [error] [MainThread]:   LINE 27:         replace(replace(teams,"'{",""),"}'","")::json->'red'...
[0m15:12:46.641034 [error] [MainThread]:                                               ^
[0m15:12:46.641355 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/base_metadata.sql
[0m15:12:46.641681 [info ] [MainThread]: 
[0m15:12:46.641982 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:12:46.642365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d83eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d469a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d46d90>]}
[0m15:12:46.642671 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 15:55:53.733656 | 2f7e6f75-5995-4ed2-be2d-d4c8e5140eda ==============================
[0m15:55:53.733656 [info ] [MainThread]: Running with dbt=1.4.5
[0m15:55:53.735048 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['base_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:55:53.735207 [debug] [MainThread]: Tracking: tracking
[0m15:55:53.759881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106457430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106454d60>]}
[0m15:55:53.768478 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m15:55:53.808634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:55:53.808941 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/base_metadata.sql
[0m15:55:53.817326 [debug] [MainThread]: 1699: static parser successfully parsed staging/base_metadata.sql
[0m15:55:53.826934 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m15:55:53.830193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f7e6f75-5995-4ed2-be2d-d4c8e5140eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e0fd0>]}
[0m15:55:53.844348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f7e6f75-5995-4ed2-be2d-d4c8e5140eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068cd190>]}
[0m15:55:53.844585 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:55:53.844757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f7e6f75-5995-4ed2-be2d-d4c8e5140eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616c760>]}
[0m15:55:53.845442 [info ] [MainThread]: 
[0m15:55:53.846587 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:55:53.847478 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m15:55:53.854148 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m15:55:53.854414 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m15:55:53.854568 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:55:54.346047 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m15:55:54.348699 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m15:55:54.350413 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m15:55:54.357341 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m15:55:54.357675 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m15:55:54.357885 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:55:54.804201 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m15:55:54.805200 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m15:55:54.805564 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m15:55:54.859535 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m15:55:54.864827 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m15:55:54.912382 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m15:55:54.925905 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:54.926344 [debug] [MainThread]: On master: BEGIN
[0m15:55:54.926642 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:55:55.360397 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:55:55.361225 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:55.361594 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:55:55.419134 [debug] [MainThread]: SQL status: SELECT 5 in 0 seconds
[0m15:55:55.422109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f7e6f75-5995-4ed2-be2d-d4c8e5140eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ffa30>]}
[0m15:55:55.422995 [debug] [MainThread]: On master: ROLLBACK
[0m15:55:55.468210 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:55.469611 [debug] [MainThread]: On master: BEGIN
[0m15:55:55.562193 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:55:55.563161 [debug] [MainThread]: On master: COMMIT
[0m15:55:55.563519 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:55.563860 [debug] [MainThread]: On master: COMMIT
[0m15:55:55.608885 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:55:55.609553 [debug] [MainThread]: On master: Close
[0m15:55:55.611289 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m15:55:55.611906 [info ] [MainThread]: 
[0m15:55:55.621848 [debug] [Thread-1  ]: Began running node model.warehouse.base_metadata
[0m15:55:55.622461 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.base_metadata ......................... [RUN]
[0m15:55:55.623357 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.base_metadata'
[0m15:55:55.623685 [debug] [Thread-1  ]: Began compiling node model.warehouse.base_metadata
[0m15:55:55.627049 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.base_metadata"
[0m15:55:55.633700 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (compile): 2023-04-17 15:55:55.623881 => 2023-04-17 15:55:55.633541
[0m15:55:55.634041 [debug] [Thread-1  ]: Began executing node model.warehouse.base_metadata
[0m15:55:55.672650 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.base_metadata"
[0m15:55:55.679355 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m15:55:55.679568 [debug] [Thread-1  ]: On model.warehouse.base_metadata: BEGIN
[0m15:55:55.679699 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m15:55:56.102157 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m15:55:56.102447 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m15:55:56.102618 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."raw"."metadata"

),

updated as (

    select
        match_id,
        puuid,
        map,
        start_at,
        duration,
        mode,
        season_id,
        cluster,
        rounds_played,
        players_data,
        teams,
        _loaded_at
    from source

),

final as (

    select * from updated

)

select * from final
  );
  
[0m15:55:56.500687 [debug] [Thread-1  ]: SQL status: SELECT 374 in 0 seconds
[0m15:55:56.515755 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m15:55:56.516170 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */
alter table "DataWarehouse"."dev_staging"."base_metadata" rename to "base_metadata__dbt_backup"
[0m15:55:56.563148 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:55:56.570424 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m15:55:56.570778 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */
alter table "DataWarehouse"."dev_staging"."base_metadata__dbt_tmp" rename to "base_metadata"
[0m15:55:56.615669 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m15:55:56.652602 [debug] [Thread-1  ]: On model.warehouse.base_metadata: COMMIT
[0m15:55:56.652910 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m15:55:56.653091 [debug] [Thread-1  ]: On model.warehouse.base_metadata: COMMIT
[0m15:55:56.700358 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m15:55:56.708084 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.base_metadata"
[0m15:55:56.708362 [debug] [Thread-1  ]: On model.warehouse.base_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.base_metadata"} */
drop view if exists "DataWarehouse"."dev_staging"."base_metadata__dbt_backup" cascade
[0m15:55:56.758828 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0 seconds
[0m15:55:56.762287 [debug] [Thread-1  ]: Timing info for model.warehouse.base_metadata (execute): 2023-04-17 15:55:55.634196 => 2023-04-17 15:55:56.762172
[0m15:55:56.762778 [debug] [Thread-1  ]: On model.warehouse.base_metadata: Close
[0m15:55:56.764156 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f7e6f75-5995-4ed2-be2d-d4c8e5140eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106997ee0>]}
[0m15:55:56.764761 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_staging.base_metadata .................... [[32mSELECT 374[0m in 1.14s]
[0m15:55:56.766894 [debug] [Thread-1  ]: Finished running node model.warehouse.base_metadata
[0m15:55:56.769258 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:55:56.769626 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:56.769897 [debug] [MainThread]: On master: BEGIN
[0m15:55:56.770159 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:55:57.202965 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m15:55:57.204310 [debug] [MainThread]: On master: COMMIT
[0m15:55:57.204930 [debug] [MainThread]: Using postgres connection "master"
[0m15:55:57.205425 [debug] [MainThread]: On master: COMMIT
[0m15:55:57.252257 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m15:55:57.253194 [debug] [MainThread]: On master: Close
[0m15:55:57.255492 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:55:57.255976 [debug] [MainThread]: Connection 'model.warehouse.base_metadata' was properly closed.
[0m15:55:57.256512 [info ] [MainThread]: 
[0m15:55:57.257192 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m15:55:57.257995 [debug] [MainThread]: Command end result
[0m15:55:57.270210 [info ] [MainThread]: 
[0m15:55:57.270725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:55:57.271059 [info ] [MainThread]: 
[0m15:55:57.271373 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:55:57.271826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068fdd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ffa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10689ce80>]}
[0m15:55:57.272205 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 16:13:16.152668 | 2d4e77b6-621d-48b7-acff-e94a4dfa606a ==============================
[0m16:13:16.152668 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:13:16.153938 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:13:16.154084 [debug] [MainThread]: Tracking: tracking
[0m16:13:16.169872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187f94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187fa580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187fa310>]}
[0m16:13:16.178143 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:13:16.215405 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:13:16.215656 [debug] [MainThread]: Partial parsing: added file: warehouse://models/staging/stg_metadata.sql
[0m16:13:16.223187 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_metadata.sql
[0m16:13:16.232058 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:13:16.235072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d4e77b6-621d-48b7-acff-e94a4dfa606a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118da2f40>]}
[0m16:13:16.247837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d4e77b6-621d-48b7-acff-e94a4dfa606a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d94190>]}
[0m16:13:16.248091 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:13:16.248264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d4e77b6-621d-48b7-acff-e94a4dfa606a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187f94c0>]}
[0m16:13:16.248963 [info ] [MainThread]: 
[0m16:13:16.249908 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:13:16.250435 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:13:16.257357 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:13:16.257561 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:13:16.257688 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:13:16.756609 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m16:13:16.761439 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:13:16.764856 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:13:16.774384 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:13:16.774765 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:13:16.775088 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:13:17.209269 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:13:17.210303 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:13:17.210793 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:13:17.264873 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m16:13:17.268294 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:13:17.316678 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:13:17.329164 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:17.329600 [debug] [MainThread]: On master: BEGIN
[0m16:13:17.329897 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:13:17.763981 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:13:17.764432 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:17.764731 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:13:17.826066 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:13:17.828734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d4e77b6-621d-48b7-acff-e94a4dfa606a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d62cd0>]}
[0m16:13:17.829463 [debug] [MainThread]: On master: ROLLBACK
[0m16:13:17.878476 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:17.879178 [debug] [MainThread]: On master: BEGIN
[0m16:13:17.972207 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:13:17.972736 [debug] [MainThread]: On master: COMMIT
[0m16:13:17.973068 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:17.973348 [debug] [MainThread]: On master: COMMIT
[0m16:13:18.019901 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:13:18.020418 [debug] [MainThread]: On master: Close
[0m16:13:18.021568 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:13:18.022029 [info ] [MainThread]: 
[0m16:13:18.031771 [debug] [Thread-1  ]: Began running node model.warehouse.stg_metadata
[0m16:13:18.032506 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_metadata .......................... [RUN]
[0m16:13:18.033580 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_metadata'
[0m16:13:18.033891 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_metadata
[0m16:13:18.039100 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_metadata"
[0m16:13:18.042080 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (compile): 2023-04-17 16:13:18.034088 => 2023-04-17 16:13:18.041936
[0m16:13:18.042841 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_metadata
[0m16:13:18.087955 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_metadata"
[0m16:13:18.093385 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:13:18.093594 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: BEGIN
[0m16:13:18.093710 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:13:18.516450 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:13:18.517175 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:13:18.517586 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

teams_data_flattened as (

    select
        *,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data,
        case
            when 
                formatted_teams_data->red->>has_won::varchar = 'true'
            then 1
            else 0
        end as red_match_won,
        formatted_teams_data->red->>rounds_won as red_rounds_won,
        formatted_teams_data->red->>rounds_lost as red_rounds_lost,
        case
            when 
                formatted_teams_data->blue->>has_won::varchar = 'true'
            then 1
            else 0
        end as blue_match_won,
        formatted_teams_data->blue->>rounds_won as blue_rounds_won,
        formatted_teams_data->blue->>rounds_lost as blue_rounds_lost
    from source

)

select * from teams_data_flattened
  );
  
[0m16:13:18.563934 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "formatted_teams_data" does not exist
LINE 21:                 formatted_teams_data->red->>has_won::varchar...
                         ^

[0m16:13:18.564537 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: ROLLBACK
[0m16:13:18.607961 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (execute): 2023-04-17 16:13:18.043271 => 2023-04-17 16:13:18.607679
[0m16:13:18.608781 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: Close
[0m16:13:18.644506 [debug] [Thread-1  ]: Database Error in model stg_metadata (models/staging/stg_metadata.sql)
  column "formatted_teams_data" does not exist
  LINE 21:                 formatted_teams_data->red->>has_won::varchar...
                           ^
  compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:13:18.645059 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d4e77b6-621d-48b7-acff-e94a4dfa606a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118dee130>]}
[0m16:13:18.645553 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_metadata ................. [[31mERROR[0m in 0.61s]
[0m16:13:18.647156 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_metadata
[0m16:13:18.649227 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:13:18.649516 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:18.649718 [debug] [MainThread]: On master: BEGIN
[0m16:13:18.649909 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:13:19.071601 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:13:19.072245 [debug] [MainThread]: On master: COMMIT
[0m16:13:19.072690 [debug] [MainThread]: Using postgres connection "master"
[0m16:13:19.073120 [debug] [MainThread]: On master: COMMIT
[0m16:13:19.117173 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:13:19.118021 [debug] [MainThread]: On master: Close
[0m16:13:19.119710 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:13:19.120149 [debug] [MainThread]: Connection 'model.warehouse.stg_metadata' was properly closed.
[0m16:13:19.120596 [info ] [MainThread]: 
[0m16:13:19.121214 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.87 seconds (2.87s).
[0m16:13:19.122019 [debug] [MainThread]: Command end result
[0m16:13:19.129381 [info ] [MainThread]: 
[0m16:13:19.129976 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:13:19.130370 [info ] [MainThread]: 
[0m16:13:19.130742 [error] [MainThread]: [33mDatabase Error in model stg_metadata (models/staging/stg_metadata.sql)[0m
[0m16:13:19.131103 [error] [MainThread]:   column "formatted_teams_data" does not exist
[0m16:13:19.131435 [error] [MainThread]:   LINE 21:                 formatted_teams_data->red->>has_won::varchar...
[0m16:13:19.131757 [error] [MainThread]:                            ^
[0m16:13:19.132084 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:13:19.132416 [info ] [MainThread]: 
[0m16:13:19.132716 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:13:19.132904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e8dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e42a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e42ca0>]}
[0m16:13:19.133057 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 16:15:29.399455 | 07907c36-aabd-44f1-826c-d5d621cf1926 ==============================
[0m16:15:29.399455 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:15:29.400616 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:15:29.400728 [debug] [MainThread]: Tracking: tracking
[0m16:15:29.414785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ab0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079bb580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079bb310>]}
[0m16:15:29.422781 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:15:29.453642 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:29.453802 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:29.454142 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:15:29.457621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07907c36-aabd-44f1-826c-d5d621cf1926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e11fa0>]}
[0m16:15:29.469867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07907c36-aabd-44f1-826c-d5d621cf1926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd6970>]}
[0m16:15:29.470122 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:15:29.470298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07907c36-aabd-44f1-826c-d5d621cf1926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ab0a0>]}
[0m16:15:29.470992 [info ] [MainThread]: 
[0m16:15:29.472032 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:15:29.472582 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:15:29.478720 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:15:29.478980 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:15:29.479117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:29.953303 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m16:15:29.956442 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:15:29.959818 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:15:29.969858 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:15:29.970226 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:15:29.970525 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:30.406573 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:15:30.407699 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:15:30.408307 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:15:30.460893 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m16:15:30.465262 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:15:30.511877 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:15:30.525607 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:30.526042 [debug] [MainThread]: On master: BEGIN
[0m16:15:30.526338 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:30.947770 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:15:30.949008 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:30.949653 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:15:31.006751 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:15:31.011069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07907c36-aabd-44f1-826c-d5d621cf1926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8f880>]}
[0m16:15:31.012032 [debug] [MainThread]: On master: ROLLBACK
[0m16:15:31.056008 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:31.056945 [debug] [MainThread]: On master: BEGIN
[0m16:15:31.145185 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:15:31.146104 [debug] [MainThread]: On master: COMMIT
[0m16:15:31.146768 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:31.147486 [debug] [MainThread]: On master: COMMIT
[0m16:15:31.191017 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:15:31.192068 [debug] [MainThread]: On master: Close
[0m16:15:31.194343 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:15:31.195095 [info ] [MainThread]: 
[0m16:15:31.203110 [debug] [Thread-1  ]: Began running node model.warehouse.stg_metadata
[0m16:15:31.203550 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_metadata .......................... [RUN]
[0m16:15:31.204179 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_metadata'
[0m16:15:31.204394 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_metadata
[0m16:15:31.209308 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_metadata"
[0m16:15:31.210509 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (compile): 2023-04-17 16:15:31.204626 => 2023-04-17 16:15:31.210430
[0m16:15:31.210765 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_metadata
[0m16:15:31.251172 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_metadata"
[0m16:15:31.252694 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:15:31.252881 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: BEGIN
[0m16:15:31.253028 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:15:31.676003 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:15:31.676483 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:15:31.676795 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

teams_data_flattened as (

    select
        *,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data,
        case
            when 
                formatted_teams_data->red->>has_won::varchar = 'true'
            then 1
            else 0
        end as red_match_won,
        formatted_teams_data->red->>rounds_won as red_rounds_won,
        formatted_teams_data->red->>rounds_lost as red_rounds_lost,
        case
            when 
                formatted_teams_data->blue->>has_won::varchar = 'true'
            then 1
            else 0
        end as blue_match_won,
        formatted_teams_data->blue->>rounds_won as blue_rounds_won,
        formatted_teams_data->blue->>rounds_lost as blue_rounds_lost
    from source

)

select * from teams_data_flattened
  );
  
[0m16:15:31.722938 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "formatted_teams_data" does not exist
LINE 21:                 formatted_teams_data->red->>has_won::varchar...
                         ^

[0m16:15:31.723614 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: ROLLBACK
[0m16:15:31.768958 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (execute): 2023-04-17 16:15:31.210916 => 2023-04-17 16:15:31.768806
[0m16:15:31.769420 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: Close
[0m16:15:31.794914 [debug] [Thread-1  ]: Database Error in model stg_metadata (models/staging/stg_metadata.sql)
  column "formatted_teams_data" does not exist
  LINE 21:                 formatted_teams_data->red->>has_won::varchar...
                           ^
  compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:15:31.795190 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07907c36-aabd-44f1-826c-d5d621cf1926', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f45b0>]}
[0m16:15:31.795408 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_metadata ................. [[31mERROR[0m in 0.59s]
[0m16:15:31.796204 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_metadata
[0m16:15:31.797139 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:15:31.797298 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:31.797401 [debug] [MainThread]: On master: BEGIN
[0m16:15:31.797497 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:15:32.220013 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:15:32.221098 [debug] [MainThread]: On master: COMMIT
[0m16:15:32.221775 [debug] [MainThread]: Using postgres connection "master"
[0m16:15:32.222397 [debug] [MainThread]: On master: COMMIT
[0m16:15:32.265233 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:15:32.266085 [debug] [MainThread]: On master: Close
[0m16:15:32.267822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:15:32.268204 [debug] [MainThread]: Connection 'model.warehouse.stg_metadata' was properly closed.
[0m16:15:32.268640 [info ] [MainThread]: 
[0m16:15:32.269226 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m16:15:32.269846 [debug] [MainThread]: Command end result
[0m16:15:32.279145 [info ] [MainThread]: 
[0m16:15:32.279430 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:15:32.279597 [info ] [MainThread]: 
[0m16:15:32.279756 [error] [MainThread]: [33mDatabase Error in model stg_metadata (models/staging/stg_metadata.sql)[0m
[0m16:15:32.279908 [error] [MainThread]:   column "formatted_teams_data" does not exist
[0m16:15:32.280046 [error] [MainThread]:   LINE 21:                 formatted_teams_data->red->>has_won::varchar...
[0m16:15:32.280178 [error] [MainThread]:                            ^
[0m16:15:32.280309 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:15:32.280443 [info ] [MainThread]: 
[0m16:15:32.280586 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:15:32.280791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079ab0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea7220>]}
[0m16:15:32.280961 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 16:16:33.169087 | 2efc608d-ba4c-456f-81d9-1bf431e81cf7 ==============================
[0m16:16:33.169087 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:16:33.170555 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:16:33.170699 [debug] [MainThread]: Tracking: tracking
[0m16:16:33.187309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107767430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107764d60>]}
[0m16:16:33.195160 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:16:33.225612 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:16:33.225899 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_metadata.sql
[0m16:16:33.233115 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_metadata.sql
[0m16:16:33.241690 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:16:33.244597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2efc608d-ba4c-456f-81d9-1bf431e81cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c290d0>]}
[0m16:16:33.255188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2efc608d-ba4c-456f-81d9-1bf431e81cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be2190>]}
[0m16:16:33.255433 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:16:33.255599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2efc608d-ba4c-456f-81d9-1bf431e81cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747c760>]}
[0m16:16:33.256296 [info ] [MainThread]: 
[0m16:16:33.257292 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:16:33.257905 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:16:33.263912 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:16:33.264095 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:16:33.264223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:33.734371 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m16:16:33.737635 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:16:33.740461 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:16:33.750567 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:16:33.750974 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:16:33.751267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:34.179723 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:16:34.180826 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:16:34.181788 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:16:34.231164 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m16:16:34.235282 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:16:34.280363 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:16:34.290043 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:34.290420 [debug] [MainThread]: On master: BEGIN
[0m16:16:34.290649 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:16:34.731149 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:16:34.732012 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:34.732363 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:16:34.791723 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:16:34.794117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2efc608d-ba4c-456f-81d9-1bf431e81cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c3d6a0>]}
[0m16:16:34.794943 [debug] [MainThread]: On master: ROLLBACK
[0m16:16:34.841202 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:34.842102 [debug] [MainThread]: On master: BEGIN
[0m16:16:34.933529 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:16:34.934509 [debug] [MainThread]: On master: COMMIT
[0m16:16:34.935205 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:34.935806 [debug] [MainThread]: On master: COMMIT
[0m16:16:34.980399 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:16:34.981308 [debug] [MainThread]: On master: Close
[0m16:16:34.983365 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:16:34.984148 [info ] [MainThread]: 
[0m16:16:34.995933 [debug] [Thread-1  ]: Began running node model.warehouse.stg_metadata
[0m16:16:34.996657 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_metadata .......................... [RUN]
[0m16:16:34.997727 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_metadata'
[0m16:16:34.998272 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_metadata
[0m16:16:35.002397 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_metadata"
[0m16:16:35.004113 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (compile): 2023-04-17 16:16:34.998783 => 2023-04-17 16:16:35.003959
[0m16:16:35.004519 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_metadata
[0m16:16:35.045632 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_metadata"
[0m16:16:35.056682 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:16:35.056911 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: BEGIN
[0m16:16:35.057057 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:16:35.495413 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:16:35.496401 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:16:35.496882 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated_source as (

    select
        *,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data
    from source

),

teams_data_flattened as (

    select
        *
        case
            when 
                formatted_teams_data->red->>has_won::varchar = 'true'
            then 1
            else 0
        end as red_match_won,
        formatted_teams_data->red->>rounds_won as red_rounds_won,
        formatted_teams_data->red->>rounds_lost as red_rounds_lost,
        case
            when 
                formatted_teams_data->blue->>has_won::varchar = 'true'
            then 1
            else 0
        end as blue_match_won,
        formatted_teams_data->blue->>rounds_won as blue_rounds_won,
        formatted_teams_data->blue->>rounds_lost as blue_rounds_lost
    from updated_source

)

select * from teams_data_flattened
  );
  
[0m16:16:35.545486 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "case"
LINE 27:         case
                 ^

[0m16:16:35.546038 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: ROLLBACK
[0m16:16:35.592441 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (execute): 2023-04-17 16:16:35.004728 => 2023-04-17 16:16:35.592211
[0m16:16:35.593322 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: Close
[0m16:16:35.621369 [debug] [Thread-1  ]: Database Error in model stg_metadata (models/staging/stg_metadata.sql)
  syntax error at or near "case"
  LINE 27:         case
                   ^
  compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:16:35.621766 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2efc608d-ba4c-456f-81d9-1bf431e81cf7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10747ad00>]}
[0m16:16:35.622156 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_metadata ................. [[31mERROR[0m in 0.62s]
[0m16:16:35.623494 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_metadata
[0m16:16:35.625422 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:16:35.625701 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:35.625885 [debug] [MainThread]: On master: BEGIN
[0m16:16:35.626058 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:16:36.056546 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:16:36.057421 [debug] [MainThread]: On master: COMMIT
[0m16:16:36.058017 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:36.058587 [debug] [MainThread]: On master: COMMIT
[0m16:16:36.106513 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:16:36.107580 [debug] [MainThread]: On master: Close
[0m16:16:36.109618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:36.110027 [debug] [MainThread]: Connection 'model.warehouse.stg_metadata' was properly closed.
[0m16:16:36.110467 [info ] [MainThread]: 
[0m16:16:36.111103 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.85 seconds (2.85s).
[0m16:16:36.111829 [debug] [MainThread]: Command end result
[0m16:16:36.121268 [info ] [MainThread]: 
[0m16:16:36.121908 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:16:36.122337 [info ] [MainThread]: 
[0m16:16:36.122716 [error] [MainThread]: [33mDatabase Error in model stg_metadata (models/staging/stg_metadata.sql)[0m
[0m16:16:36.123070 [error] [MainThread]:   syntax error at or near "case"
[0m16:16:36.123405 [error] [MainThread]:   LINE 27:         case
[0m16:16:36.123732 [error] [MainThread]:                    ^
[0m16:16:36.124050 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:16:36.124377 [info ] [MainThread]: 
[0m16:16:36.124728 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:16:36.125165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd1160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107be2100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c8ff70>]}
[0m16:16:36.125532 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 16:16:42.677167 | 54ee76e3-45f1-43b5-b319-d495f21222e5 ==============================
[0m16:16:42.677167 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:16:42.678516 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:16:42.678652 [debug] [MainThread]: Tracking: tracking
[0m16:16:42.692989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638ec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d00a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d0a90>]}
[0m16:16:42.700460 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:16:42.730320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:16:42.730612 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_metadata.sql
[0m16:16:42.737862 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_metadata.sql
[0m16:16:42.746289 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:16:42.749087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54ee76e3-45f1-43b5-b319-d495f21222e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c600d0>]}
[0m16:16:42.761541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54ee76e3-45f1-43b5-b319-d495f21222e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c181c0>]}
[0m16:16:42.761809 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:16:42.761981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54ee76e3-45f1-43b5-b319-d495f21222e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c18100>]}
[0m16:16:42.762660 [info ] [MainThread]: 
[0m16:16:42.763619 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:16:42.764129 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:16:42.770077 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:16:42.770303 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:16:42.770440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:43.209630 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m16:16:43.210592 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:16:43.211650 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:16:43.215459 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:16:43.215765 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:16:43.215942 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:16:43.639074 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:16:43.639891 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:16:43.640579 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:16:43.690112 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m16:16:43.693953 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:16:43.740337 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:16:43.751538 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:43.751863 [debug] [MainThread]: On master: BEGIN
[0m16:16:43.752061 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:16:44.180637 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:16:44.181069 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:44.181330 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:16:44.241308 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:16:44.243277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54ee76e3-45f1-43b5-b319-d495f21222e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ac80d0>]}
[0m16:16:44.243813 [debug] [MainThread]: On master: ROLLBACK
[0m16:16:44.292699 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:44.293646 [debug] [MainThread]: On master: BEGIN
[0m16:16:44.388543 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:16:44.389436 [debug] [MainThread]: On master: COMMIT
[0m16:16:44.389920 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:44.390416 [debug] [MainThread]: On master: COMMIT
[0m16:16:44.437665 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:16:44.438718 [debug] [MainThread]: On master: Close
[0m16:16:44.441579 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:16:44.442538 [info ] [MainThread]: 
[0m16:16:44.451476 [debug] [Thread-1  ]: Began running node model.warehouse.stg_metadata
[0m16:16:44.451966 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_metadata .......................... [RUN]
[0m16:16:44.452714 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_metadata'
[0m16:16:44.452949 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_metadata
[0m16:16:44.456154 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_metadata"
[0m16:16:44.457453 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (compile): 2023-04-17 16:16:44.453115 => 2023-04-17 16:16:44.457325
[0m16:16:44.457800 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_metadata
[0m16:16:44.500314 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_metadata"
[0m16:16:44.501232 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:16:44.501391 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: BEGIN
[0m16:16:44.501523 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:16:44.945424 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:16:44.946065 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:16:44.946340 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated_source as (

    select
        *,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data
    from source

),

teams_data_flattened as (

    select
        *,
        case
            when 
                formatted_teams_data->red->>has_won::varchar = 'true'
            then 1
            else 0
        end as red_match_won,
        formatted_teams_data->red->>rounds_won as red_rounds_won,
        formatted_teams_data->red->>rounds_lost as red_rounds_lost,
        case
            when 
                formatted_teams_data->blue->>has_won::varchar = 'true'
            then 1
            else 0
        end as blue_match_won,
        formatted_teams_data->blue->>rounds_won as blue_rounds_won,
        formatted_teams_data->blue->>rounds_lost as blue_rounds_lost
    from updated_source

)

select * from teams_data_flattened
  );
  
[0m16:16:44.992899 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "red" does not exist
LINE 29:                 formatted_teams_data->red->>has_won::varchar...
                                               ^

[0m16:16:44.993418 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: ROLLBACK
[0m16:16:45.038492 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (execute): 2023-04-17 16:16:44.457978 => 2023-04-17 16:16:45.038321
[0m16:16:45.038975 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: Close
[0m16:16:45.060836 [debug] [Thread-1  ]: Database Error in model stg_metadata (models/staging/stg_metadata.sql)
  column "red" does not exist
  LINE 29:                 formatted_teams_data->red->>has_won::varchar...
                                                 ^
  compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:16:45.061116 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54ee76e3-45f1-43b5-b319-d495f21222e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066816d0>]}
[0m16:16:45.061371 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_metadata ................. [[31mERROR[0m in 0.61s]
[0m16:16:45.062322 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_metadata
[0m16:16:45.063599 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:16:45.063804 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:45.063907 [debug] [MainThread]: On master: BEGIN
[0m16:16:45.064010 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:16:45.498264 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:16:45.498688 [debug] [MainThread]: On master: COMMIT
[0m16:16:45.498846 [debug] [MainThread]: Using postgres connection "master"
[0m16:16:45.498964 [debug] [MainThread]: On master: COMMIT
[0m16:16:45.544114 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:16:45.544435 [debug] [MainThread]: On master: Close
[0m16:16:45.545319 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:45.545527 [debug] [MainThread]: Connection 'model.warehouse.stg_metadata' was properly closed.
[0m16:16:45.545696 [info ] [MainThread]: 
[0m16:16:45.546133 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.78 seconds (2.78s).
[0m16:16:45.546386 [debug] [MainThread]: Command end result
[0m16:16:45.554035 [info ] [MainThread]: 
[0m16:16:45.554368 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:16:45.554531 [info ] [MainThread]: 
[0m16:16:45.554685 [error] [MainThread]: [33mDatabase Error in model stg_metadata (models/staging/stg_metadata.sql)[0m
[0m16:16:45.554828 [error] [MainThread]:   column "red" does not exist
[0m16:16:45.554959 [error] [MainThread]:   LINE 29:                 formatted_teams_data->red->>has_won::varchar...
[0m16:16:45.555160 [error] [MainThread]:                                                  ^
[0m16:16:45.555340 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:16:45.555500 [info ] [MainThread]: 
[0m16:16:45.555686 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:16:45.555978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c793d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c79130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c791c0>]}
[0m16:16:45.556199 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 16:19:27.058145 | b7bab4c2-e13d-4bea-b974-3f6f364372d0 ==============================
[0m16:19:27.058145 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:19:27.059401 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:19:27.059509 [debug] [MainThread]: Tracking: tracking
[0m16:19:27.075448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042e90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042ea580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042ea310>]}
[0m16:19:27.083013 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:19:27.115499 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:19:27.115782 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_metadata.sql
[0m16:19:27.122909 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_metadata.sql
[0m16:19:27.131477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:19:27.134879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b7bab4c2-e13d-4bea-b974-3f6f364372d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047a90d0>]}
[0m16:19:27.145660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b7bab4c2-e13d-4bea-b974-3f6f364372d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104764160>]}
[0m16:19:27.145912 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:19:27.146128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7bab4c2-e13d-4bea-b974-3f6f364372d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042ea580>]}
[0m16:19:27.146795 [info ] [MainThread]: 
[0m16:19:27.147723 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:19:27.148256 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:19:27.154696 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:19:27.154926 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:19:27.155055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:27.659783 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:19:27.663407 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:19:27.666222 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:19:27.675371 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:19:27.675761 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:19:27.676067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:28.097347 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:19:28.097928 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:19:28.098226 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:19:28.148793 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m16:19:28.151249 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:19:28.195313 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:19:28.206872 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:28.207374 [debug] [MainThread]: On master: BEGIN
[0m16:19:28.207678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:28.625650 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:19:28.626087 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:28.626341 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:19:28.684647 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:19:28.686808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b7bab4c2-e13d-4bea-b974-3f6f364372d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047bc6a0>]}
[0m16:19:28.687439 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:28.733655 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:28.734200 [debug] [MainThread]: On master: BEGIN
[0m16:19:28.823274 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:19:28.823750 [debug] [MainThread]: On master: COMMIT
[0m16:19:28.824077 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:28.824354 [debug] [MainThread]: On master: COMMIT
[0m16:19:28.869688 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:19:28.870212 [debug] [MainThread]: On master: Close
[0m16:19:28.871240 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:19:28.871603 [info ] [MainThread]: 
[0m16:19:28.879173 [debug] [Thread-1  ]: Began running node model.warehouse.stg_metadata
[0m16:19:28.879745 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_metadata .......................... [RUN]
[0m16:19:28.880755 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_metadata'
[0m16:19:28.881037 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_metadata
[0m16:19:28.884142 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_metadata"
[0m16:19:28.886347 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (compile): 2023-04-17 16:19:28.881226 => 2023-04-17 16:19:28.886210
[0m16:19:28.886668 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_metadata
[0m16:19:28.924753 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_metadata"
[0m16:19:28.932842 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:19:28.933055 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: BEGIN
[0m16:19:28.933186 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:29.362109 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:19:29.365085 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:19:29.365630 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated_source as (

    select
        *,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data
    from source

),

-- teams_data_flattened as (

--     select
--         *,
--         case
--             when 
--                 formatted_teams_data->red->>has_won::varchar = 'true'
--             then 1
--             else 0
--         end as red_match_won,
--         formatted_teams_data->red->>rounds_won as red_rounds_won,
--         formatted_teams_data->red->>rounds_lost as red_rounds_lost,
--         case
--             when 
--                 formatted_teams_data->blue->>has_won::varchar = 'true'
--             then 1
--             else 0
--         end as blue_match_won,
--         formatted_teams_data->blue->>rounds_won as blue_rounds_won,
--         formatted_teams_data->blue->>rounds_lost as blue_rounds_lost
--     from updated_source

-- )

-- select * from teams_data_flattened

select * from updated_source
  );
  
[0m16:19:29.412947 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 49: select * from updated_source
         ^

[0m16:19:29.414001 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: ROLLBACK
[0m16:19:29.460240 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (execute): 2023-04-17 16:19:28.886826 => 2023-04-17 16:19:29.460102
[0m16:19:29.460679 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: Close
[0m16:19:29.494544 [debug] [Thread-1  ]: Database Error in model stg_metadata (models/staging/stg_metadata.sql)
  syntax error at or near "select"
  LINE 49: select * from updated_source
           ^
  compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:19:29.494980 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b7bab4c2-e13d-4bea-b974-3f6f364372d0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104791130>]}
[0m16:19:29.495501 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_metadata ................. [[31mERROR[0m in 0.61s]
[0m16:19:29.497118 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_metadata
[0m16:19:29.499875 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:19:29.500200 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:29.500413 [debug] [MainThread]: On master: BEGIN
[0m16:19:29.500594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:29.931052 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:19:29.932120 [debug] [MainThread]: On master: COMMIT
[0m16:19:29.932522 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:29.932891 [debug] [MainThread]: On master: COMMIT
[0m16:19:29.977859 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:19:29.979100 [debug] [MainThread]: On master: Close
[0m16:19:29.981108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:29.981608 [debug] [MainThread]: Connection 'model.warehouse.stg_metadata' was properly closed.
[0m16:19:29.982070 [info ] [MainThread]: 
[0m16:19:29.982744 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.83 seconds (2.83s).
[0m16:19:29.983555 [debug] [MainThread]: Command end result
[0m16:19:29.993482 [info ] [MainThread]: 
[0m16:19:29.994088 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:19:29.994482 [info ] [MainThread]: 
[0m16:19:29.994852 [error] [MainThread]: [33mDatabase Error in model stg_metadata (models/staging/stg_metadata.sql)[0m
[0m16:19:29.995200 [error] [MainThread]:   syntax error at or near "select"
[0m16:19:29.995529 [error] [MainThread]:   LINE 49: select * from updated_source
[0m16:19:29.995852 [error] [MainThread]:            ^
[0m16:19:29.996171 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:19:29.996498 [info ] [MainThread]: 
[0m16:19:29.996849 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:19:29.997320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104852160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10480ff40>]}
[0m16:19:29.997707 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 16:19:35.908111 | 6952f0bb-47c6-4312-9299-fc3aed2b6392 ==============================
[0m16:19:35.908111 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:19:35.909295 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:19:35.909408 [debug] [MainThread]: Tracking: tracking
[0m16:19:35.923486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105de6c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e280a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e28a90>]}
[0m16:19:35.930942 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:19:35.960768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:19:35.961058 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_metadata.sql
[0m16:19:35.968227 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_metadata.sql
[0m16:19:35.976673 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:19:35.979570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6952f0bb-47c6-4312-9299-fc3aed2b6392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b00d0>]}
[0m16:19:35.991735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6952f0bb-47c6-4312-9299-fc3aed2b6392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065661c0>]}
[0m16:19:35.992043 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:19:35.992222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6952f0bb-47c6-4312-9299-fc3aed2b6392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106566100>]}
[0m16:19:35.992944 [info ] [MainThread]: 
[0m16:19:35.993885 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:19:35.994427 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:19:36.001796 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:19:36.002005 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:19:36.002134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:36.437808 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m16:19:36.441965 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:19:36.445545 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:19:36.455401 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:19:36.455782 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:19:36.456087 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:36.891100 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:19:36.891753 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:19:36.892146 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:19:36.943677 [debug] [ThreadPool]: SQL status: SELECT 2 in 0 seconds
[0m16:19:36.944478 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:19:36.992390 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:19:36.996304 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:36.996500 [debug] [MainThread]: On master: BEGIN
[0m16:19:36.996613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:37.410516 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:19:37.410939 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:37.411204 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:19:37.469387 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:19:37.472973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6952f0bb-47c6-4312-9299-fc3aed2b6392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10651f100>]}
[0m16:19:37.473663 [debug] [MainThread]: On master: ROLLBACK
[0m16:19:37.518552 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:37.519337 [debug] [MainThread]: On master: BEGIN
[0m16:19:37.608687 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:19:37.609665 [debug] [MainThread]: On master: COMMIT
[0m16:19:37.610293 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:37.610650 [debug] [MainThread]: On master: COMMIT
[0m16:19:37.654340 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:19:37.655302 [debug] [MainThread]: On master: Close
[0m16:19:37.657395 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:19:37.658173 [info ] [MainThread]: 
[0m16:19:37.668260 [debug] [Thread-1  ]: Began running node model.warehouse.stg_metadata
[0m16:19:37.669067 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_metadata .......................... [RUN]
[0m16:19:37.670186 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_metadata'
[0m16:19:37.670578 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_metadata
[0m16:19:37.674720 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_metadata"
[0m16:19:37.676303 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (compile): 2023-04-17 16:19:37.670815 => 2023-04-17 16:19:37.676174
[0m16:19:37.676642 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_metadata
[0m16:19:37.718910 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_metadata"
[0m16:19:37.720114 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:19:37.720260 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: BEGIN
[0m16:19:37.720382 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:19:38.148773 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:19:38.149668 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:19:38.150211 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated_source as (

    select
        *,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data
    from source

)

-- teams_data_flattened as (

--     select
--         *,
--         case
--             when 
--                 formatted_teams_data->red->>has_won::varchar = 'true'
--             then 1
--             else 0
--         end as red_match_won,
--         formatted_teams_data->red->>rounds_won as red_rounds_won,
--         formatted_teams_data->red->>rounds_lost as red_rounds_lost,
--         case
--             when 
--                 formatted_teams_data->blue->>has_won::varchar = 'true'
--             then 1
--             else 0
--         end as blue_match_won,
--         formatted_teams_data->blue->>rounds_won as blue_rounds_won,
--         formatted_teams_data->blue->>rounds_lost as blue_rounds_lost
--     from updated_source

-- )

-- select * from teams_data_flattened

select * from updated_source
  );
  
[0m16:19:38.469868 [debug] [Thread-1  ]: SQL status: SELECT 374 in 0 seconds
[0m16:19:38.483456 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:19:38.483760 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */
alter table "DataWarehouse"."dev_staging"."stg_metadata__dbt_tmp" rename to "stg_metadata"
[0m16:19:38.527371 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:19:38.554296 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: COMMIT
[0m16:19:38.554546 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:19:38.554737 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: COMMIT
[0m16:19:38.603562 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:19:38.610762 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:19:38.611049 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */
drop table if exists "DataWarehouse"."dev_staging"."stg_metadata__dbt_backup" cascade
[0m16:19:38.656351 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m16:19:38.658929 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (execute): 2023-04-17 16:19:37.676837 => 2023-04-17 16:19:38.658797
[0m16:19:38.659413 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: Close
[0m16:19:38.660544 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6952f0bb-47c6-4312-9299-fc3aed2b6392', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10676a340>]}
[0m16:19:38.661075 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_staging.stg_metadata ..................... [[32mSELECT 374[0m in 0.99s]
[0m16:19:38.663116 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_metadata
[0m16:19:38.665180 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:19:38.665715 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:38.666051 [debug] [MainThread]: On master: BEGIN
[0m16:19:38.666310 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:39.095966 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:19:39.096366 [debug] [MainThread]: On master: COMMIT
[0m16:19:39.096641 [debug] [MainThread]: Using postgres connection "master"
[0m16:19:39.096920 [debug] [MainThread]: On master: COMMIT
[0m16:19:39.142796 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:19:39.143299 [debug] [MainThread]: On master: Close
[0m16:19:39.144413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:39.144689 [debug] [MainThread]: Connection 'model.warehouse.stg_metadata' was properly closed.
[0m16:19:39.144996 [info ] [MainThread]: 
[0m16:19:39.145412 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m16:19:39.145948 [debug] [MainThread]: Command end result
[0m16:19:39.161625 [info ] [MainThread]: 
[0m16:19:39.162227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:39.162577 [info ] [MainThread]: 
[0m16:19:39.162904 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:19:39.163340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10652d490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106781160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106790430>]}
[0m16:19:39.163714 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 16:21:55.752017 | afdd746c-05ea-4373-bdff-9b48f292c34e ==============================
[0m16:21:55.752017 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:21:55.753190 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:21:55.753315 [debug] [MainThread]: Tracking: tracking
[0m16:21:55.767125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fca400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d08790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d08dc0>]}
[0m16:21:55.774714 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:21:55.806640 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:21:55.806905 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_metadata.sql
[0m16:21:55.814055 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_metadata.sql
[0m16:21:55.822428 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:21:55.825330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afdd746c-05ea-4373-bdff-9b48f292c34e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848c0d0>]}
[0m16:21:55.839155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afdd746c-05ea-4373-bdff-9b48f292c34e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084471c0>]}
[0m16:21:55.839392 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:21:55.839562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afdd746c-05ea-4373-bdff-9b48f292c34e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108447100>]}
[0m16:21:55.840257 [info ] [MainThread]: 
[0m16:21:55.841151 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:21:55.841627 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:21:55.848016 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:21:55.848268 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:21:55.848396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:56.351166 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:21:56.354165 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:21:56.356772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:21:56.366679 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:21:56.367048 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:21:56.367338 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:56.796783 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:21:56.797576 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:21:56.797960 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:21:56.848735 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m16:21:56.852369 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:21:56.897686 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:21:56.908091 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:56.908386 [debug] [MainThread]: On master: BEGIN
[0m16:21:56.908554 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:57.328406 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:21:57.329856 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:57.330528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:21:57.391949 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:21:57.396674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afdd746c-05ea-4373-bdff-9b48f292c34e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce0640>]}
[0m16:21:57.397571 [debug] [MainThread]: On master: ROLLBACK
[0m16:21:57.444758 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:57.446033 [debug] [MainThread]: On master: BEGIN
[0m16:21:57.534206 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:21:57.534773 [debug] [MainThread]: On master: COMMIT
[0m16:21:57.535085 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:57.535365 [debug] [MainThread]: On master: COMMIT
[0m16:21:57.579841 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:21:57.580451 [debug] [MainThread]: On master: Close
[0m16:21:57.582545 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:21:57.583213 [info ] [MainThread]: 
[0m16:21:57.592658 [debug] [Thread-1  ]: Began running node model.warehouse.stg_metadata
[0m16:21:57.593318 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_metadata .......................... [RUN]
[0m16:21:57.594255 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_metadata'
[0m16:21:57.594557 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_metadata
[0m16:21:57.597678 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_metadata"
[0m16:21:57.599084 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (compile): 2023-04-17 16:21:57.594763 => 2023-04-17 16:21:57.598982
[0m16:21:57.599357 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_metadata
[0m16:21:57.641519 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_metadata"
[0m16:21:57.648868 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:21:57.649062 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: BEGIN
[0m16:21:57.649211 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:21:58.076572 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:21:58.077062 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:21:58.077335 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated_source as (

    select
        *,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data
    from source

)

teams_data_flattened as (

    select
        *,
        case
            when 
                formatted_teams_data->red->>has_won::varchar = 'true'
            then 1
            else 0
        end as red_match_won,
        formatted_teams_data->red->>rounds_won as red_rounds_won,
        formatted_teams_data->red->>rounds_lost as red_rounds_lost,
        case
            when 
                formatted_teams_data->blue->>has_won::varchar = 'true'
            then 1
            else 0
        end as blue_match_won,
        formatted_teams_data->blue->>rounds_won as blue_rounds_won,
        formatted_teams_data->blue->>rounds_lost as blue_rounds_lost
    from updated_source

)

select * from teams_data_flattened

-- select * from updated_source
  );
  
[0m16:21:58.123703 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "teams_data_flattened"
LINE 23: teams_data_flattened as (
         ^

[0m16:21:58.124232 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: ROLLBACK
[0m16:21:58.170303 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (execute): 2023-04-17 16:21:57.599498 => 2023-04-17 16:21:58.170139
[0m16:21:58.170811 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: Close
[0m16:21:58.193819 [debug] [Thread-1  ]: Database Error in model stg_metadata (models/staging/stg_metadata.sql)
  syntax error at or near "teams_data_flattened"
  LINE 23: teams_data_flattened as (
           ^
  compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:21:58.194141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afdd746c-05ea-4373-bdff-9b48f292c34e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083dda00>]}
[0m16:21:58.194392 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_metadata ................. [[31mERROR[0m in 0.60s]
[0m16:21:58.195288 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_metadata
[0m16:21:58.196437 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:21:58.196630 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:58.196747 [debug] [MainThread]: On master: BEGIN
[0m16:21:58.196856 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:21:58.632269 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:21:58.633205 [debug] [MainThread]: On master: COMMIT
[0m16:21:58.633845 [debug] [MainThread]: Using postgres connection "master"
[0m16:21:58.634440 [debug] [MainThread]: On master: COMMIT
[0m16:21:58.682415 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:21:58.683389 [debug] [MainThread]: On master: Close
[0m16:21:58.685292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:21:58.685757 [debug] [MainThread]: Connection 'model.warehouse.stg_metadata' was properly closed.
[0m16:21:58.686119 [info ] [MainThread]: 
[0m16:21:58.686620 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.85 seconds (2.85s).
[0m16:21:58.687299 [debug] [MainThread]: Command end result
[0m16:21:58.694310 [info ] [MainThread]: 
[0m16:21:58.694619 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:21:58.694780 [info ] [MainThread]: 
[0m16:21:58.694938 [error] [MainThread]: [33mDatabase Error in model stg_metadata (models/staging/stg_metadata.sql)[0m
[0m16:21:58.695082 [error] [MainThread]:   syntax error at or near "teams_data_flattened"
[0m16:21:58.695220 [error] [MainThread]:   LINE 23: teams_data_flattened as (
[0m16:21:58.695355 [error] [MainThread]:            ^
[0m16:21:58.695487 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:21:58.695623 [info ] [MainThread]: 
[0m16:21:58.695771 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:21:58.695992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085321c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce08b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084f2cd0>]}
[0m16:21:58.696215 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 16:22:09.518116 | 4bda1149-f441-4157-9e21-22138adfd31d ==============================
[0m16:22:09.518116 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:22:09.519841 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:22:09.519964 [debug] [MainThread]: Tracking: tracking
[0m16:22:09.541445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fb94c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fba580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fba310>]}
[0m16:22:09.549697 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:22:09.584563 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:22:09.584873 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_metadata.sql
[0m16:22:09.592383 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_metadata.sql
[0m16:22:09.601239 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:22:09.604300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bda1149-f441-4157-9e21-22138adfd31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a10d0>]}
[0m16:22:09.616463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4bda1149-f441-4157-9e21-22138adfd31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104556160>]}
[0m16:22:09.616699 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:22:09.616868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bda1149-f441-4157-9e21-22138adfd31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fba580>]}
[0m16:22:09.617509 [info ] [MainThread]: 
[0m16:22:09.618445 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:22:09.618974 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:22:09.625485 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:22:09.625745 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:22:09.625896 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:22:10.069778 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m16:22:10.073035 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:22:10.075417 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:22:10.079658 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:22:10.079870 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:22:10.079984 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:22:10.509354 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:22:10.510342 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:22:10.510755 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:22:10.560028 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m16:22:10.562650 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:22:10.608666 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:22:10.618098 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:10.618335 [debug] [MainThread]: On master: BEGIN
[0m16:22:10.618471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:22:11.043557 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:22:11.044274 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:11.044742 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:22:11.104135 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:22:11.105603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bda1149-f441-4157-9e21-22138adfd31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10451c9a0>]}
[0m16:22:11.106071 [debug] [MainThread]: On master: ROLLBACK
[0m16:22:11.148694 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:11.148950 [debug] [MainThread]: On master: BEGIN
[0m16:22:11.238019 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:22:11.238393 [debug] [MainThread]: On master: COMMIT
[0m16:22:11.238590 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:11.238751 [debug] [MainThread]: On master: COMMIT
[0m16:22:11.284041 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:22:11.284384 [debug] [MainThread]: On master: Close
[0m16:22:11.285240 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:22:11.285979 [info ] [MainThread]: 
[0m16:22:11.294096 [debug] [Thread-1  ]: Began running node model.warehouse.stg_metadata
[0m16:22:11.294948 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_metadata .......................... [RUN]
[0m16:22:11.296149 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_metadata'
[0m16:22:11.296441 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_metadata
[0m16:22:11.299442 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_metadata"
[0m16:22:11.300426 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (compile): 2023-04-17 16:22:11.296614 => 2023-04-17 16:22:11.300317
[0m16:22:11.300694 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_metadata
[0m16:22:11.333141 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_metadata"
[0m16:22:11.334055 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:22:11.334173 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: BEGIN
[0m16:22:11.334272 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:22:11.755364 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:22:11.755948 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:22:11.756314 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated_source as (

    select
        *,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data
    from source

),

teams_data_flattened as (

    select
        *,
        case
            when 
                formatted_teams_data->red->>has_won::varchar = 'true'
            then 1
            else 0
        end as red_match_won,
        formatted_teams_data->red->>rounds_won as red_rounds_won,
        formatted_teams_data->red->>rounds_lost as red_rounds_lost,
        case
            when 
                formatted_teams_data->blue->>has_won::varchar = 'true'
            then 1
            else 0
        end as blue_match_won,
        formatted_teams_data->blue->>rounds_won as blue_rounds_won,
        formatted_teams_data->blue->>rounds_lost as blue_rounds_lost
    from updated_source

)

select * from teams_data_flattened

-- select * from updated_source
  );
  
[0m16:22:11.803087 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "red" does not exist
LINE 29:                 formatted_teams_data->red->>has_won::varchar...
                                               ^

[0m16:22:11.803708 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: ROLLBACK
[0m16:22:11.846005 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (execute): 2023-04-17 16:22:11.300876 => 2023-04-17 16:22:11.845905
[0m16:22:11.846333 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: Close
[0m16:22:11.876210 [debug] [Thread-1  ]: Database Error in model stg_metadata (models/staging/stg_metadata.sql)
  column "red" does not exist
  LINE 29:                 formatted_teams_data->red->>has_won::varchar...
                                                 ^
  compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:22:11.876670 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4bda1149-f441-4157-9e21-22138adfd31d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104594c70>]}
[0m16:22:11.877102 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_metadata ................. [[31mERROR[0m in 0.58s]
[0m16:22:11.878888 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_metadata
[0m16:22:11.881145 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:22:11.881430 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:11.881606 [debug] [MainThread]: On master: BEGIN
[0m16:22:11.881773 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:22:12.301142 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:22:12.301913 [debug] [MainThread]: On master: COMMIT
[0m16:22:12.302397 [debug] [MainThread]: Using postgres connection "master"
[0m16:22:12.302856 [debug] [MainThread]: On master: COMMIT
[0m16:22:12.347046 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:22:12.347888 [debug] [MainThread]: On master: Close
[0m16:22:12.350170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:12.350684 [debug] [MainThread]: Connection 'model.warehouse.stg_metadata' was properly closed.
[0m16:22:12.351225 [info ] [MainThread]: 
[0m16:22:12.351946 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.73 seconds (2.73s).
[0m16:22:12.352794 [debug] [MainThread]: Command end result
[0m16:22:12.377743 [info ] [MainThread]: 
[0m16:22:12.378515 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:22:12.379023 [info ] [MainThread]: 
[0m16:22:12.379493 [error] [MainThread]: [33mDatabase Error in model stg_metadata (models/staging/stg_metadata.sql)[0m
[0m16:22:12.379937 [error] [MainThread]:   column "red" does not exist
[0m16:22:12.380373 [error] [MainThread]:   LINE 29:                 formatted_teams_data->red->>has_won::varchar...
[0m16:22:12.380789 [error] [MainThread]:                                                  ^
[0m16:22:12.381198 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:22:12.381619 [info ] [MainThread]: 
[0m16:22:12.381991 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:22:12.382429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046461c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104602fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104602d00>]}
[0m16:22:12.382799 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 16:23:52.580568 | afc0f9fb-35fa-49a1-ad2c-8c9533d5dd9c ==============================
[0m16:23:52.580568 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:23:52.581660 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:23:52.581769 [debug] [MainThread]: Tracking: tracking
[0m16:23:52.595951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c030a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0e310>]}
[0m16:23:52.603520 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:23:52.636396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:23:52.636681 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_metadata.sql
[0m16:23:52.643848 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_metadata.sql
[0m16:23:52.652210 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:23:52.655074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afc0f9fb-35fa-49a1-ad2c-8c9533d5dd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080cd0d0>]}
[0m16:23:52.665497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afc0f9fb-35fa-49a1-ad2c-8c9533d5dd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108086160>]}
[0m16:23:52.665727 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:23:52.665890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afc0f9fb-35fa-49a1-ad2c-8c9533d5dd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c0e580>]}
[0m16:23:52.666525 [info ] [MainThread]: 
[0m16:23:52.667427 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:23:52.667931 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:23:52.674241 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:23:52.674474 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:23:52.674610 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:53.211723 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:23:53.217514 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:23:53.222266 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:23:53.233816 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:23:53.234286 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:23:53.234598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:23:53.661122 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:23:53.662063 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:23:53.662695 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:23:53.712220 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m16:23:53.715141 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:23:53.758421 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:23:53.772427 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:53.772950 [debug] [MainThread]: On master: BEGIN
[0m16:23:53.773267 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:23:54.210949 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:23:54.212014 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:54.212964 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:23:54.274755 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:23:54.278734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afc0f9fb-35fa-49a1-ad2c-8c9533d5dd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10804d9a0>]}
[0m16:23:54.279558 [debug] [MainThread]: On master: ROLLBACK
[0m16:23:54.325109 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:54.326080 [debug] [MainThread]: On master: BEGIN
[0m16:23:54.415937 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:23:54.417187 [debug] [MainThread]: On master: COMMIT
[0m16:23:54.417689 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:54.418184 [debug] [MainThread]: On master: COMMIT
[0m16:23:54.464576 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:23:54.465870 [debug] [MainThread]: On master: Close
[0m16:23:54.468596 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:23:54.469475 [info ] [MainThread]: 
[0m16:23:54.481501 [debug] [Thread-1  ]: Began running node model.warehouse.stg_metadata
[0m16:23:54.482215 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_metadata .......................... [RUN]
[0m16:23:54.483299 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_metadata'
[0m16:23:54.483687 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_metadata
[0m16:23:54.487776 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_metadata"
[0m16:23:54.489337 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (compile): 2023-04-17 16:23:54.483921 => 2023-04-17 16:23:54.489233
[0m16:23:54.489698 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_metadata
[0m16:23:54.531755 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_metadata"
[0m16:23:54.539457 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:23:54.539617 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: BEGIN
[0m16:23:54.539751 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:23:54.964699 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:23:54.965489 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:23:54.966199 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated_source as (

    select
        *,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data
    from source

),

teams_data_flattened as (

    select
        *,
        case
            when 
                formatted_teams_data->'red'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as red_match_won,
        formatted_teams_data->'red'->>'rounds_won' as red_rounds_won,
        formatted_teams_data->'red'->>'rounds_lost' as red_rounds_lost,
        case
            when 
                formatted_teams_data->'blue'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as blue_match_won,
        formatted_teams_data->'blue'->>'rounds_won' as blue_rounds_won,
        formatted_teams_data->'blue'->>'rounds_lost' as blue_rounds_lost
    from updated_source

)

select * from teams_data_flattened

-- select * from updated_source
  );
  
[0m16:23:55.090908 [debug] [Thread-1  ]: SQL status: SELECT 374 in 0 seconds
[0m16:23:55.104108 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:23:55.104511 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */
alter table "DataWarehouse"."dev_staging"."stg_metadata" rename to "stg_metadata__dbt_backup"
[0m16:23:55.149364 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:23:55.155499 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:23:55.155883 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */
alter table "DataWarehouse"."dev_staging"."stg_metadata__dbt_tmp" rename to "stg_metadata"
[0m16:23:55.202693 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:23:55.234597 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: COMMIT
[0m16:23:55.234889 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:23:55.235082 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: COMMIT
[0m16:23:55.285069 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:23:55.289659 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:23:55.289842 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */
drop table if exists "DataWarehouse"."dev_staging"."stg_metadata__dbt_backup" cascade
[0m16:23:55.341886 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m16:23:55.345381 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (execute): 2023-04-17 16:23:54.489923 => 2023-04-17 16:23:55.345248
[0m16:23:55.345903 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: Close
[0m16:23:55.347624 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afc0f9fb-35fa-49a1-ad2c-8c9533d5dd9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108157550>]}
[0m16:23:55.348435 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_staging.stg_metadata ..................... [[32mSELECT 374[0m in 0.86s]
[0m16:23:55.350916 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_metadata
[0m16:23:55.353867 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:23:55.354323 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:55.354622 [debug] [MainThread]: On master: BEGIN
[0m16:23:55.354897 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:23:55.780004 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:23:55.781139 [debug] [MainThread]: On master: COMMIT
[0m16:23:55.781617 [debug] [MainThread]: Using postgres connection "master"
[0m16:23:55.782086 [debug] [MainThread]: On master: COMMIT
[0m16:23:55.825890 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:23:55.826474 [debug] [MainThread]: On master: Close
[0m16:23:55.827774 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:55.828110 [debug] [MainThread]: Connection 'model.warehouse.stg_metadata' was properly closed.
[0m16:23:55.828429 [info ] [MainThread]: 
[0m16:23:55.829211 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.16 seconds (3.16s).
[0m16:23:55.830046 [debug] [MainThread]: Command end result
[0m16:23:55.840625 [info ] [MainThread]: 
[0m16:23:55.841249 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:23:55.841670 [info ] [MainThread]: 
[0m16:23:55.842058 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:23:55.842521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791f2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10804dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10804d6d0>]}
[0m16:23:55.842901 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 16:24:23.902493 | 1826f9ec-89d5-48c2-94a6-aa9c0c1a5d55 ==============================
[0m16:24:23.902493 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:24:23.903738 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:24:23.903850 [debug] [MainThread]: Tracking: tracking
[0m16:24:23.918098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043090a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10430a580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10430a310>]}
[0m16:24:23.925601 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:24:23.957318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:24:23.957617 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_metadata.sql
[0m16:24:23.965122 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_metadata.sql
[0m16:24:23.974460 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:24:23.977565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1826f9ec-89d5-48c2-94a6-aa9c0c1a5d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047c90d0>]}
[0m16:24:23.994789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1826f9ec-89d5-48c2-94a6-aa9c0c1a5d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104782160>]}
[0m16:24:23.995157 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:24:23.995344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1826f9ec-89d5-48c2-94a6-aa9c0c1a5d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10430a580>]}
[0m16:24:23.996131 [info ] [MainThread]: 
[0m16:24:23.997217 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:24:23.997772 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:24:24.004067 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:24:24.004264 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:24:24.004387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:24:24.453775 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m16:24:24.455765 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:24:24.457736 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:24:24.464362 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:24:24.464673 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:24:24.464891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:24:24.898765 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:24:24.898992 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:24:24.899110 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:24:24.952037 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m16:24:24.952923 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:24:25.000526 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:24:25.005452 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:25.005707 [debug] [MainThread]: On master: BEGIN
[0m16:24:25.005869 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:24:25.421439 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:24:25.421925 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:25.422226 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:24:25.481280 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:24:25.483981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1826f9ec-89d5-48c2-94a6-aa9c0c1a5d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047489a0>]}
[0m16:24:25.484637 [debug] [MainThread]: On master: ROLLBACK
[0m16:24:25.531068 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:25.531656 [debug] [MainThread]: On master: BEGIN
[0m16:24:25.622642 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:24:25.623796 [debug] [MainThread]: On master: COMMIT
[0m16:24:25.624394 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:25.624838 [debug] [MainThread]: On master: COMMIT
[0m16:24:25.670291 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:24:25.671307 [debug] [MainThread]: On master: Close
[0m16:24:25.673397 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:24:25.674115 [info ] [MainThread]: 
[0m16:24:25.684128 [debug] [Thread-1  ]: Began running node model.warehouse.stg_metadata
[0m16:24:25.684836 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_metadata .......................... [RUN]
[0m16:24:25.685874 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_metadata'
[0m16:24:25.686239 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_metadata
[0m16:24:25.690270 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_metadata"
[0m16:24:25.691855 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (compile): 2023-04-17 16:24:25.686490 => 2023-04-17 16:24:25.691708
[0m16:24:25.692290 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_metadata
[0m16:24:25.734643 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_metadata"
[0m16:24:25.736084 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:24:25.736242 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: BEGIN
[0m16:24:25.736372 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:24:26.165326 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:24:26.166204 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:24:26.166753 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

teams_data_flattened as (

    select
        *,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data,
        case
            when 
                formatted_teams_data->'red'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as red_match_won,
        formatted_teams_data->'red'->>'rounds_won' as red_rounds_won,
        formatted_teams_data->'red'->>'rounds_lost' as red_rounds_lost,
        case
            when 
                formatted_teams_data->'blue'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as blue_match_won,
        formatted_teams_data->'blue'->>'rounds_won' as blue_rounds_won,
        formatted_teams_data->'blue'->>'rounds_lost' as blue_rounds_lost
    from source

)

select * from teams_data_flattened
  );
  
[0m16:24:26.217650 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "formatted_teams_data" does not exist
LINE 21:                 formatted_teams_data->'red'->>'has_won'::var...
                         ^

[0m16:24:26.218977 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: ROLLBACK
[0m16:24:26.265738 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (execute): 2023-04-17 16:24:25.692535 => 2023-04-17 16:24:26.265504
[0m16:24:26.266314 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: Close
[0m16:24:26.299810 [debug] [Thread-1  ]: Database Error in model stg_metadata (models/staging/stg_metadata.sql)
  column "formatted_teams_data" does not exist
  LINE 21:                 formatted_teams_data->'red'->>'has_won'::var...
                           ^
  compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:24:26.300322 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1826f9ec-89d5-48c2-94a6-aa9c0c1a5d55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047bfa30>]}
[0m16:24:26.300806 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_metadata ................. [[31mERROR[0m in 0.61s]
[0m16:24:26.302580 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_metadata
[0m16:24:26.304630 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:24:26.304956 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:26.305192 [debug] [MainThread]: On master: BEGIN
[0m16:24:26.305414 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:24:26.740752 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:24:26.742087 [debug] [MainThread]: On master: COMMIT
[0m16:24:26.742786 [debug] [MainThread]: Using postgres connection "master"
[0m16:24:26.743397 [debug] [MainThread]: On master: COMMIT
[0m16:24:26.790915 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:24:26.791865 [debug] [MainThread]: On master: Close
[0m16:24:26.793674 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:24:26.794024 [debug] [MainThread]: Connection 'model.warehouse.stg_metadata' was properly closed.
[0m16:24:26.794346 [info ] [MainThread]: 
[0m16:24:26.794780 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m16:24:26.795320 [debug] [MainThread]: Command end result
[0m16:24:26.809190 [info ] [MainThread]: 
[0m16:24:26.809850 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:24:26.810266 [info ] [MainThread]: 
[0m16:24:26.810650 [error] [MainThread]: [33mDatabase Error in model stg_metadata (models/staging/stg_metadata.sql)[0m
[0m16:24:26.811004 [error] [MainThread]:   column "formatted_teams_data" does not exist
[0m16:24:26.811316 [error] [MainThread]:   LINE 21:                 formatted_teams_data->'red'->>'has_won'::var...
[0m16:24:26.811579 [error] [MainThread]:                            ^
[0m16:24:26.811840 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:24:26.812113 [info ] [MainThread]: 
[0m16:24:26.812402 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:24:26.812778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10486e1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10482dfa0>]}
[0m16:24:26.813105 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 16:25:03.070466 | 929ebb84-9c94-42a9-83f8-71e24dec0def ==============================
[0m16:25:03.070466 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:25:03.071895 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:25:03.072020 [debug] [MainThread]: Tracking: tracking
[0m16:25:03.086796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a12a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a12af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1a3d0>]}
[0m16:25:03.093992 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:25:03.125207 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:25:03.125378 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:25:03.125702 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:25:03.129205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '929ebb84-9c94-42a9-83f8-71e24dec0def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106171ee0>]}
[0m16:25:03.139299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '929ebb84-9c94-42a9-83f8-71e24dec0def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061378b0>]}
[0m16:25:03.139549 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:25:03.139723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '929ebb84-9c94-42a9-83f8-71e24dec0def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102899e50>]}
[0m16:25:03.140376 [info ] [MainThread]: 
[0m16:25:03.141291 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:25:03.141829 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:25:03.148351 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:25:03.148572 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:25:03.148703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:03.642685 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m16:25:03.647271 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:25:03.650944 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:25:03.659762 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:25:03.660150 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:25:03.660457 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:04.088077 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:25:04.089042 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:25:04.089688 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:25:04.139049 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m16:25:04.143334 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:25:04.186504 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:25:04.200770 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:04.201238 [debug] [MainThread]: On master: BEGIN
[0m16:25:04.201563 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:04.650928 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:25:04.651982 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:04.652578 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:25:05.217687 [debug] [MainThread]: SQL status: SELECT 4 in 1 seconds
[0m16:25:05.219973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '929ebb84-9c94-42a9-83f8-71e24dec0def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062307c0>]}
[0m16:25:05.220624 [debug] [MainThread]: On master: ROLLBACK
[0m16:25:05.268014 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:05.268600 [debug] [MainThread]: On master: BEGIN
[0m16:25:05.362446 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:25:05.363040 [debug] [MainThread]: On master: COMMIT
[0m16:25:05.363380 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:05.363698 [debug] [MainThread]: On master: COMMIT
[0m16:25:05.411268 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:25:05.412115 [debug] [MainThread]: On master: Close
[0m16:25:05.414271 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:25:05.414943 [info ] [MainThread]: 
[0m16:25:05.426074 [debug] [Thread-1  ]: Began running node model.warehouse.stg_metadata
[0m16:25:05.426835 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_metadata .......................... [RUN]
[0m16:25:05.427914 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_metadata'
[0m16:25:05.428378 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_metadata
[0m16:25:05.433731 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_metadata"
[0m16:25:05.435166 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (compile): 2023-04-17 16:25:05.428746 => 2023-04-17 16:25:05.435050
[0m16:25:05.435509 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_metadata
[0m16:25:05.476927 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_metadata"
[0m16:25:05.484867 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:25:05.485035 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: BEGIN
[0m16:25:05.485167 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:25:05.909711 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:25:05.910652 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:25:05.910949 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

teams_data_flattened as (

    select
        *,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data,
        case
            when 
                formatted_teams_data->'red'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as red_match_won,
        formatted_teams_data->'red'->>'rounds_won' as red_rounds_won,
        formatted_teams_data->'red'->>'rounds_lost' as red_rounds_lost,
        case
            when 
                formatted_teams_data->'blue'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as blue_match_won,
        formatted_teams_data->'blue'->>'rounds_won' as blue_rounds_won,
        formatted_teams_data->'blue'->>'rounds_lost' as blue_rounds_lost
    from source

)

select * from teams_data_flattened
  );
  
[0m16:25:05.960601 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "formatted_teams_data" does not exist
LINE 21:                 formatted_teams_data->'red'->>'has_won'::var...
                         ^

[0m16:25:05.961530 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: ROLLBACK
[0m16:25:06.007834 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (execute): 2023-04-17 16:25:05.435731 => 2023-04-17 16:25:06.007487
[0m16:25:06.008742 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: Close
[0m16:25:06.049009 [debug] [Thread-1  ]: Database Error in model stg_metadata (models/staging/stg_metadata.sql)
  column "formatted_teams_data" does not exist
  LINE 21:                 formatted_teams_data->'red'->>'has_won'::var...
                           ^
  compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:25:06.049569 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '929ebb84-9c94-42a9-83f8-71e24dec0def', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f8550>]}
[0m16:25:06.050313 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_metadata ................. [[31mERROR[0m in 0.62s]
[0m16:25:06.051736 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_metadata
[0m16:25:06.053846 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:25:06.054158 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:06.054346 [debug] [MainThread]: On master: BEGIN
[0m16:25:06.054575 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:25:06.489776 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:25:06.491168 [debug] [MainThread]: On master: COMMIT
[0m16:25:06.491651 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:06.492167 [debug] [MainThread]: On master: COMMIT
[0m16:25:06.537487 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:25:06.538624 [debug] [MainThread]: On master: Close
[0m16:25:06.541226 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:06.541793 [debug] [MainThread]: Connection 'model.warehouse.stg_metadata' was properly closed.
[0m16:25:06.542388 [info ] [MainThread]: 
[0m16:25:06.543086 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.40 seconds (3.40s).
[0m16:25:06.543937 [debug] [MainThread]: Command end result
[0m16:25:06.555496 [info ] [MainThread]: 
[0m16:25:06.556142 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:25:06.556545 [info ] [MainThread]: 
[0m16:25:06.556926 [error] [MainThread]: [33mDatabase Error in model stg_metadata (models/staging/stg_metadata.sql)[0m
[0m16:25:06.557288 [error] [MainThread]:   column "formatted_teams_data" does not exist
[0m16:25:06.557625 [error] [MainThread]:   LINE 21:                 formatted_teams_data->'red'->>'has_won'::var...
[0m16:25:06.557950 [error] [MainThread]:                            ^
[0m16:25:06.558270 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_metadata.sql
[0m16:25:06.558598 [info ] [MainThread]: 
[0m16:25:06.558953 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m16:25:06.559433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102899e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061c54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a54550>]}
[0m16:25:06.559827 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 16:25:39.818848 | dce481ec-b263-490a-b72d-fecc5ddebbfe ==============================
[0m16:25:39.818848 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:25:39.819903 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_metadata'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:25:39.820020 [debug] [MainThread]: Tracking: tracking
[0m16:25:39.837771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081310a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108133580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108133310>]}
[0m16:25:39.846237 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:25:39.877856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:25:39.878158 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_metadata.sql
[0m16:25:39.885685 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_metadata.sql
[0m16:25:39.894311 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:25:39.897192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dce481ec-b263-490a-b72d-fecc5ddebbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085f10d0>]}
[0m16:25:39.909362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dce481ec-b263-490a-b72d-fecc5ddebbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085ac160>]}
[0m16:25:39.909626 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:25:39.909809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dce481ec-b263-490a-b72d-fecc5ddebbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108133580>]}
[0m16:25:39.910536 [info ] [MainThread]: 
[0m16:25:39.911552 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:25:39.912063 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:25:39.918319 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:25:39.918497 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:25:39.918625 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:40.412825 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m16:25:40.414680 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:25:40.416740 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:25:40.423388 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:25:40.423692 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:25:40.423907 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:25:40.852310 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:25:40.853418 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:25:40.854173 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:25:40.905828 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m16:25:40.908714 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:25:40.953772 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:25:40.965095 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:40.965397 [debug] [MainThread]: On master: BEGIN
[0m16:25:40.965594 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:25:41.381558 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:25:41.382918 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:41.383564 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:25:41.442982 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:25:41.448329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dce481ec-b263-490a-b72d-fecc5ddebbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085729a0>]}
[0m16:25:41.449548 [debug] [MainThread]: On master: ROLLBACK
[0m16:25:41.495872 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:41.497155 [debug] [MainThread]: On master: BEGIN
[0m16:25:41.588454 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:25:41.589445 [debug] [MainThread]: On master: COMMIT
[0m16:25:41.590133 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:41.590683 [debug] [MainThread]: On master: COMMIT
[0m16:25:41.635952 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:25:41.636963 [debug] [MainThread]: On master: Close
[0m16:25:41.639168 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:25:41.639914 [info ] [MainThread]: 
[0m16:25:41.650433 [debug] [Thread-1  ]: Began running node model.warehouse.stg_metadata
[0m16:25:41.651155 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_metadata .......................... [RUN]
[0m16:25:41.652338 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_metadata'
[0m16:25:41.652738 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_metadata
[0m16:25:41.656504 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_metadata"
[0m16:25:41.657956 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (compile): 2023-04-17 16:25:41.652970 => 2023-04-17 16:25:41.657828
[0m16:25:41.658336 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_metadata
[0m16:25:41.700315 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_metadata"
[0m16:25:41.701558 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:25:41.701713 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: BEGIN
[0m16:25:41.701843 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:25:42.139152 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:25:42.140109 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:25:42.140646 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_metadata__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated_source as (

    select
        *,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data
    from source

),

teams_data_flattened as (

    select
        *,
        case
            when 
                formatted_teams_data->'red'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as red_match_won,
        formatted_teams_data->'red'->>'rounds_won' as red_rounds_won,
        formatted_teams_data->'red'->>'rounds_lost' as red_rounds_lost,
        case
            when 
                formatted_teams_data->'blue'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as blue_match_won,
        formatted_teams_data->'blue'->>'rounds_won' as blue_rounds_won,
        formatted_teams_data->'blue'->>'rounds_lost' as blue_rounds_lost
    from updated_source

)

select * from teams_data_flattened
  );
  
[0m16:25:42.259725 [debug] [Thread-1  ]: SQL status: SELECT 374 in 0 seconds
[0m16:25:42.271922 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:25:42.272399 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */
alter table "DataWarehouse"."dev_staging"."stg_metadata" rename to "stg_metadata__dbt_backup"
[0m16:25:42.318956 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:25:42.325752 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:25:42.326310 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */
alter table "DataWarehouse"."dev_staging"."stg_metadata__dbt_tmp" rename to "stg_metadata"
[0m16:25:42.372638 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:25:42.407649 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: COMMIT
[0m16:25:42.407946 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:25:42.408133 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: COMMIT
[0m16:25:42.454856 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:25:42.461997 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_metadata"
[0m16:25:42.462232 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_metadata"} */
drop table if exists "DataWarehouse"."dev_staging"."stg_metadata__dbt_backup" cascade
[0m16:25:42.513935 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m16:25:42.518519 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_metadata (execute): 2023-04-17 16:25:41.658540 => 2023-04-17 16:25:42.518360
[0m16:25:42.519094 [debug] [Thread-1  ]: On model.warehouse.stg_metadata: Close
[0m16:25:42.521165 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dce481ec-b263-490a-b72d-fecc5ddebbfe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10867c550>]}
[0m16:25:42.521743 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_staging.stg_metadata ..................... [[32mSELECT 374[0m in 0.87s]
[0m16:25:42.523625 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_metadata
[0m16:25:42.525727 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:25:42.526116 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:42.526380 [debug] [MainThread]: On master: BEGIN
[0m16:25:42.526616 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:25:42.958541 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:25:42.959480 [debug] [MainThread]: On master: COMMIT
[0m16:25:42.960143 [debug] [MainThread]: Using postgres connection "master"
[0m16:25:42.960734 [debug] [MainThread]: On master: COMMIT
[0m16:25:43.006397 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:25:43.007383 [debug] [MainThread]: On master: Close
[0m16:25:43.009413 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:43.010106 [debug] [MainThread]: Connection 'model.warehouse.stg_metadata' was properly closed.
[0m16:25:43.010773 [info ] [MainThread]: 
[0m16:25:43.011361 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m16:25:43.012090 [debug] [MainThread]: Command end result
[0m16:25:43.025488 [info ] [MainThread]: 
[0m16:25:43.026105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:43.026516 [info ] [MainThread]: 
[0m16:25:43.026897 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:25:43.027353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e432e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108572fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108572430>]}
[0m16:25:43.027729 [debug] [MainThread]: Flushing usage events


============================== 2023-04-17 16:37:31.055086 | c9baa3a2-b42b-4952-82a7-0a0413a2a119 ==============================
[0m16:37:31.055086 [info ] [MainThread]: Running with dbt=1.4.5
[0m16:37:31.056395 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_teams_info'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:37:31.056534 [debug] [MainThread]: Tracking: tracking
[0m16:37:31.075951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10618cdc0>]}
[0m16:37:31.082877 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m16:37:31.115972 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:37:31.116231 [debug] [MainThread]: Partial parsing: added file: warehouse://models/staging/stg_teams_info.sql
[0m16:37:31.116330 [debug] [MainThread]: Partial parsing: deleted file: warehouse://models/staging/stg_metadata.sql
[0m16:37:31.124615 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_teams_info.sql
[0m16:37:31.135120 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m16:37:31.138407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c9baa3a2-b42b-4952-82a7-0a0413a2a119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10690f0d0>]}
[0m16:37:31.153302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c9baa3a2-b42b-4952-82a7-0a0413a2a119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c91c0>]}
[0m16:37:31.153550 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:37:31.153730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9baa3a2-b42b-4952-82a7-0a0413a2a119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c9100>]}
[0m16:37:31.154432 [info ] [MainThread]: 
[0m16:37:31.155396 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:37:31.155960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m16:37:31.162435 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m16:37:31.162634 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m16:37:31.162749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:37:31.710442 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m16:37:31.712953 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m16:37:31.715566 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m16:37:31.720986 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:37:31.721201 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m16:37:31.721313 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:37:32.163730 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m16:37:32.164571 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m16:37:32.165141 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m16:37:32.216036 [debug] [ThreadPool]: SQL status: SELECT 3 in 0 seconds
[0m16:37:32.219471 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m16:37:32.264536 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m16:37:32.276904 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:32.277127 [debug] [MainThread]: On master: BEGIN
[0m16:37:32.277253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:37:32.713124 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:37:32.713393 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:32.713556 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m16:37:32.774403 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m16:37:32.775326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c9baa3a2-b42b-4952-82a7-0a0413a2a119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106890be0>]}
[0m16:37:32.775573 [debug] [MainThread]: On master: ROLLBACK
[0m16:37:32.821747 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:32.821933 [debug] [MainThread]: On master: BEGIN
[0m16:37:32.915835 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:37:32.916365 [debug] [MainThread]: On master: COMMIT
[0m16:37:32.916800 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:32.917125 [debug] [MainThread]: On master: COMMIT
[0m16:37:32.961866 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:37:32.962755 [debug] [MainThread]: On master: Close
[0m16:37:32.964481 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m16:37:32.965145 [info ] [MainThread]: 
[0m16:37:32.973956 [debug] [Thread-1  ]: Began running node model.warehouse.stg_teams_info
[0m16:37:32.974565 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_teams_info ........................ [RUN]
[0m16:37:32.975546 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_teams_info'
[0m16:37:32.975876 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_teams_info
[0m16:37:32.979927 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_teams_info"
[0m16:37:32.981065 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_teams_info (compile): 2023-04-17 16:37:32.976111 => 2023-04-17 16:37:32.981001
[0m16:37:32.981240 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_teams_info
[0m16:37:33.008183 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_teams_info"
[0m16:37:33.008988 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_teams_info"
[0m16:37:33.009109 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: BEGIN
[0m16:37:33.009213 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m16:37:33.452383 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m16:37:33.452970 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_teams_info"
[0m16:37:33.453243 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_teams_info"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_teams_info__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated_source as (

    select
        *,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data
    from source

),

teams_data_flattened as (

    select
        *,
        case
            when 
                formatted_teams_data->'red'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as red_match_won,
        formatted_teams_data->'red'->>'rounds_won' as red_rounds_won,
        formatted_teams_data->'red'->>'rounds_lost' as red_rounds_lost,
        case
            when 
                formatted_teams_data->'blue'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as blue_match_won,
        formatted_teams_data->'blue'->>'rounds_won' as blue_rounds_won,
        formatted_teams_data->'blue'->>'rounds_lost' as blue_rounds_lost
    from updated_source

),

final as (

    select
        match_id,
        red_match_won,
        red_rounds_won,
        red_rounds_lost,
        blue_match_won,
        blue_rounds_won,
        blue_rounds_lost
    from teams_data_flattened

)

select * from final
  );
  
[0m16:37:33.536585 [debug] [Thread-1  ]: SQL status: SELECT 374 in 0 seconds
[0m16:37:33.546158 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_teams_info"
[0m16:37:33.546361 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_teams_info"} */
alter table "DataWarehouse"."dev_staging"."stg_teams_info__dbt_tmp" rename to "stg_teams_info"
[0m16:37:33.594103 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m16:37:33.606256 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: COMMIT
[0m16:37:33.606433 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_teams_info"
[0m16:37:33.606528 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: COMMIT
[0m16:37:33.653650 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m16:37:33.660306 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_teams_info"
[0m16:37:33.660481 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_teams_info"} */
drop table if exists "DataWarehouse"."dev_staging"."stg_teams_info__dbt_backup" cascade
[0m16:37:33.706450 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m16:37:33.707614 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_teams_info (execute): 2023-04-17 16:37:32.981332 => 2023-04-17 16:37:33.707571
[0m16:37:33.707810 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: Close
[0m16:37:33.708444 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c9baa3a2-b42b-4952-82a7-0a0413a2a119', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10699e460>]}
[0m16:37:33.708746 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_staging.stg_teams_info ................... [[32mSELECT 374[0m in 0.73s]
[0m16:37:33.709792 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_teams_info
[0m16:37:33.711003 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m16:37:33.711201 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:33.711339 [debug] [MainThread]: On master: BEGIN
[0m16:37:33.711468 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:34.147345 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m16:37:34.148345 [debug] [MainThread]: On master: COMMIT
[0m16:37:34.148957 [debug] [MainThread]: Using postgres connection "master"
[0m16:37:34.149550 [debug] [MainThread]: On master: COMMIT
[0m16:37:34.197727 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m16:37:34.198618 [debug] [MainThread]: On master: Close
[0m16:37:34.200208 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:34.200623 [debug] [MainThread]: Connection 'model.warehouse.stg_teams_info' was properly closed.
[0m16:37:34.201045 [info ] [MainThread]: 
[0m16:37:34.201592 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.05 seconds (3.05s).
[0m16:37:34.202394 [debug] [MainThread]: Command end result
[0m16:37:34.213589 [info ] [MainThread]: 
[0m16:37:34.214201 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:37:34.214607 [info ] [MainThread]: 
[0m16:37:34.214981 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:37:34.215446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106885940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106890820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068908b0>]}
[0m16:37:34.215827 [debug] [MainThread]: Flushing usage events


============================== 2023-04-23 13:43:08.750725 | c752203b-17f2-4a16-8868-d324d02e8ffb ==============================
[0m13:43:08.750725 [info ] [MainThread]: Running with dbt=1.4.5
[0m13:43:08.752368 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_teams_info'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:43:08.752519 [debug] [MainThread]: Tracking: tracking
[0m13:43:08.774867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107feac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11010c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11010ca90>]}
[0m13:43:08.784779 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m13:43:09.054050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:43:09.054883 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_teams_info.sql
[0m13:43:09.072785 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_teams_info.sql
[0m13:43:09.092576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m13:43:09.096746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c752203b-17f2-4a16-8868-d324d02e8ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110e20d0>]}
[0m13:43:09.112379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c752203b-17f2-4a16-8868-d324d02e8ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110971c0>]}
[0m13:43:09.112696 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:43:09.112941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c752203b-17f2-4a16-8868-d324d02e8ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111097100>]}
[0m13:43:09.113905 [info ] [MainThread]: 
[0m13:43:09.115340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:43:09.116104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m13:43:09.125520 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m13:43:09.125800 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m13:43:09.125986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:09.686092 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m13:43:09.688710 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m13:43:09.691660 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m13:43:09.701952 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m13:43:09.702466 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m13:43:09.702794 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:10.169552 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:43:10.170575 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m13:43:10.171235 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m13:43:10.221484 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:43:10.224004 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m13:43:10.269921 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m13:43:10.285459 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:10.286007 [debug] [MainThread]: On master: BEGIN
[0m13:43:10.286525 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:43:10.732884 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:43:10.734172 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:10.734866 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:43:10.817275 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m13:43:10.819943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c752203b-17f2-4a16-8868-d324d02e8ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111050100>]}
[0m13:43:10.820575 [debug] [MainThread]: On master: ROLLBACK
[0m13:43:10.869270 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:10.870303 [debug] [MainThread]: On master: BEGIN
[0m13:43:10.976611 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:43:10.977985 [debug] [MainThread]: On master: COMMIT
[0m13:43:10.978704 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:10.979376 [debug] [MainThread]: On master: COMMIT
[0m13:43:11.029154 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:43:11.030172 [debug] [MainThread]: On master: Close
[0m13:43:11.032821 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m13:43:11.033777 [info ] [MainThread]: 
[0m13:43:11.060438 [debug] [Thread-1  ]: Began running node model.warehouse.stg_teams_info
[0m13:43:11.061164 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_teams_info ........................ [RUN]
[0m13:43:11.062454 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_teams_info'
[0m13:43:11.063065 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_teams_info
[0m13:43:11.067534 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_teams_info"
[0m13:43:11.072227 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_teams_info (compile): 2023-04-23 13:43:11.063350 => 2023-04-23 13:43:11.072083
[0m13:43:11.072680 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_teams_info
[0m13:43:11.113698 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_teams_info"
[0m13:43:11.125510 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_teams_info"
[0m13:43:11.125661 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: BEGIN
[0m13:43:11.125788 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:43:11.589838 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m13:43:11.590365 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_teams_info"
[0m13:43:11.590658 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_teams_info"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_teams_info__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated_source as (

    select
        match_id,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data
    from source

),

teams_data_flattened as (

    select
        *,
        case
            when 
                formatted_teams_data->'red'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as red_match_won,
        formatted_teams_data->'red'->>'rounds_won'::integer as red_rounds_won,
        formatted_teams_data->'red'->>'rounds_lost'::integer as red_rounds_lost,
        case
            when 
                formatted_teams_data->'blue'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as blue_match_won,
        formatted_teams_data->'blue'->>'rounds_won'::integer as blue_rounds_won,
        formatted_teams_data->'blue'->>'rounds_lost'::integer as blue_rounds_lost
    from updated_source

),

final as (

    select
        match_id,
        red_match_won,
        red_rounds_won,
        red_rounds_lost,
        blue_match_won,
        blue_rounds_won,
        blue_rounds_lost
    from teams_data_flattened

)

select * from final
  );
  
[0m13:43:11.643510 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type integer: "rounds_won"
LINE 33:         formatted_teams_data->'red'->>'rounds_won'::integer ...
                                               ^

[0m13:43:11.644348 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: ROLLBACK
[0m13:43:11.692941 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_teams_info (execute): 2023-04-23 13:43:11.072913 => 2023-04-23 13:43:11.692650
[0m13:43:11.693822 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: Close
[0m13:43:11.782561 [debug] [Thread-1  ]: Database Error in model stg_teams_info (models/staging/stg_teams_info.sql)
  invalid input syntax for type integer: "rounds_won"
  LINE 33:         formatted_teams_data->'red'->>'rounds_won'::integer ...
                                                 ^
  compiled Code at target/run/warehouse/models/staging/stg_teams_info.sql
[0m13:43:11.784170 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c752203b-17f2-4a16-8868-d324d02e8ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110ea670>]}
[0m13:43:11.785710 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_teams_info ............... [[31mERROR[0m in 0.72s]
[0m13:43:11.790625 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_teams_info
[0m13:43:11.795814 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:43:11.796928 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:11.797511 [debug] [MainThread]: On master: BEGIN
[0m13:43:11.798057 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:43:12.400173 [debug] [MainThread]: SQL status: BEGIN in 1 seconds
[0m13:43:12.400776 [debug] [MainThread]: On master: COMMIT
[0m13:43:12.401185 [debug] [MainThread]: Using postgres connection "master"
[0m13:43:12.401572 [debug] [MainThread]: On master: COMMIT
[0m13:43:12.463007 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:43:12.463577 [debug] [MainThread]: On master: Close
[0m13:43:12.465050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:12.465480 [debug] [MainThread]: Connection 'model.warehouse.stg_teams_info' was properly closed.
[0m13:43:12.465849 [info ] [MainThread]: 
[0m13:43:12.466455 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.35 seconds (3.35s).
[0m13:43:12.467218 [debug] [MainThread]: Command end result
[0m13:43:12.482223 [info ] [MainThread]: 
[0m13:43:12.483212 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:43:12.483689 [info ] [MainThread]: 
[0m13:43:12.484148 [error] [MainThread]: [33mDatabase Error in model stg_teams_info (models/staging/stg_teams_info.sql)[0m
[0m13:43:12.484951 [error] [MainThread]:   invalid input syntax for type integer: "rounds_won"
[0m13:43:12.485813 [error] [MainThread]:   LINE 33:         formatted_teams_data->'red'->>'rounds_won'::integer ...
[0m13:43:12.486339 [error] [MainThread]:                                                  ^
[0m13:43:12.486898 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_teams_info.sql
[0m13:43:12.487553 [info ] [MainThread]: 
[0m13:43:12.488083 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:43:12.488835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111140e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111140f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111140fd0>]}
[0m13:43:12.489557 [debug] [MainThread]: Flushing usage events


============================== 2023-04-23 13:45:00.210940 | 501eb072-7f69-45a3-a4c1-edd0393d73a1 ==============================
[0m13:45:00.210940 [info ] [MainThread]: Running with dbt=1.4.5
[0m13:45:00.212529 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_teams_info'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:45:00.212732 [debug] [MainThread]: Tracking: tracking
[0m13:45:00.236571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df90a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dfb580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dfb310>]}
[0m13:45:00.245424 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m13:45:00.287463 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:45:00.287764 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_teams_info.sql
[0m13:45:00.296129 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_teams_info.sql
[0m13:45:00.306695 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m13:45:00.310593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '501eb072-7f69-45a3-a4c1-edd0393d73a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042bd0d0>]}
[0m13:45:00.321984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '501eb072-7f69-45a3-a4c1-edd0393d73a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104272160>]}
[0m13:45:00.322227 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:45:00.322398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '501eb072-7f69-45a3-a4c1-edd0393d73a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dfb580>]}
[0m13:45:00.323042 [info ] [MainThread]: 
[0m13:45:00.323993 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:45:00.324589 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m13:45:00.331179 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m13:45:00.331474 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m13:45:00.331614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:00.880754 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m13:45:00.883712 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m13:45:00.886030 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m13:45:00.896701 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m13:45:00.897231 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m13:45:00.897530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:01.361557 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:45:01.362721 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m13:45:01.363283 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m13:45:01.417391 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:45:01.420699 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m13:45:01.473633 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m13:45:01.483211 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:01.483890 [debug] [MainThread]: On master: BEGIN
[0m13:45:01.484196 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:45:01.988293 [debug] [MainThread]: SQL status: BEGIN in 1 seconds
[0m13:45:01.989479 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:01.990107 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:45:02.050226 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m13:45:02.055340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '501eb072-7f69-45a3-a4c1-edd0393d73a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042389a0>]}
[0m13:45:02.056587 [debug] [MainThread]: On master: ROLLBACK
[0m13:45:02.105258 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:02.106059 [debug] [MainThread]: On master: BEGIN
[0m13:45:02.209352 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:45:02.209999 [debug] [MainThread]: On master: COMMIT
[0m13:45:02.210335 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:02.210676 [debug] [MainThread]: On master: COMMIT
[0m13:45:02.258815 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:45:02.259403 [debug] [MainThread]: On master: Close
[0m13:45:02.260525 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m13:45:02.261110 [info ] [MainThread]: 
[0m13:45:02.273899 [debug] [Thread-1  ]: Began running node model.warehouse.stg_teams_info
[0m13:45:02.275612 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_teams_info ........................ [RUN]
[0m13:45:02.277207 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_teams_info'
[0m13:45:02.277977 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_teams_info
[0m13:45:02.283666 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_teams_info"
[0m13:45:02.290052 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_teams_info (compile): 2023-04-23 13:45:02.278466 => 2023-04-23 13:45:02.289892
[0m13:45:02.290491 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_teams_info
[0m13:45:02.332136 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_teams_info"
[0m13:45:02.333792 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_teams_info"
[0m13:45:02.333951 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: BEGIN
[0m13:45:02.334081 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:45:02.805347 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m13:45:02.806542 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_teams_info"
[0m13:45:02.807293 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_teams_info"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_teams_info__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated_source as (

    select
        match_id,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data
    from source

),

teams_data_flattened as (

    select
        *,
        case
            when 
                formatted_teams_data->'red'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as red_match_won,
        formatted_teams_data->'red'->>'rounds_won'::number as red_rounds_won,
        formatted_teams_data->'red'->>'rounds_lost'::integer as red_rounds_lost,
        case
            when 
                formatted_teams_data->'blue'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as blue_match_won,
        formatted_teams_data->'blue'->>'rounds_won'::integer as blue_rounds_won,
        formatted_teams_data->'blue'->>'rounds_lost'::integer as blue_rounds_lost
    from updated_source

),

final as (

    select
        match_id,
        red_match_won,
        red_rounds_won,
        red_rounds_lost,
        blue_match_won,
        blue_rounds_won,
        blue_rounds_lost
    from teams_data_flattened

)

select * from final
  );
  
[0m13:45:02.856782 [debug] [Thread-1  ]: Postgres adapter: Postgres error: type "number" does not exist
LINE 33: ...      formatted_teams_data->'red'->>'rounds_won'::number as ...
                                                              ^

[0m13:45:02.857901 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: ROLLBACK
[0m13:45:02.904696 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_teams_info (execute): 2023-04-23 13:45:02.290770 => 2023-04-23 13:45:02.904266
[0m13:45:02.905839 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: Close
[0m13:45:02.963166 [debug] [Thread-1  ]: Database Error in model stg_teams_info (models/staging/stg_teams_info.sql)
  type "number" does not exist
  LINE 33: ...      formatted_teams_data->'red'->>'rounds_won'::number as ...
                                                                ^
  compiled Code at target/run/warehouse/models/staging/stg_teams_info.sql
[0m13:45:02.964033 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '501eb072-7f69-45a3-a4c1-edd0393d73a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10429f670>]}
[0m13:45:02.964787 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_teams_info ............... [[31mERROR[0m in 0.69s]
[0m13:45:02.967316 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_teams_info
[0m13:45:02.969915 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:45:02.970359 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:02.970655 [debug] [MainThread]: On master: BEGIN
[0m13:45:02.970928 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:45:03.442922 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:45:03.444230 [debug] [MainThread]: On master: COMMIT
[0m13:45:03.444883 [debug] [MainThread]: Using postgres connection "master"
[0m13:45:03.445545 [debug] [MainThread]: On master: COMMIT
[0m13:45:03.495657 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:45:03.496894 [debug] [MainThread]: On master: Close
[0m13:45:03.499240 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:03.499848 [debug] [MainThread]: Connection 'model.warehouse.stg_teams_info' was properly closed.
[0m13:45:03.500564 [info ] [MainThread]: 
[0m13:45:03.501477 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m13:45:03.502642 [debug] [MainThread]: Command end result
[0m13:45:03.520761 [info ] [MainThread]: 
[0m13:45:03.521685 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:45:03.522299 [info ] [MainThread]: 
[0m13:45:03.523019 [error] [MainThread]: [33mDatabase Error in model stg_teams_info (models/staging/stg_teams_info.sql)[0m
[0m13:45:03.523551 [error] [MainThread]:   type "number" does not exist
[0m13:45:03.524037 [error] [MainThread]:   LINE 33: ...      formatted_teams_data->'red'->>'rounds_won'::number as ...
[0m13:45:03.524534 [error] [MainThread]:                                                                 ^
[0m13:45:03.525333 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_teams_info.sql
[0m13:45:03.525905 [info ] [MainThread]: 
[0m13:45:03.526417 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:45:03.527054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042dbee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042dbd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042dbf10>]}
[0m13:45:03.527566 [debug] [MainThread]: Flushing usage events


============================== 2023-04-23 13:46:17.545223 | 0abafa2b-07e3-4358-a25a-40b8cc04e979 ==============================
[0m13:46:17.545223 [info ] [MainThread]: Running with dbt=1.4.5
[0m13:46:17.546500 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_teams_info'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:46:17.546641 [debug] [MainThread]: Tracking: tracking
[0m13:46:17.564800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103eb70a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ec7580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ec7310>]}
[0m13:46:17.572150 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m13:46:17.604081 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:46:17.604354 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_teams_info.sql
[0m13:46:17.612706 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_teams_info.sql
[0m13:46:17.621165 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m13:46:17.623969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0abafa2b-07e3-4358-a25a-40b8cc04e979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043880d0>]}
[0m13:46:17.637767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0abafa2b-07e3-4358-a25a-40b8cc04e979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10433e160>]}
[0m13:46:17.638041 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:46:17.638207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0abafa2b-07e3-4358-a25a-40b8cc04e979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ec7580>]}
[0m13:46:17.638872 [info ] [MainThread]: 
[0m13:46:17.639874 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:46:17.640420 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m13:46:17.646852 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m13:46:17.647075 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m13:46:17.647195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:18.204251 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m13:46:18.207961 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m13:46:18.211125 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m13:46:18.218982 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m13:46:18.219320 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m13:46:18.219555 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:18.699322 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:46:18.700143 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m13:46:18.700901 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m13:46:18.761020 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:46:18.763329 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m13:46:18.815221 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m13:46:18.825885 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:18.826166 [debug] [MainThread]: On master: BEGIN
[0m13:46:18.826334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:19.322984 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:46:19.323955 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:19.324477 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:46:19.387554 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m13:46:19.389823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0abafa2b-07e3-4358-a25a-40b8cc04e979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1043059a0>]}
[0m13:46:19.390616 [debug] [MainThread]: On master: ROLLBACK
[0m13:46:19.444228 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:19.444883 [debug] [MainThread]: On master: BEGIN
[0m13:46:19.545677 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:46:19.546544 [debug] [MainThread]: On master: COMMIT
[0m13:46:19.547014 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:19.547440 [debug] [MainThread]: On master: COMMIT
[0m13:46:19.597922 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:46:19.599224 [debug] [MainThread]: On master: Close
[0m13:46:19.601312 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m13:46:19.602205 [info ] [MainThread]: 
[0m13:46:19.614030 [debug] [Thread-1  ]: Began running node model.warehouse.stg_teams_info
[0m13:46:19.614679 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_teams_info ........................ [RUN]
[0m13:46:19.615694 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_teams_info'
[0m13:46:19.616023 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_teams_info
[0m13:46:19.620053 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_teams_info"
[0m13:46:19.624513 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_teams_info (compile): 2023-04-23 13:46:19.616257 => 2023-04-23 13:46:19.624361
[0m13:46:19.624918 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_teams_info
[0m13:46:19.666223 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_teams_info"
[0m13:46:19.675233 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_teams_info"
[0m13:46:19.675424 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: BEGIN
[0m13:46:19.675559 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:20.148898 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m13:46:20.149821 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_teams_info"
[0m13:46:20.150130 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_teams_info"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_teams_info__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated_source as (

    select
        match_id,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data
    from source

),

teams_data_flattened as (

    select
        *,
        case
            when 
                formatted_teams_data->'red'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as red_match_won,
        formatted_teams_data->'red'->>'rounds_won'::integer as red_rounds_won,
        formatted_teams_data->'red'->>'rounds_lost'::integer as red_rounds_lost,
        case
            when 
                formatted_teams_data->'blue'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as blue_match_won,
        formatted_teams_data->'blue'->>'rounds_won'::integer as blue_rounds_won,
        formatted_teams_data->'blue'->>'rounds_lost'::integer as blue_rounds_lost
    from updated_source

),

final as (

    select
        match_id,
        red_match_won,
        red_rounds_won,
        red_rounds_lost,
        blue_match_won,
        blue_rounds_won,
        blue_rounds_lost
    from teams_data_flattened

)

select * from final
  );
  
[0m13:46:20.229049 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type integer: "rounds_won"
LINE 33:         formatted_teams_data->'red'->>'rounds_won'::integer ...
                                               ^

[0m13:46:20.230748 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: ROLLBACK
[0m13:46:20.299634 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_teams_info (execute): 2023-04-23 13:46:19.625114 => 2023-04-23 13:46:20.299415
[0m13:46:20.300323 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: Close
[0m13:46:20.338994 [debug] [Thread-1  ]: Database Error in model stg_teams_info (models/staging/stg_teams_info.sql)
  invalid input syntax for type integer: "rounds_won"
  LINE 33:         formatted_teams_data->'red'->>'rounds_won'::integer ...
                                                 ^
  compiled Code at target/run/warehouse/models/staging/stg_teams_info.sql
[0m13:46:20.339528 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0abafa2b-07e3-4358-a25a-40b8cc04e979', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10437a3a0>]}
[0m13:46:20.340031 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_teams_info ............... [[31mERROR[0m in 0.72s]
[0m13:46:20.341820 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_teams_info
[0m13:46:20.343874 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:46:20.344253 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:20.344505 [debug] [MainThread]: On master: BEGIN
[0m13:46:20.344736 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:20.857615 [debug] [MainThread]: SQL status: BEGIN in 1 seconds
[0m13:46:20.858222 [debug] [MainThread]: On master: COMMIT
[0m13:46:20.858527 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:20.858812 [debug] [MainThread]: On master: COMMIT
[0m13:46:20.908008 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:46:20.909188 [debug] [MainThread]: On master: Close
[0m13:46:20.911231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:20.911663 [debug] [MainThread]: Connection 'model.warehouse.stg_teams_info' was properly closed.
[0m13:46:20.912158 [info ] [MainThread]: 
[0m13:46:20.912725 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m13:46:20.913398 [debug] [MainThread]: Command end result
[0m13:46:20.927198 [info ] [MainThread]: 
[0m13:46:20.927793 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:46:20.928183 [info ] [MainThread]: 
[0m13:46:20.928553 [error] [MainThread]: [33mDatabase Error in model stg_teams_info (models/staging/stg_teams_info.sql)[0m
[0m13:46:20.928910 [error] [MainThread]:   invalid input syntax for type integer: "rounds_won"
[0m13:46:20.929248 [error] [MainThread]:   LINE 33:         formatted_teams_data->'red'->>'rounds_won'::integer ...
[0m13:46:20.929575 [error] [MainThread]:                                                  ^
[0m13:46:20.929887 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_teams_info.sql
[0m13:46:20.930169 [info ] [MainThread]: 
[0m13:46:20.930467 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:46:20.930855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439e1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10439e4c0>]}
[0m13:46:20.931172 [debug] [MainThread]: Flushing usage events


============================== 2023-04-23 13:46:49.261775 | 59ccf2db-de41-46fc-8a5c-8cc1108fa179 ==============================
[0m13:46:49.261775 [info ] [MainThread]: Running with dbt=1.4.5
[0m13:46:49.263066 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_teams_info'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:46:49.263183 [debug] [MainThread]: Tracking: tracking
[0m13:46:49.278355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b6d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b6e580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b6e310>]}
[0m13:46:49.287145 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m13:46:49.317848 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:46:49.318145 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_teams_info.sql
[0m13:46:49.325693 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_teams_info.sql
[0m13:46:49.334691 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m13:46:49.337628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59ccf2db-de41-46fc-8a5c-8cc1108fa179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10402d0d0>]}
[0m13:46:49.347909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59ccf2db-de41-46fc-8a5c-8cc1108fa179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fe6190>]}
[0m13:46:49.348199 [info ] [MainThread]: Found 2 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:46:49.348376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ccf2db-de41-46fc-8a5c-8cc1108fa179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b6d0a0>]}
[0m13:46:49.349048 [info ] [MainThread]: 
[0m13:46:49.350089 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:46:49.350584 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m13:46:49.357030 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m13:46:49.357224 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m13:46:49.357342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:49.898612 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m13:46:49.900950 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m13:46:49.903280 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m13:46:49.913015 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m13:46:49.913176 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m13:46:49.913285 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:50.362243 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:46:50.363520 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m13:46:50.364172 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m13:46:50.415259 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:46:50.419844 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m13:46:50.468352 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m13:46:50.483118 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:50.483616 [debug] [MainThread]: On master: BEGIN
[0m13:46:50.483933 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:46:50.956117 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:46:50.956861 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:50.957327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:46:51.019298 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m13:46:51.023039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59ccf2db-de41-46fc-8a5c-8cc1108fa179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fad820>]}
[0m13:46:51.024035 [debug] [MainThread]: On master: ROLLBACK
[0m13:46:51.069143 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:51.069923 [debug] [MainThread]: On master: BEGIN
[0m13:46:51.171044 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:46:51.172226 [debug] [MainThread]: On master: COMMIT
[0m13:46:51.172927 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:51.173583 [debug] [MainThread]: On master: COMMIT
[0m13:46:51.219763 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:46:51.220668 [debug] [MainThread]: On master: Close
[0m13:46:51.222458 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m13:46:51.223113 [info ] [MainThread]: 
[0m13:46:51.231304 [debug] [Thread-1  ]: Began running node model.warehouse.stg_teams_info
[0m13:46:51.232000 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_teams_info ........................ [RUN]
[0m13:46:51.233051 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_teams_info'
[0m13:46:51.233412 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_teams_info
[0m13:46:51.237777 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_teams_info"
[0m13:46:51.239309 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_teams_info (compile): 2023-04-23 13:46:51.233666 => 2023-04-23 13:46:51.239181
[0m13:46:51.239723 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_teams_info
[0m13:46:51.283703 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_teams_info"
[0m13:46:51.285096 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_teams_info"
[0m13:46:51.285242 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: BEGIN
[0m13:46:51.285366 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:46:51.769629 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m13:46:51.770597 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_teams_info"
[0m13:46:51.770954 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_teams_info"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_teams_info__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated_source as (

    select
        match_id,
        replace(replace(lower(teams),'none','null'),'''', '"')::json as formatted_teams_data
    from source

),

teams_data_flattened as (

    select
        *,
        case
            when 
                formatted_teams_data->'red'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as red_match_won,
        formatted_teams_data->'red'->>'rounds_won'::varchar as red_rounds_won,
        formatted_teams_data->'red'->>'rounds_lost'::integer as red_rounds_lost,
        case
            when 
                formatted_teams_data->'blue'->>'has_won'::varchar = 'true'
            then 1
            else 0
        end as blue_match_won,
        formatted_teams_data->'blue'->>'rounds_won'::integer as blue_rounds_won,
        formatted_teams_data->'blue'->>'rounds_lost'::integer as blue_rounds_lost
    from updated_source

),

final as (

    select
        match_id,
        red_match_won,
        red_rounds_won,
        red_rounds_lost,
        blue_match_won,
        blue_rounds_won,
        blue_rounds_lost
    from teams_data_flattened

)

select * from final
  );
  
[0m13:46:51.825077 [debug] [Thread-1  ]: Postgres adapter: Postgres error: invalid input syntax for type integer: "rounds_lost"
LINE 34:         formatted_teams_data->'red'->>'rounds_lost'::integer...
                                               ^

[0m13:46:51.826179 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: ROLLBACK
[0m13:46:51.873670 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_teams_info (execute): 2023-04-23 13:46:51.239951 => 2023-04-23 13:46:51.873394
[0m13:46:51.874434 [debug] [Thread-1  ]: On model.warehouse.stg_teams_info: Close
[0m13:46:51.914043 [debug] [Thread-1  ]: Database Error in model stg_teams_info (models/staging/stg_teams_info.sql)
  invalid input syntax for type integer: "rounds_lost"
  LINE 34:         formatted_teams_data->'red'->>'rounds_lost'::integer...
                                                 ^
  compiled Code at target/run/warehouse/models/staging/stg_teams_info.sql
[0m13:46:51.914612 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59ccf2db-de41-46fc-8a5c-8cc1108fa179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040e1940>]}
[0m13:46:51.915105 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_teams_info ............... [[31mERROR[0m in 0.68s]
[0m13:46:51.916883 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_teams_info
[0m13:46:51.919101 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:46:51.919471 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:51.919724 [debug] [MainThread]: On master: BEGIN
[0m13:46:51.919954 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:46:52.617898 [debug] [MainThread]: SQL status: BEGIN in 1 seconds
[0m13:46:52.618985 [debug] [MainThread]: On master: COMMIT
[0m13:46:52.619548 [debug] [MainThread]: Using postgres connection "master"
[0m13:46:52.619957 [debug] [MainThread]: On master: COMMIT
[0m13:46:52.668012 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:46:52.668993 [debug] [MainThread]: On master: Close
[0m13:46:52.670959 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:46:52.671463 [debug] [MainThread]: Connection 'model.warehouse.stg_teams_info' was properly closed.
[0m13:46:52.671997 [info ] [MainThread]: 
[0m13:46:52.672700 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.32 seconds (3.32s).
[0m13:46:52.673441 [debug] [MainThread]: Command end result
[0m13:46:52.683970 [info ] [MainThread]: 
[0m13:46:52.684600 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:46:52.685001 [info ] [MainThread]: 
[0m13:46:52.685388 [error] [MainThread]: [33mDatabase Error in model stg_teams_info (models/staging/stg_teams_info.sql)[0m
[0m13:46:52.685759 [error] [MainThread]:   invalid input syntax for type integer: "rounds_lost"
[0m13:46:52.686118 [error] [MainThread]:   LINE 34:         formatted_teams_data->'red'->>'rounds_lost'::integer...
[0m13:46:52.686450 [error] [MainThread]:                                                  ^
[0m13:46:52.686777 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_teams_info.sql
[0m13:46:52.687118 [info ] [MainThread]: 
[0m13:46:52.687481 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:46:52.687955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104090d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104090fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104090c70>]}
[0m13:46:52.688347 [debug] [MainThread]: Flushing usage events


============================== 2023-04-23 13:58:52.051866 | 01c039aa-61f7-41b3-b6b8-958650e34a23 ==============================
[0m13:58:52.051866 [info ] [MainThread]: Running with dbt=1.4.5
[0m13:58:52.053309 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_match_info'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:58:52.053427 [debug] [MainThread]: Tracking: tracking
[0m13:58:52.072371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105976c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b80a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b8a90>]}
[0m13:58:52.079865 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m13:58:52.111645 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m13:58:52.111896 [debug] [MainThread]: Partial parsing: added file: warehouse://models/staging/stg_match_info.sql
[0m13:58:52.112053 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_teams_info.sql
[0m13:58:52.120038 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
[0m13:58:52.127028 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_teams_info.sql
[0m13:58:52.130183 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m13:58:52.133124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01c039aa-61f7-41b3-b6b8-958650e34a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061430d0>]}
[0m13:58:52.147127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01c039aa-61f7-41b3-b6b8-958650e34a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060fa1c0>]}
[0m13:58:52.147370 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:58:52.147531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01c039aa-61f7-41b3-b6b8-958650e34a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060fa100>]}
[0m13:58:52.148178 [info ] [MainThread]: 
[0m13:58:52.149077 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:58:52.149597 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m13:58:52.155941 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m13:58:52.156132 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m13:58:52.156280 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:52.753669 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m13:58:52.756257 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m13:58:52.758990 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m13:58:52.769647 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m13:58:52.770088 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m13:58:52.770576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:53.194383 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m13:58:53.195559 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m13:58:53.196065 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m13:58:53.245329 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m13:58:53.252273 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m13:58:53.298320 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m13:58:53.305864 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:53.306170 [debug] [MainThread]: On master: BEGIN
[0m13:58:53.306371 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:58:53.740287 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:58:53.740686 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:53.740932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:58:53.800852 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m13:58:53.803827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01c039aa-61f7-41b3-b6b8-958650e34a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060be0a0>]}
[0m13:58:53.805173 [debug] [MainThread]: On master: ROLLBACK
[0m13:58:53.852655 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:53.853041 [debug] [MainThread]: On master: BEGIN
[0m13:58:53.944287 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:58:53.944847 [debug] [MainThread]: On master: COMMIT
[0m13:58:53.945305 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:53.945680 [debug] [MainThread]: On master: COMMIT
[0m13:58:53.990763 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:58:53.991452 [debug] [MainThread]: On master: Close
[0m13:58:53.992654 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m13:58:53.993150 [info ] [MainThread]: 
[0m13:58:54.000183 [debug] [Thread-1  ]: Began running node model.warehouse.stg_match_info
[0m13:58:54.000615 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_match_info ........................ [RUN]
[0m13:58:54.001126 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_match_info'
[0m13:58:54.001572 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_match_info
[0m13:58:54.004232 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_match_info"
[0m13:58:54.005138 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (compile): 2023-04-23 13:58:54.001692 => 2023-04-23 13:58:54.005053
[0m13:58:54.005512 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_match_info
[0m13:58:54.039953 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_match_info"
[0m13:58:54.040819 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m13:58:54.040929 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: BEGIN
[0m13:58:54.041026 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:58:54.461088 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m13:58:54.461563 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m13:58:54.461814 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_match_info"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_match_info__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated as (

    select distinct
        match_id,
        mode,
        season_id,
        cluster,
        map,
        start_at,
        cast(to_timestamp(start_at) as date),
        to_timestamp(start_at),
        duration,
    from source

)

select * from updated limit 10;
  );
  
[0m13:58:54.507132 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 26:     from source
             ^

[0m13:58:54.507897 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: ROLLBACK
[0m13:58:54.554089 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (execute): 2023-04-23 13:58:54.005701 => 2023-04-23 13:58:54.553935
[0m13:58:54.554527 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: Close
[0m13:58:54.591438 [debug] [Thread-1  ]: Database Error in model stg_match_info (models/staging/stg_match_info.sql)
  syntax error at or near "from"
  LINE 26:     from source
               ^
  compiled Code at target/run/warehouse/models/staging/stg_match_info.sql
[0m13:58:54.591720 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01c039aa-61f7-41b3-b6b8-958650e34a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f4cd0>]}
[0m13:58:54.591957 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_match_info ............... [[31mERROR[0m in 0.59s]
[0m13:58:54.592791 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_match_info
[0m13:58:54.593810 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m13:58:54.593972 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:54.594078 [debug] [MainThread]: On master: BEGIN
[0m13:58:54.594181 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:58:55.013677 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m13:58:55.014183 [debug] [MainThread]: On master: COMMIT
[0m13:58:55.014476 [debug] [MainThread]: Using postgres connection "master"
[0m13:58:55.014753 [debug] [MainThread]: On master: COMMIT
[0m13:58:55.058147 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m13:58:55.058906 [debug] [MainThread]: On master: Close
[0m13:58:55.060475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:55.060807 [debug] [MainThread]: Connection 'model.warehouse.stg_match_info' was properly closed.
[0m13:58:55.061186 [info ] [MainThread]: 
[0m13:58:55.061870 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m13:58:55.062769 [debug] [MainThread]: Command end result
[0m13:58:55.084196 [info ] [MainThread]: 
[0m13:58:55.084624 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:58:55.084790 [info ] [MainThread]: 
[0m13:58:55.084956 [error] [MainThread]: [33mDatabase Error in model stg_match_info (models/staging/stg_match_info.sql)[0m
[0m13:58:55.085143 [error] [MainThread]:   syntax error at or near "from"
[0m13:58:55.085345 [error] [MainThread]:   LINE 26:     from source
[0m13:58:55.085490 [error] [MainThread]:                ^
[0m13:58:55.085624 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_match_info.sql
[0m13:58:55.085927 [info ] [MainThread]: 
[0m13:58:55.086114 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:58:55.086411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10598fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f4cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061f4b80>]}
[0m13:58:55.086601 [debug] [MainThread]: Flushing usage events


============================== 2023-04-23 14:00:55.841524 | bdb6c282-efe9-4001-b854-d60aac1e0f3a ==============================
[0m14:00:55.841524 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:00:55.842940 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_match_info'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:00:55.843078 [debug] [MainThread]: Tracking: tracking
[0m14:00:55.856465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106270f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106558d60>]}
[0m14:00:55.864006 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:00:55.897147 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:00:55.897434 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_match_info.sql
[0m14:00:55.905547 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
[0m14:00:55.915116 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m14:00:55.918752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bdb6c282-efe9-4001-b854-d60aac1e0f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1f0d0>]}
[0m14:00:55.937109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bdb6c282-efe9-4001-b854-d60aac1e0f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069da1f0>]}
[0m14:00:55.937436 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:00:55.937646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb6c282-efe9-4001-b854-d60aac1e0f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106270f70>]}
[0m14:00:55.938501 [info ] [MainThread]: 
[0m14:00:55.939559 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:00:55.940255 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m14:00:55.947570 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m14:00:55.947792 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:00:55.947944 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:00:56.433455 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m14:00:56.436511 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m14:00:56.439675 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m14:00:56.450286 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:00:56.450764 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m14:00:56.451229 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:00:56.868663 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:00:56.868926 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:00:56.869106 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m14:00:56.920435 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:00:56.921532 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m14:00:56.965566 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m14:00:56.969481 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:56.969679 [debug] [MainThread]: On master: BEGIN
[0m14:00:56.969794 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:00:57.384149 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:00:57.384707 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:57.385009 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:00:57.443836 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m14:00:57.445855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bdb6c282-efe9-4001-b854-d60aac1e0f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a0190>]}
[0m14:00:57.446472 [debug] [MainThread]: On master: ROLLBACK
[0m14:00:57.491916 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:57.492406 [debug] [MainThread]: On master: BEGIN
[0m14:00:57.581978 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:00:57.582519 [debug] [MainThread]: On master: COMMIT
[0m14:00:57.582874 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:57.583288 [debug] [MainThread]: On master: COMMIT
[0m14:00:57.627991 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:00:57.628500 [debug] [MainThread]: On master: Close
[0m14:00:57.629659 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m14:00:57.630291 [info ] [MainThread]: 
[0m14:00:57.640797 [debug] [Thread-1  ]: Began running node model.warehouse.stg_match_info
[0m14:00:57.641462 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_match_info ........................ [RUN]
[0m14:00:57.642621 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_match_info'
[0m14:00:57.643117 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_match_info
[0m14:00:57.647759 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_match_info"
[0m14:00:57.649499 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (compile): 2023-04-23 14:00:57.643433 => 2023-04-23 14:00:57.649316
[0m14:00:57.650024 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_match_info
[0m14:00:57.677961 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_match_info"
[0m14:00:57.678801 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:00:57.678910 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: BEGIN
[0m14:00:57.679001 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:00:58.109663 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:00:58.110136 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:00:58.110387 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_match_info"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_match_info__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated as (

    select distinct
        match_id,
        mode,
        season_id,
        cluster,
        map,
        start_at,
        cast(to_timestamp(start_at) as date),
        to_timestamp(start_at),
        duration
    from source

)

select * from updated limit 10;
  );
  
[0m14:00:58.157545 [debug] [Thread-1  ]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 30: select * from updated limit 10;
                                       ^

[0m14:00:58.158098 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: ROLLBACK
[0m14:00:58.203528 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (execute): 2023-04-23 14:00:57.650265 => 2023-04-23 14:00:58.203379
[0m14:00:58.204004 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: Close
[0m14:00:58.246717 [debug] [Thread-1  ]: Database Error in model stg_match_info (models/staging/stg_match_info.sql)
  syntax error at or near ";"
  LINE 30: select * from updated limit 10;
                                         ^
  compiled Code at target/run/warehouse/models/staging/stg_match_info.sql
[0m14:00:58.246983 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bdb6c282-efe9-4001-b854-d60aac1e0f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10626fd00>]}
[0m14:00:58.247219 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_match_info ............... [[31mERROR[0m in 0.60s]
[0m14:00:58.248040 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_match_info
[0m14:00:58.249190 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:00:58.249454 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:58.249593 [debug] [MainThread]: On master: BEGIN
[0m14:00:58.249704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:00:58.675609 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:00:58.676118 [debug] [MainThread]: On master: COMMIT
[0m14:00:58.676409 [debug] [MainThread]: Using postgres connection "master"
[0m14:00:58.676686 [debug] [MainThread]: On master: COMMIT
[0m14:00:58.722003 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:00:58.722562 [debug] [MainThread]: On master: Close
[0m14:00:58.723830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:00:58.724386 [debug] [MainThread]: Connection 'model.warehouse.stg_match_info' was properly closed.
[0m14:00:58.724836 [info ] [MainThread]: 
[0m14:00:58.725337 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m14:00:58.726212 [debug] [MainThread]: Command end result
[0m14:00:58.736963 [info ] [MainThread]: 
[0m14:00:58.738089 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:00:58.738714 [info ] [MainThread]: 
[0m14:00:58.739225 [error] [MainThread]: [33mDatabase Error in model stg_match_info (models/staging/stg_match_info.sql)[0m
[0m14:00:58.739636 [error] [MainThread]:   syntax error at or near ";"
[0m14:00:58.740017 [error] [MainThread]:   LINE 30: select * from updated limit 10;
[0m14:00:58.740379 [error] [MainThread]:                                          ^
[0m14:00:58.740800 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_match_info.sql
[0m14:00:58.741290 [info ] [MainThread]: 
[0m14:00:58.741745 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:00:58.742411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f8df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069f8fa0>]}
[0m14:00:58.743096 [debug] [MainThread]: Flushing usage events


============================== 2023-04-23 14:01:14.566714 | f0313c5c-be0a-4771-abcf-218f0cb82dc2 ==============================
[0m14:01:14.566714 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:01:14.568075 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_match_info'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:01:14.568215 [debug] [MainThread]: Tracking: tracking
[0m14:01:14.583139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f3ec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f800a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f80a90>]}
[0m14:01:14.590367 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:01:14.621582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:14.621860 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_match_info.sql
[0m14:01:14.630540 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
[0m14:01:14.639478 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m14:01:14.642467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0313c5c-be0a-4771-abcf-218f0cb82dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087090d0>]}
[0m14:01:14.658059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0313c5c-be0a-4771-abcf-218f0cb82dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c21c0>]}
[0m14:01:14.658324 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:01:14.658511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0313c5c-be0a-4771-abcf-218f0cb82dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c2100>]}
[0m14:01:14.659189 [info ] [MainThread]: 
[0m14:01:14.660161 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:01:14.660747 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m14:01:14.667633 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m14:01:14.667844 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:01:14.667971 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:15.144948 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m14:01:15.147193 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m14:01:15.149631 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m14:01:15.157511 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:01:15.157811 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m14:01:15.158187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:15.595310 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:01:15.596320 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:01:15.596852 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m14:01:15.649460 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:01:15.650909 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m14:01:15.698307 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m14:01:15.708327 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:15.708605 [debug] [MainThread]: On master: BEGIN
[0m14:01:15.708799 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:01:16.143892 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:01:16.144620 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:16.144964 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:01:16.205118 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m14:01:16.209673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0313c5c-be0a-4771-abcf-218f0cb82dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086880a0>]}
[0m14:01:16.210581 [debug] [MainThread]: On master: ROLLBACK
[0m14:01:16.255956 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:16.256835 [debug] [MainThread]: On master: BEGIN
[0m14:01:16.349964 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:01:16.351056 [debug] [MainThread]: On master: COMMIT
[0m14:01:16.351523 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:16.351976 [debug] [MainThread]: On master: COMMIT
[0m14:01:16.399695 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:01:16.400398 [debug] [MainThread]: On master: Close
[0m14:01:16.401773 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m14:01:16.402271 [info ] [MainThread]: 
[0m14:01:16.410738 [debug] [Thread-1  ]: Began running node model.warehouse.stg_match_info
[0m14:01:16.411151 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_match_info ........................ [RUN]
[0m14:01:16.411763 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_match_info'
[0m14:01:16.411992 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_match_info
[0m14:01:16.414312 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_match_info"
[0m14:01:16.417975 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (compile): 2023-04-23 14:01:16.412124 => 2023-04-23 14:01:16.417878
[0m14:01:16.418240 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_match_info
[0m14:01:16.466804 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_match_info"
[0m14:01:16.499227 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:01:16.499904 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: BEGIN
[0m14:01:16.500731 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:01:16.935597 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:01:16.936131 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:01:16.936500 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_match_info"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_match_info__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated as (

    select distinct
        match_id,
        mode,
        season_id,
        cluster,
        map,
        start_at,
        cast(to_timestamp(start_at) as date),
        to_timestamp(start_at),
        duration
    from source

)

select * from updated limit 10
  );
  
[0m14:01:16.983703 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function to_timestamp(character varying) does not exist
LINE 23:         cast(to_timestamp(start_at) as date),
                      ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m14:01:16.984462 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: ROLLBACK
[0m14:01:17.031557 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (execute): 2023-04-23 14:01:16.418370 => 2023-04-23 14:01:17.031369
[0m14:01:17.032138 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: Close
[0m14:01:17.056235 [debug] [Thread-1  ]: Database Error in model stg_match_info (models/staging/stg_match_info.sql)
  function to_timestamp(character varying) does not exist
  LINE 23:         cast(to_timestamp(start_at) as date),
                        ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/warehouse/models/staging/stg_match_info.sql
[0m14:01:17.056585 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f0313c5c-be0a-4771-abcf-218f0cb82dc2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087bcbb0>]}
[0m14:01:17.056874 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_match_info ............... [[31mERROR[0m in 0.65s]
[0m14:01:17.057857 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_match_info
[0m14:01:17.059562 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:01:17.059773 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:17.059903 [debug] [MainThread]: On master: BEGIN
[0m14:01:17.060027 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:01:17.491747 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:01:17.492670 [debug] [MainThread]: On master: COMMIT
[0m14:01:17.493031 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:17.493377 [debug] [MainThread]: On master: COMMIT
[0m14:01:17.537554 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:01:17.538141 [debug] [MainThread]: On master: Close
[0m14:01:17.539572 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:17.539940 [debug] [MainThread]: Connection 'model.warehouse.stg_match_info' was properly closed.
[0m14:01:17.540249 [info ] [MainThread]: 
[0m14:01:17.540660 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m14:01:17.541245 [debug] [MainThread]: Command end result
[0m14:01:17.558581 [info ] [MainThread]: 
[0m14:01:17.559326 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:01:17.559758 [info ] [MainThread]: 
[0m14:01:17.560244 [error] [MainThread]: [33mDatabase Error in model stg_match_info (models/staging/stg_match_info.sql)[0m
[0m14:01:17.560639 [error] [MainThread]:   function to_timestamp(character varying) does not exist
[0m14:01:17.561177 [error] [MainThread]:   LINE 23:         cast(to_timestamp(start_at) as date),
[0m14:01:17.561604 [error] [MainThread]:                         ^
[0m14:01:17.562136 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m14:01:17.562574 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_match_info.sql
[0m14:01:17.563159 [info ] [MainThread]: 
[0m14:01:17.563662 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:01:17.563997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087a7070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f57970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f57a30>]}
[0m14:01:17.564244 [debug] [MainThread]: Flushing usage events


============================== 2023-04-23 14:01:39.224367 | 87792fb9-f4be-4f87-b68f-94eaa4b8c190 ==============================
[0m14:01:39.224367 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:01:39.225644 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_match_info'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:01:39.225812 [debug] [MainThread]: Tracking: tracking
[0m14:01:39.241139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077cb4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d6580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d6310>]}
[0m14:01:39.249341 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:01:39.281139 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:39.281431 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_match_info.sql
[0m14:01:39.288558 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
[0m14:01:39.297018 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m14:01:39.299908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '87792fb9-f4be-4f87-b68f-94eaa4b8c190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c970d0>]}
[0m14:01:39.311693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '87792fb9-f4be-4f87-b68f-94eaa4b8c190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c501c0>]}
[0m14:01:39.311929 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:01:39.312092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87792fb9-f4be-4f87-b68f-94eaa4b8c190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077cb4c0>]}
[0m14:01:39.312730 [info ] [MainThread]: 
[0m14:01:39.313655 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:01:39.314229 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m14:01:39.320562 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m14:01:39.320767 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:01:39.320884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:39.783663 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m14:01:39.787777 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m14:01:39.791476 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m14:01:39.801500 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:01:39.801886 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m14:01:39.802350 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:40.222531 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:01:40.223881 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:01:40.224668 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m14:01:40.277375 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:01:40.282579 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m14:01:40.325948 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m14:01:40.340137 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:40.340550 [debug] [MainThread]: On master: BEGIN
[0m14:01:40.340852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:01:40.776674 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:01:40.777669 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:40.778319 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:01:40.837045 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m14:01:40.839951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '87792fb9-f4be-4f87-b68f-94eaa4b8c190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c17190>]}
[0m14:01:40.840811 [debug] [MainThread]: On master: ROLLBACK
[0m14:01:40.885939 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:40.887314 [debug] [MainThread]: On master: BEGIN
[0m14:01:40.974501 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:01:40.975216 [debug] [MainThread]: On master: COMMIT
[0m14:01:40.975621 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:40.976015 [debug] [MainThread]: On master: COMMIT
[0m14:01:41.020856 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:01:41.021669 [debug] [MainThread]: On master: Close
[0m14:01:41.023606 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m14:01:41.024183 [info ] [MainThread]: 
[0m14:01:41.035238 [debug] [Thread-1  ]: Began running node model.warehouse.stg_match_info
[0m14:01:41.035882 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_match_info ........................ [RUN]
[0m14:01:41.036740 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_match_info'
[0m14:01:41.037026 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_match_info
[0m14:01:41.040360 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_match_info"
[0m14:01:41.041679 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (compile): 2023-04-23 14:01:41.037233 => 2023-04-23 14:01:41.041570
[0m14:01:41.042009 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_match_info
[0m14:01:41.084928 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_match_info"
[0m14:01:41.086211 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:01:41.086354 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: BEGIN
[0m14:01:41.086477 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:01:41.517722 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:01:41.518642 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:01:41.519073 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_match_info"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_match_info__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated as (

    select distinct
        match_id,
        mode,
        season_id,
        cluster,
        map,
        start_at,
        cast(to_timestamp(start_at::integer) as date),
        to_timestamp(start_at),
        duration
    from source

)

select * from updated limit 10
  );
  
[0m14:01:41.565915 [debug] [Thread-1  ]: Postgres adapter: Postgres error: function to_timestamp(character varying) does not exist
LINE 24:         to_timestamp(start_at),
                 ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m14:01:41.566881 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: ROLLBACK
[0m14:01:41.610995 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (execute): 2023-04-23 14:01:41.042207 => 2023-04-23 14:01:41.610555
[0m14:01:41.612244 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: Close
[0m14:01:41.654427 [debug] [Thread-1  ]: Database Error in model stg_match_info (models/staging/stg_match_info.sql)
  function to_timestamp(character varying) does not exist
  LINE 24:         to_timestamp(start_at),
                   ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/warehouse/models/staging/stg_match_info.sql
[0m14:01:41.654950 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '87792fb9-f4be-4f87-b68f-94eaa4b8c190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c70dc0>]}
[0m14:01:41.655475 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_match_info ............... [[31mERROR[0m in 0.62s]
[0m14:01:41.657272 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_match_info
[0m14:01:41.659322 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:01:41.659696 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:41.659945 [debug] [MainThread]: On master: BEGIN
[0m14:01:41.660176 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:01:42.081350 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:01:42.082706 [debug] [MainThread]: On master: COMMIT
[0m14:01:42.083422 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:42.084097 [debug] [MainThread]: On master: COMMIT
[0m14:01:42.128149 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:01:42.129073 [debug] [MainThread]: On master: Close
[0m14:01:42.131594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:42.132174 [debug] [MainThread]: Connection 'model.warehouse.stg_match_info' was properly closed.
[0m14:01:42.132759 [info ] [MainThread]: 
[0m14:01:42.133445 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.82 seconds (2.82s).
[0m14:01:42.134293 [debug] [MainThread]: Command end result
[0m14:01:42.145710 [info ] [MainThread]: 
[0m14:01:42.146309 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:01:42.146711 [info ] [MainThread]: 
[0m14:01:42.147083 [error] [MainThread]: [33mDatabase Error in model stg_match_info (models/staging/stg_match_info.sql)[0m
[0m14:01:42.147447 [error] [MainThread]:   function to_timestamp(character varying) does not exist
[0m14:01:42.147789 [error] [MainThread]:   LINE 24:         to_timestamp(start_at),
[0m14:01:42.148123 [error] [MainThread]:                    ^
[0m14:01:42.148450 [error] [MainThread]:   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
[0m14:01:42.148775 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_match_info.sql
[0m14:01:42.149107 [info ] [MainThread]: 
[0m14:01:42.149397 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:01:42.149768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d42520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c70d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb7f10>]}
[0m14:01:42.150075 [debug] [MainThread]: Flushing usage events


============================== 2023-04-23 14:01:52.578256 | 35e78c47-0dea-4fca-857e-230f5c4990ed ==============================
[0m14:01:52.578256 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:01:52.579624 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_match_info'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:01:52.579804 [debug] [MainThread]: Tracking: tracking
[0m14:01:52.595973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038710a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103872580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103872310>]}
[0m14:01:52.604631 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:01:52.659590 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:01:52.659964 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_match_info.sql
[0m14:01:52.668865 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
[0m14:01:52.680725 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m14:01:52.684191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35e78c47-0dea-4fca-857e-230f5c4990ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d350d0>]}
[0m14:01:52.699738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35e78c47-0dea-4fca-857e-230f5c4990ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cee1c0>]}
[0m14:01:52.700095 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:01:52.700525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35e78c47-0dea-4fca-857e-230f5c4990ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1038710a0>]}
[0m14:01:52.702234 [info ] [MainThread]: 
[0m14:01:52.704028 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:01:52.705861 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m14:01:52.715974 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m14:01:52.716268 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:01:52.716711 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:01:53.157050 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m14:01:53.158405 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m14:01:53.159736 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m14:01:53.164944 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:01:53.165223 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m14:01:53.165560 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:01:53.582261 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:01:53.582681 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:01:53.582926 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m14:01:53.634961 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:01:53.638424 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m14:01:53.681381 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m14:01:53.695690 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:53.696069 [debug] [MainThread]: On master: BEGIN
[0m14:01:53.696366 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:01:54.121359 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:01:54.122967 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:54.123639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:01:54.185976 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m14:01:54.191189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35e78c47-0dea-4fca-857e-230f5c4990ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cb5190>]}
[0m14:01:54.192417 [debug] [MainThread]: On master: ROLLBACK
[0m14:01:54.237090 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:54.238184 [debug] [MainThread]: On master: BEGIN
[0m14:01:54.326700 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:01:54.328070 [debug] [MainThread]: On master: COMMIT
[0m14:01:54.328755 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:54.329401 [debug] [MainThread]: On master: COMMIT
[0m14:01:54.376353 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:01:54.377689 [debug] [MainThread]: On master: Close
[0m14:01:54.380667 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m14:01:54.381464 [info ] [MainThread]: 
[0m14:01:54.391953 [debug] [Thread-1  ]: Began running node model.warehouse.stg_match_info
[0m14:01:54.392616 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_match_info ........................ [RUN]
[0m14:01:54.393663 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_match_info'
[0m14:01:54.394029 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_match_info
[0m14:01:54.398005 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_match_info"
[0m14:01:54.402125 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (compile): 2023-04-23 14:01:54.394280 => 2023-04-23 14:01:54.401992
[0m14:01:54.402523 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_match_info
[0m14:01:54.443432 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_match_info"
[0m14:01:54.452131 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:01:54.452302 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: BEGIN
[0m14:01:54.452446 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:01:54.876709 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:01:54.877832 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:01:54.878417 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_match_info"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_match_info__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated as (

    select distinct
        match_id,
        mode,
        season_id,
        cluster,
        map,
        start_at,
        cast(to_timestamp(start_at::integer) as date),
        to_timestamp(start_at::integer),
        duration
    from source

)

select * from updated limit 10
  );
  
[0m14:01:54.930795 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "to_timestamp" specified more than once

[0m14:01:54.931523 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: ROLLBACK
[0m14:01:54.975714 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (execute): 2023-04-23 14:01:54.402729 => 2023-04-23 14:01:54.975461
[0m14:01:54.976454 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: Close
[0m14:01:55.017163 [debug] [Thread-1  ]: Database Error in model stg_match_info (models/staging/stg_match_info.sql)
  column "to_timestamp" specified more than once
  compiled Code at target/run/warehouse/models/staging/stg_match_info.sql
[0m14:01:55.017732 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35e78c47-0dea-4fca-857e-230f5c4990ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d471c0>]}
[0m14:01:55.018221 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_match_info ............... [[31mERROR[0m in 0.62s]
[0m14:01:55.020047 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_match_info
[0m14:01:55.022177 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:01:55.022502 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:55.022746 [debug] [MainThread]: On master: BEGIN
[0m14:01:55.022967 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:01:55.456704 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:01:55.457760 [debug] [MainThread]: On master: COMMIT
[0m14:01:55.458369 [debug] [MainThread]: Using postgres connection "master"
[0m14:01:55.458836 [debug] [MainThread]: On master: COMMIT
[0m14:01:55.502976 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:01:55.503653 [debug] [MainThread]: On master: Close
[0m14:01:55.504915 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:01:55.505308 [debug] [MainThread]: Connection 'model.warehouse.stg_match_info' was properly closed.
[0m14:01:55.505672 [info ] [MainThread]: 
[0m14:01:55.506230 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m14:01:55.506898 [debug] [MainThread]: Command end result
[0m14:01:55.520228 [info ] [MainThread]: 
[0m14:01:55.520802 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:01:55.521186 [info ] [MainThread]: 
[0m14:01:55.521555 [error] [MainThread]: [33mDatabase Error in model stg_match_info (models/staging/stg_match_info.sql)[0m
[0m14:01:55.521906 [error] [MainThread]:   column "to_timestamp" specified more than once
[0m14:01:55.522239 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_match_info.sql
[0m14:01:55.522572 [info ] [MainThread]: 
[0m14:01:55.522929 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:01:55.523363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103de8c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103de8ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dde520>]}
[0m14:01:55.523719 [debug] [MainThread]: Flushing usage events


============================== 2023-04-23 14:02:13.426607 | 19cdfae0-e923-44f0-a9c1-abd3b894d194 ==============================
[0m14:02:13.426607 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:02:13.427827 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_match_info'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:02:13.427948 [debug] [MainThread]: Tracking: tracking
[0m14:02:13.442995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c1d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103890340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b78d90>]}
[0m14:02:13.450680 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:02:13.481703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:02:13.481987 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_match_info.sql
[0m14:02:13.489121 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
[0m14:02:13.497530 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m14:02:13.500788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19cdfae0-e923-44f0-a9c1-abd3b894d194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10400a0d0>]}
[0m14:02:13.511231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19cdfae0-e923-44f0-a9c1-abd3b894d194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f9dd90>]}
[0m14:02:13.511521 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:02:13.511717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19cdfae0-e923-44f0-a9c1-abd3b894d194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103b7b790>]}
[0m14:02:13.512448 [info ] [MainThread]: 
[0m14:02:13.513364 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:02:13.513872 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m14:02:13.519956 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m14:02:13.520157 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:02:13.520273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:02:13.997963 [debug] [ThreadPool]: SQL status: SELECT 7 in 0 seconds
[0m14:02:14.001304 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m14:02:14.004413 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m14:02:14.014976 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:02:14.015430 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m14:02:14.015906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:02:14.444771 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:02:14.445014 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:02:14.445141 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m14:02:14.495777 [debug] [ThreadPool]: SQL status: SELECT 4 in 0 seconds
[0m14:02:14.496722 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m14:02:14.541343 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m14:02:14.545284 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:14.545485 [debug] [MainThread]: On master: BEGIN
[0m14:02:14.545605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:02:14.970558 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:02:14.970815 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:14.970944 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:02:15.031130 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m14:02:15.032090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19cdfae0-e923-44f0-a9c1-abd3b894d194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10402a790>]}
[0m14:02:15.032341 [debug] [MainThread]: On master: ROLLBACK
[0m14:02:15.078396 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:15.078647 [debug] [MainThread]: On master: BEGIN
[0m14:02:15.173845 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:02:15.174332 [debug] [MainThread]: On master: COMMIT
[0m14:02:15.174650 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:15.174935 [debug] [MainThread]: On master: COMMIT
[0m14:02:15.218562 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:02:15.219082 [debug] [MainThread]: On master: Close
[0m14:02:15.220225 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m14:02:15.220665 [info ] [MainThread]: 
[0m14:02:15.228048 [debug] [Thread-1  ]: Began running node model.warehouse.stg_match_info
[0m14:02:15.228454 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_match_info ........................ [RUN]
[0m14:02:15.229037 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_match_info'
[0m14:02:15.229213 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_match_info
[0m14:02:15.231239 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_match_info"
[0m14:02:15.232210 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (compile): 2023-04-23 14:02:15.229336 => 2023-04-23 14:02:15.232149
[0m14:02:15.232413 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_match_info
[0m14:02:15.268167 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_match_info"
[0m14:02:15.269469 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:02:15.269661 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: BEGIN
[0m14:02:15.269819 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:02:15.697036 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:02:15.697825 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:02:15.698126 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_match_info"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_match_info__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated as (

    select distinct
        match_id,
        mode,
        season_id,
        cluster,
        map,
        start_at,
        cast(to_timestamp(start_at::integer) as date) ,
        to_timestamp(start_at::integer) as testz,
        duration
    from source

)

select * from updated limit 10
  );
  
[0m14:02:15.760297 [debug] [Thread-1  ]: SQL status: SELECT 10 in 0 seconds
[0m14:02:15.770855 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:02:15.771217 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_match_info"} */
alter table "DataWarehouse"."dev_staging"."stg_match_info__dbt_tmp" rename to "stg_match_info"
[0m14:02:15.816421 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m14:02:15.839141 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: COMMIT
[0m14:02:15.839403 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:02:15.839546 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: COMMIT
[0m14:02:15.886800 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m14:02:15.892246 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:02:15.892458 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_match_info"} */
drop table if exists "DataWarehouse"."dev_staging"."stg_match_info__dbt_backup" cascade
[0m14:02:15.935796 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m14:02:15.938145 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (execute): 2023-04-23 14:02:15.232536 => 2023-04-23 14:02:15.938088
[0m14:02:15.938406 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: Close
[0m14:02:15.939263 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19cdfae0-e923-44f0-a9c1-abd3b894d194', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040c5a30>]}
[0m14:02:15.939762 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_staging.stg_match_info ................... [[32mSELECT 10[0m in 0.71s]
[0m14:02:15.941183 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_match_info
[0m14:02:15.942718 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:02:15.942959 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:15.943139 [debug] [MainThread]: On master: BEGIN
[0m14:02:15.943307 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:02:16.418864 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:02:16.419387 [debug] [MainThread]: On master: COMMIT
[0m14:02:16.419682 [debug] [MainThread]: Using postgres connection "master"
[0m14:02:16.419959 [debug] [MainThread]: On master: COMMIT
[0m14:02:16.465303 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:02:16.465832 [debug] [MainThread]: On master: Close
[0m14:02:16.467258 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:02:16.467582 [debug] [MainThread]: Connection 'model.warehouse.stg_match_info' was properly closed.
[0m14:02:16.467885 [info ] [MainThread]: 
[0m14:02:16.468309 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m14:02:16.468972 [debug] [MainThread]: Command end result
[0m14:02:16.476990 [info ] [MainThread]: 
[0m14:02:16.477693 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:02:16.478166 [info ] [MainThread]: 
[0m14:02:16.478360 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:02:16.478600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ff8f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10402a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10405dc40>]}
[0m14:02:16.478788 [debug] [MainThread]: Flushing usage events


============================== 2023-04-23 14:10:51.213377 | 46b277b2-7325-4897-9029-be6277613731 ==============================
[0m14:10:51.213377 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:10:51.214639 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_match_info'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:10:51.214798 [debug] [MainThread]: Tracking: tracking
[0m14:10:51.238588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10616ac70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ad0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061ada90>]}
[0m14:10:51.245653 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:10:51.279657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:10:51.279944 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_match_info.sql
[0m14:10:51.288345 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
[0m14:10:51.296843 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m14:10:51.299669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46b277b2-7325-4897-9029-be6277613731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069340d0>]}
[0m14:10:51.313898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46b277b2-7325-4897-9029-be6277613731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ed1c0>]}
[0m14:10:51.314143 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:10:51.314326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46b277b2-7325-4897-9029-be6277613731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068ed100>]}
[0m14:10:51.315043 [info ] [MainThread]: 
[0m14:10:51.316033 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:10:51.316616 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m14:10:51.323282 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m14:10:51.323469 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:10:51.323590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:10:51.837213 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m14:10:51.842232 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m14:10:51.846487 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m14:10:51.856427 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:10:51.856768 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m14:10:51.857140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:10:52.296106 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:10:52.297471 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:10:52.298211 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m14:10:52.352428 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:10:52.357497 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m14:10:52.404971 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m14:10:52.413965 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:52.414366 [debug] [MainThread]: On master: BEGIN
[0m14:10:52.414661 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:10:52.847049 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:10:52.848398 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:52.849072 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:10:52.911787 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m14:10:52.914666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46b277b2-7325-4897-9029-be6277613731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068b40a0>]}
[0m14:10:52.915342 [debug] [MainThread]: On master: ROLLBACK
[0m14:10:52.962811 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:52.963644 [debug] [MainThread]: On master: BEGIN
[0m14:10:53.056399 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:10:53.056911 [debug] [MainThread]: On master: COMMIT
[0m14:10:53.057220 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:53.057508 [debug] [MainThread]: On master: COMMIT
[0m14:10:53.101758 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:10:53.102270 [debug] [MainThread]: On master: Close
[0m14:10:53.103458 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m14:10:53.103925 [info ] [MainThread]: 
[0m14:10:53.113281 [debug] [Thread-1  ]: Began running node model.warehouse.stg_match_info
[0m14:10:53.113648 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_match_info ........................ [RUN]
[0m14:10:53.114100 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_match_info'
[0m14:10:53.114242 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_match_info
[0m14:10:53.115936 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_match_info"
[0m14:10:53.119720 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (compile): 2023-04-23 14:10:53.114326 => 2023-04-23 14:10:53.119665
[0m14:10:53.119872 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_match_info
[0m14:10:53.143227 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_match_info"
[0m14:10:53.151788 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:10:53.151901 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: BEGIN
[0m14:10:53.151994 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:10:53.575573 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:10:53.576691 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:10:53.577309 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_match_info"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_match_info__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated as (

    select distinct
        match_id,
        mode,
        season_id,
        cluster,
        map,
        cast(to_timestamp(start_at::integer) as date) as start_date,
        to_timestamp(start_at::integer) as start_at
    from source

),

final as (

    select
        match_id,
        season_id,
        cluster,
        season_id,
        map,
        start_date,
        start_at
    from updated

)

select * from final
  );
  
[0m14:10:53.625421 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "season_id" specified more than once

[0m14:10:53.626146 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: ROLLBACK
[0m14:10:53.671046 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (execute): 2023-04-23 14:10:53.119957 => 2023-04-23 14:10:53.670923
[0m14:10:53.671429 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: Close
[0m14:10:53.704649 [debug] [Thread-1  ]: Database Error in model stg_match_info (models/staging/stg_match_info.sql)
  column "season_id" specified more than once
  compiled Code at target/run/warehouse/models/staging/stg_match_info.sql
[0m14:10:53.705057 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46b277b2-7325-4897-9029-be6277613731', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e7d60>]}
[0m14:10:53.705438 [error] [Thread-1  ]: 1 of 1 ERROR creating sql table model dev_staging.stg_match_info ............... [[31mERROR[0m in 0.59s]
[0m14:10:53.706772 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_match_info
[0m14:10:53.708867 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:10:53.709178 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:53.709371 [debug] [MainThread]: On master: BEGIN
[0m14:10:53.709548 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:10:54.142615 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:10:54.143546 [debug] [MainThread]: On master: COMMIT
[0m14:10:54.144174 [debug] [MainThread]: Using postgres connection "master"
[0m14:10:54.144759 [debug] [MainThread]: On master: COMMIT
[0m14:10:54.190356 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:10:54.191050 [debug] [MainThread]: On master: Close
[0m14:10:54.192519 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:10:54.192937 [debug] [MainThread]: Connection 'model.warehouse.stg_match_info' was properly closed.
[0m14:10:54.193369 [info ] [MainThread]: 
[0m14:10:54.194001 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m14:10:54.194661 [debug] [MainThread]: Command end result
[0m14:10:54.207926 [info ] [MainThread]: 
[0m14:10:54.208264 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:10:54.208481 [info ] [MainThread]: 
[0m14:10:54.208683 [error] [MainThread]: [33mDatabase Error in model stg_match_info (models/staging/stg_match_info.sql)[0m
[0m14:10:54.208877 [error] [MainThread]:   column "season_id" specified more than once
[0m14:10:54.209062 [error] [MainThread]:   compiled Code at target/run/warehouse/models/staging/stg_match_info.sql
[0m14:10:54.209248 [info ] [MainThread]: 
[0m14:10:54.209443 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m14:10:54.209716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106950d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106951b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106951df0>]}
[0m14:10:54.210034 [debug] [MainThread]: Flushing usage events


============================== 2023-04-23 14:12:08.978836 | f6a0bd3b-0323-49c8-a313-5a28956b261c ==============================
[0m14:12:08.978836 [info ] [MainThread]: Running with dbt=1.4.5
[0m14:12:08.980132 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/Users/deepsonshrestha/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'select': ['stg_match_info'], 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:12:08.980271 [debug] [MainThread]: Tracking: tracking
[0m14:12:09.001986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105594430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a8f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105590d60>]}
[0m14:12:09.009524 [debug] [MainThread]: checksum: e05dd7cee44d39ae8ac27965cacd8a6d8d0ab4e8185101e0db84e98f79bee0b6, vars: {}, profile: None, target: None, version: 1.4.5
[0m14:12:09.042507 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:12:09.042781 [debug] [MainThread]: Partial parsing: updated file: warehouse://models/staging/stg_match_info.sql
[0m14:12:09.049991 [debug] [MainThread]: 1699: static parser successfully parsed staging/stg_match_info.sql
[0m14:12:09.058434 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.warehouse.marts
[0m14:12:09.061278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6a0bd3b-0323-49c8-a313-5a28956b261c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c600d0>]}
[0m14:12:09.072872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6a0bd3b-0323-49c8-a313-5a28956b261c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1b1f0>]}
[0m14:12:09.073113 [info ] [MainThread]: Found 3 models, 0 tests, 0 snapshots, 0 analyses, 291 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m14:12:09.073276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6a0bd3b-0323-49c8-a313-5a28956b261c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052a8f70>]}
[0m14:12:09.073915 [info ] [MainThread]: 
[0m14:12:09.074799 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:12:09.075273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse'
[0m14:12:09.081541 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse"
[0m14:12:09.081781 [debug] [ThreadPool]: On list_DataWarehouse: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse"} */

    select distinct nspname from pg_namespace
  
[0m14:12:09.081911 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:09.623627 [debug] [ThreadPool]: SQL status: SELECT 7 in 1 seconds
[0m14:12:09.626541 [debug] [ThreadPool]: On list_DataWarehouse: Close
[0m14:12:09.629070 [debug] [ThreadPool]: Acquiring new postgres connection 'list_DataWarehouse_dev_staging'
[0m14:12:09.638420 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:12:09.638772 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: BEGIN
[0m14:12:09.639157 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:12:10.077089 [debug] [ThreadPool]: SQL status: BEGIN in 0 seconds
[0m14:12:10.077751 [debug] [ThreadPool]: Using postgres connection "list_DataWarehouse_dev_staging"
[0m14:12:10.078071 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "list_DataWarehouse_dev_staging"} */
select
      'DataWarehouse' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'dev_staging'
    union all
    select
      'DataWarehouse' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'dev_staging'
  
[0m14:12:10.128795 [debug] [ThreadPool]: SQL status: SELECT 5 in 0 seconds
[0m14:12:10.131183 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: ROLLBACK
[0m14:12:10.176977 [debug] [ThreadPool]: On list_DataWarehouse_dev_staging: Close
[0m14:12:10.187092 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:10.187326 [debug] [MainThread]: On master: BEGIN
[0m14:12:10.187449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:10.621120 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:12:10.622177 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:10.622829 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:12:10.682975 [debug] [MainThread]: SQL status: SELECT 4 in 0 seconds
[0m14:12:10.687160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6a0bd3b-0323-49c8-a313-5a28956b261c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d8190>]}
[0m14:12:10.688068 [debug] [MainThread]: On master: ROLLBACK
[0m14:12:10.733810 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:10.734726 [debug] [MainThread]: On master: BEGIN
[0m14:12:10.827221 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:12:10.828610 [debug] [MainThread]: On master: COMMIT
[0m14:12:10.829313 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:10.829972 [debug] [MainThread]: On master: COMMIT
[0m14:12:10.878122 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:12:10.879612 [debug] [MainThread]: On master: Close
[0m14:12:10.881827 [info ] [MainThread]: Concurrency: 25 threads (target='dev')
[0m14:12:10.882487 [info ] [MainThread]: 
[0m14:12:10.895468 [debug] [Thread-1  ]: Began running node model.warehouse.stg_match_info
[0m14:12:10.896017 [info ] [Thread-1  ]: 1 of 1 START sql table model dev_staging.stg_match_info ........................ [RUN]
[0m14:12:10.896846 [debug] [Thread-1  ]: Acquiring new postgres connection 'model.warehouse.stg_match_info'
[0m14:12:10.897115 [debug] [Thread-1  ]: Began compiling node model.warehouse.stg_match_info
[0m14:12:10.900957 [debug] [Thread-1  ]: Writing injected SQL for node "model.warehouse.stg_match_info"
[0m14:12:10.902337 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (compile): 2023-04-23 14:12:10.897304 => 2023-04-23 14:12:10.902246
[0m14:12:10.902631 [debug] [Thread-1  ]: Began executing node model.warehouse.stg_match_info
[0m14:12:10.944000 [debug] [Thread-1  ]: Writing runtime sql for node "model.warehouse.stg_match_info"
[0m14:12:10.944842 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:12:10.944985 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: BEGIN
[0m14:12:10.945109 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m14:12:11.364011 [debug] [Thread-1  ]: SQL status: BEGIN in 0 seconds
[0m14:12:11.365264 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:12:11.365809 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_match_info"} */

  
    

  create  table "DataWarehouse"."dev_staging"."stg_match_info__dbt_tmp"
  as (
    with source as (

    select * from "DataWarehouse"."dev_staging"."base_metadata"

),

updated as (

    select distinct
        match_id,
        mode,
        season_id,
        cluster,
        map,
        cast(to_timestamp(start_at::integer) as date) as start_date,
        to_timestamp(start_at::integer) as start_at
    from source

),

final as (

    select
        match_id,
        season_id,
        cluster,
        map,
        start_date,
        start_at
    from updated

)

select * from final
  );
  
[0m14:12:11.424544 [debug] [Thread-1  ]: SQL status: SELECT 374 in 0 seconds
[0m14:12:11.439353 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:12:11.439769 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_match_info"} */
alter table "DataWarehouse"."dev_staging"."stg_match_info" rename to "stg_match_info__dbt_backup"
[0m14:12:11.483546 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m14:12:11.491034 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:12:11.491476 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_match_info"} */
alter table "DataWarehouse"."dev_staging"."stg_match_info__dbt_tmp" rename to "stg_match_info"
[0m14:12:11.537125 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0 seconds
[0m14:12:11.572918 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: COMMIT
[0m14:12:11.573177 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:12:11.573359 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: COMMIT
[0m14:12:11.619323 [debug] [Thread-1  ]: SQL status: COMMIT in 0 seconds
[0m14:12:11.626852 [debug] [Thread-1  ]: Using postgres connection "model.warehouse.stg_match_info"
[0m14:12:11.627139 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: /* {"app": "dbt", "dbt_version": "1.4.5", "profile_name": "warehouse", "target_name": "dev", "node_id": "model.warehouse.stg_match_info"} */
drop table if exists "DataWarehouse"."dev_staging"."stg_match_info__dbt_backup" cascade
[0m14:12:11.677660 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0 seconds
[0m14:12:11.680323 [debug] [Thread-1  ]: Timing info for model.warehouse.stg_match_info (execute): 2023-04-23 14:12:10.902827 => 2023-04-23 14:12:11.680231
[0m14:12:11.680695 [debug] [Thread-1  ]: On model.warehouse.stg_match_info: Close
[0m14:12:11.682170 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f6a0bd3b-0323-49c8-a313-5a28956b261c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ce5bb0>]}
[0m14:12:11.682945 [info ] [Thread-1  ]: 1 of 1 OK created sql table model dev_staging.stg_match_info ................... [[32mSELECT 374[0m in 0.79s]
[0m14:12:11.685506 [debug] [Thread-1  ]: Finished running node model.warehouse.stg_match_info
[0m14:12:11.688448 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:12:11.688901 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:11.689212 [debug] [MainThread]: On master: BEGIN
[0m14:12:11.689503 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:12:12.122108 [debug] [MainThread]: SQL status: BEGIN in 0 seconds
[0m14:12:12.122883 [debug] [MainThread]: On master: COMMIT
[0m14:12:12.123338 [debug] [MainThread]: Using postgres connection "master"
[0m14:12:12.123801 [debug] [MainThread]: On master: COMMIT
[0m14:12:12.172694 [debug] [MainThread]: SQL status: COMMIT in 0 seconds
[0m14:12:12.173767 [debug] [MainThread]: On master: Close
[0m14:12:12.175550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:12.176019 [debug] [MainThread]: Connection 'model.warehouse.stg_match_info' was properly closed.
[0m14:12:12.176458 [info ] [MainThread]: 
[0m14:12:12.177113 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.10 seconds (3.10s).
[0m14:12:12.177997 [debug] [MainThread]: Command end result
[0m14:12:12.185253 [info ] [MainThread]: 
[0m14:12:12.185574 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:12:12.185780 [info ] [MainThread]: 
[0m14:12:12.185968 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:12:12.186215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059d7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c48700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c7dbb0>]}
[0m14:12:12.186413 [debug] [MainThread]: Flushing usage events
